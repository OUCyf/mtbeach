(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    393161,       9917]
NotebookOptionsPosition[    385133,       9675]
NotebookOutlinePosition[    385473,       9690]
CellTagsIndexPosition[    385430,       9687]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
The file AAcommonMathematicaFnsNoHalos MUST BE EVALUATED FIRST.\
\>", "Text",
 CellChangeTimes->{{3.594589256384596*^9, 3.5945892857866373`*^9}, {
   3.5945893204866858`*^9, 3.5945893276466956`*^9}, 3.5947427445422115`*^9, {
   3.684166300666413*^9, 3.6841663379321165`*^9}},
 FontSize->16,
 FontColor->RGBColor[1, 0, 0]],

Cell["\<\
Somehow the above warning got omitted, and I had to copy it from the old 2015 \
- 08 - 08 file.  I cannot be sure that some other things were not lost also.\
\>", "Text",
 CellChangeTimes->{{3.6852952725010176`*^9, 3.6852953718762636`*^9}, {
  3.6852979780915823`*^9, 3.6852980043130426`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DateSequence", "[", 
  RowBox[{
   RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.5469171533814898`*^9, 3.5469171633343077`*^9}}],

Cell[BoxData[
 TemplateBox[{"8","\"-\"","9","\"-\"","2017"},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.494871816633936*^9, 3.498601969226781*^9, 3.4987093257643986`*^9, 
   3.4987576410984755`*^9, 3.4990214748730927`*^9, 3.499456434562766*^9, 
   3.500130724019967*^9, 3.500661715937585*^9, 3.501182456849081*^9, 
   3.5011903863275356`*^9, 3.501429873318735*^9, 3.503266957219006*^9, {
   3.5035541586851015`*^9, 3.5035541753451242`*^9}, 3.5038682323477893`*^9, 
   3.5072579972840557`*^9, 3.5093932291413813`*^9, 3.5157102814137983`*^9, 
   3.522822362194331*^9, 3.5322962897576456`*^9, 3.546917164239109*^9, 
   3.557770418285616*^9, 3.5944938151759615`*^9, 3.5945853973241596`*^9, 
   3.594742961919015*^9, 3.5947459165887976`*^9, 3.5950182279803667`*^9, 
   3.595020422513934*^9, 3.5950368693450823`*^9, 3.5963914888522243`*^9, 
   3.5964901066272483`*^9, 3.5966909651183224`*^9, 3.6100570914908705`*^9, 
   3.6313012972571526`*^9, 3.642958294776805*^9, 3.6452289577965126`*^9, 
   3.6459801474860973`*^9, 3.646488551505371*^9, 3.6480873327706046`*^9, 
   3.652937763986947*^9, 3.6571675059288507`*^9, 3.6713843665080605`*^9, 
   3.6718108829871426`*^9, 3.678824177187996*^9, 3.6856487290699244`*^9, 
   3.6908334986011467`*^9, 3.695483475873409*^9, 3.697993076818478*^9, 
   3.698767785898736*^9, 3.6987923047287025`*^9, 3.7111239942790165`*^9, 
   3.7111287239188232`*^9, 3.711286624379176*^9}]
}, Open  ]],

Cell["\<\
Choose one of the following.   WantExamples = True will run a couple graphics \
examples as tests when you evaluate the notebook..\
\>", "Text",
 CellChangeTimes->{{3.594589256384596*^9, 3.5945892857866373`*^9}, {
   3.5945893204866858`*^9, 3.5945893276466956`*^9}, 3.5947427445422115`*^9},
 FontSize->16,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"WantExamples", "=", "True"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WantExamples", "=", "False"}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DummyMatrixM", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m11", "m12", "m13"},
      {"m21", "m22", "m23"},
      {"m31", "m32", "m33"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DummyMatrixN", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"n11", "n12", "n13"},
      {"n21", "n22", "n23"},
      {"n31", "n32", "n33"}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6340483684794474`*^9, 3.63404848657211*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LamSubU", "[", 
    RowBox[{"Lam_", ",", "U_"}], "]"}], ":=", 
   RowBox[{"U", ".", 
    RowBox[{"DiagonalMatrix", "[", "Lam", "]"}], ".", 
    RowBox[{"Transpose", "[", "U", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594493867420036*^9, 3.5944938745300455`*^9}, {
  3.594493905364092*^9, 3.5944939097440977`*^9}, {3.59450155072435*^9, 
  3.5945015586143613`*^9}}],

Cell[CellGroupData[{

Cell["Another section", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.692743015099022*^9}, {3.6927430809897823`*^9, 
  3.6927430825835347`*^9}}],

Cell[TextData[{
 StyleBox["GPGENBY",
  FontSlant->"Italic"],
 "[A] IS THE GROUP GENERATED BY THE GROUP ELEMENTS IN THE SET A."
}], "SmallText",
 CellMargins->{{Inherited, -120}, {Inherited, Inherited}},
 Evaluatable->False,
 CellChangeTimes->{3.6481670178008776`*^9},
 AspectRatioFixed->True,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AllProducts", "[", "a_", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ".", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}], ",", 
       RowBox[{"CartesianProduct", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "a"}], "}"}], "]"}]}], "]"}]}], "]"}]}], " ", 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GpGenBy", "[", "a_", "]"}], ":=", 
   RowBox[{"FixedPoint", "[", 
    RowBox[{"AllProducts", ",", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GyroidGp", "         ", "=", 
    RowBox[{"GpGenBy", "[", 
     RowBox[{"{", 
      RowBox[{"rot111", ",", 
       RowBox[{"zrot", "[", "90", "]"}]}], "}"}], "]"}]}], ";"}], 
  "                                                     ", 
  RowBox[{"(*", "  ", 
   StyleBox["432",
    FontColor->RGBColor[1, 0, 0]], "     ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RhombohedralWithAxis111", "=", 
    RowBox[{"GpGenBy", "[", 
     RowBox[{"{", 
      RowBox[{"-", "rot111"}], "}"}], "]"}]}], ";"}], 
  "                                                   ", 
  RowBox[{"(*", "  ", 
   OverscriptBox[
    StyleBox["3",
     FontColor->RGBColor[1, 0, 0]], "_"], "    ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.648165708751521*^9, 3.648165709741522*^9}, {
  3.648165806971656*^9, 3.6481658505517163`*^9}, {3.648166181349723*^9, 
  3.648166192669739*^9}, {3.6481670034308577`*^9, 3.648167052760926*^9}, {
  3.648167152391063*^9, 3.6481671593210726`*^9}, {3.6481672835312443`*^9, 
  3.6481672853812466`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymGroup", "=", 
    RowBox[{"{", 
     RowBox[{"id", ",", "rot111", ",", 
      RowBox[{"rot111", ".", "rot111"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "1", "0"},
         {"1", "0", "0"},
         {"0", "0", "1"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0", "0"},
         {"0", "0", "1"},
         {"0", "1", "0"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "0", "1"},
         {"0", "1", "0"},
         {"1", "0", "0"}
        }], "\[NoBreak]", ")"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"the", " ", "six", " ", "permuation", " ", 
      RowBox[{"matrices", ".", " ", "Some"}], " ", "have", " ", "det"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"-", "1."}], " ", "SymmetricGroup", " ", "is", " ", "a", " ", 
      "built", " ", "in", " ", "function", " ", "in", " ", "Mathematica", " ",
       "9", " ", "but", " ", "does", " ", "not", " ", "consist", " ", "of", 
      " ", "matrices"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5943106282172747`*^9, 3.5943106401872916`*^9}, {
   3.594516111236637*^9, 3.5945161384566746`*^9}, {3.594740781706049*^9, 
   3.5947408108980904`*^9}, {3.5947408519681473`*^9, 3.594740863092165*^9}, {
   3.6404473398060217`*^9, 3.640447367056059*^9}, {3.6481657435815687`*^9, 
   3.648165757631588*^9}, 3.6481670178008776`*^9}]
}, Open  ]],

Cell["Principal axes", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.6927430463803253`*^9}}],

Cell[CellGroupData[{

Cell["Principal axes as vectors.", "Subsection",
 CellChangeTimes->{{3.5599422151587963`*^9, 3.5599422323656263`*^9}, {
  3.559952432268276*^9, 3.5599524345926805`*^9}, {3.594498643467292*^9, 
  3.5944986618773165`*^9}, {3.5945021638672047`*^9, 3.5945021731472173`*^9}, {
  3.618849421495056*^9, 3.6188494797901363`*^9}, {3.710885400004779*^9, 
  3.7108854138797927`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Paxes", "[", 
   RowBox[{
   "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
    ",", "BBrad_", ",", "ArrowScale_", ",", "tkns_", ",", "WantArrowColor_"}],
    "]"}], ":=", 
  RowBox[{"{", "      ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"changed", " ", "July", " ", "2017"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"t1", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"BBrad", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"ShortenForArrow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}], ",", 
                "ArrowScale"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"WantArrowColor", ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".01", ",", ".8", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t2", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "BBrad", ",", "0"}], "}"}], ",", 
              RowBox[{"ShortenForArrow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}], ",", 
                "ArrowScale"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"WantArrowColor", ",", 
            RowBox[{"Hue", "[", 
             RowBox[{".6", ",", ".9", ",", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"t3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", "       ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "+", 
              RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "BBrad"}], "}"}], ",", 
              RowBox[{"ShortenForArrow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}], ",", 
                "ArrowScale"}], "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
          RowBox[{"If", "[", 
           RowBox[{"WantArrowColor", ",", 
            RowBox[{"Hue", "[", ".15", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow3D", "[", 
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}]}], ",", 
            RowBox[{"u", ".", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ",", "ArrowScale"}],
            "]"}]}], "}"}]}], "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.710884862433217*^9, 3.710885007042824*^9}, {
  3.710885057824211*^9, 3.710885080152393*^9}, {3.710885123496228*^9, 
  3.710885138761883*^9}, {3.710885295230939*^9, 3.710885325262247*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{
    RowBox[{"xrot", "[", "20", "]"}], ".", 
    RowBox[{"zrot", "[", "30", "]"}]}]}], ";", 
  RowBox[{"WantArrowColor", "=", "True"}], ";", 
  RowBox[{"lengthAxis", "=", "1.2"}], ";", 
  RowBox[{"c", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
  RowBox[{"tkns", "=", ".008"}], ";", 
  RowBox[{"BBrad", "=", ".3"}], ";", 
  RowBox[{"ArrowScale", "=", ".25"}], ";", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{"Paxes", "[", 
    RowBox[{
    "True", ",", "True", ",", "True", ",", "u", ",", "c", ",", "lengthAxis", 
     ",", "BBrad", ",", "ArrowScale", ",", "tkns", ",", "WantArrowColor"}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7108754544001923`*^9, 3.71087548307283*^9}, 
   3.710875547888542*^9, {3.710875625632994*^9, 3.7108756517924924`*^9}, {
   3.71087568574444*^9, 3.7108756886566067`*^9}, {3.710875924482112*^9, 
   3.710875950783614*^9}, 3.7108850241054087`*^9, {3.710885449207987*^9, 
   3.7108855285831556`*^9}}],

Cell[BoxData[
 Graphics3DBox[{{
    {Thickness[0.008], 
     Line3DBox[{{0.25980762113533157`, 0.14095389311788625`, 
      0.051303021498850306`}, {0.8183940065762945, 0.4440047633213417, 
      0.16160451772137846`}}]}, 
    {Hue[0.01, 0.8, 1], 
     StyleBox[
      {Opacity[1], EdgeForm[None], Polygon3DBox[CompressedData["
1:eJxTTMoPSmViYGDgBWJmIP7gZZKp8val/XKeuUt3KN6xP82++vgr3/P2JsqG
eSvnvrLvUD29afqNm/bf5ryMKn961r4h8NOjBKvX9m+cgwxFvW7YT/Y8ZbKJ
55Q9h86ysz4zX9tXRLx8/uPBdfuY7pcLK08fsZ/etJrz34LX9kGiAU9ydt6w
95glKNckst/+dkvS+xT/1/Z/BXb2Fs68Zd/y+dLF70nb7eXWLtsWt+uVfcn6
GdwZDHftb8kG/BCYtMX+1pWVG29yvrKfNC3rX4fnfbj6/mUvbJRyX9pL7Pm4
nzXnAdx89jMmQWZ8L+0vGi57MnnBA7h7Kkr1xVrZXtqnXC56FmnyAO5+k+IK
A7mIl/ayq2uU13fcg/sXV/gAAAICowk=
        "]], 
       Polygon3DBox[{{0.8101980261584156, 0.439558183414372, 
        0.24456534146707862`}, {0.8317458297907252, 0.40384476146990567`, 
        0.2335652536305372}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.8317458297907252, 0.40384476146990567`, 
        0.2335652536305372}, {0.8508762772130893, 0.3795216542867468, 
        0.20351245477338561`}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.8508762772130893, 0.3795216542867468, 
        0.20351245477338561`}, {0.8624633804878394, 0.3731062187920382, 
        0.16245956807969264`}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.8624633804878394, 0.3731062187920382, 
        0.16245956807969264`}, {0.8634023846498903, 0.38631746574568127`, 
        0.12140668138599964`}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.8634023846498903, 0.38631746574568127`, 
        0.12140668138599964`}, {0.8534416842923308, 0.415615452195439, 
        0.09135388252884807}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.8534416842923308, 0.415615452195439, 
        0.09135388252884807}, {0.8352502410320175, 0.453149806332241, 
        0.08035379469230666}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.8352502410320175, 0.453149806332241, 
        0.08035379469230666}, {0.8137024373997079, 0.48886322827670725`, 
        0.09135388252884807}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.8137024373997079, 0.48886322827670725`, 
        0.09135388252884807}, {0.7945719899773439, 0.5131863354598662, 
        0.12140668138599964`}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.7945719899773439, 0.5131863354598662, 
        0.12140668138599964`}, {0.7829848867025938, 0.5196017709545747, 
        0.16245956807969264`}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.7829848867025938, 0.5196017709545747, 
        0.16245956807969264`}, {0.782045882540543, 0.5063905240009317, 
        0.20351245477338561`}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.782045882540543, 0.5063905240009317, 
        0.20351245477338561`}, {0.7920065828981024, 0.4770925375511739, 
        0.2335652536305372}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}], 
       Polygon3DBox[{{0.7920065828981024, 0.4770925375511739, 
        0.2335652536305372}, {0.8101980261584156, 0.439558183414372, 
        0.24456534146707862`}, {1.0392304845413263`, 0.563815572471545, 
        0.20521208599540122`}}]},
      Lighting->"Neutral"]}}, {
    {Thickness[0.008], 
     Line3DBox[{{-0.15, 0.2441393044048121, 0.08885943981780714}, {-0.4725, 
      0.7690388088751581, 0.27990723542609247`}}]}, 
    {Hue[0.6, 0.9, 1], 
     StyleBox[
      {Opacity[1], EdgeForm[None], Polygon3DBox[CompressedData["
1:eJxTTMoPSmViYGDgBWJmII5In829adLd/e++8G5iFnxh31LnuzZE6rr9pBid
HemZt/cH77r95fitF/a7py+vnJd9zb776DZTCd5b+wOeuD1bOuelfeEdcwuf
viv2TEqfH4jfvrl/xcrNFquVXtnHWSkddma6ZD/rSOOEMw9u7bdKzznyzuOV
/QwDyTllb87ZX9PW7Re7cWe/bjr3FX3WV/YsuywlLxmeti9JNTwoZXV//+Ff
EXlTM1/aF715uzH1ykl7WYuArk0bH+yPM+3Wvjj/BVz9AuZu71vxD/cncitY
fb77HG5+6tU3pbcqHu7nctv8/G34c7h7JFtU5Ri+Pdhf1vErepXhc7j7vy2Y
b7vty/39LR3RPpmlz+H+xRU+ABWkolQ=
        "]], 
       Polygon3DBox[{{-0.4620785821294837, 0.7520769574763599, 
        0.3609821026238722}, {-0.42830842004463776`, 0.7767066748036292, 
        0.35031854515397826`}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.42830842004463776`, 0.7767066748036292, 
        0.35031854515397826`}, {-0.4070492291021643, 0.8003720758052939, 
        0.3211851643567974}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.4070492291021643, 0.8003720758052939, 
        0.3211851643567974}, {-0.4039973923468382, 0.8167320353943994, 
        0.2813882260897226}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.4039973923468382, 0.8167320353943994, 
        0.2813882260897226}, {-0.4199706469726806, 0.8214029156108389, 
        0.24159128782264783`}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.4199706469726806, 0.8214029156108389, 
        0.24159128782264783`}, {-0.4506889723022004, 0.8131331578726751, 
        0.21245790702546696`}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.4506889723022004, 0.8131331578726751, 
        0.21245790702546696`}, {-0.48792141787051624`, 0.79413863708745, 
        0.20179434955557302`}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.48792141787051624`, 0.79413863708745, 
        0.20179434955557302`}, {-0.5216915799553622, 0.7695089197601808, 
        0.21245790702546696`}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.5216915799553622, 0.7695089197601808, 
        0.21245790702546696`}, {-0.5429507708978356, 0.7458435187585161, 
        0.24159128782264783`}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.5429507708978356, 0.7458435187585161, 
        0.24159128782264783`}, {-0.5460026076531618, 0.7294835591694107, 
        0.2813882260897226}, {-0.6, 0.9765572176192484, 0.35543775927122856`}}
        ], 
       Polygon3DBox[{{-0.5460026076531618, 0.7294835591694107, 
        0.2813882260897226}, {-0.5300293530273193, 0.724812678952971, 
        0.3211851643567974}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.5300293530273193, 0.724812678952971, 
        0.3211851643567974}, {-0.49931102769779956`, 0.7330824366911348, 
        0.35031854515397826`}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}], 
       Polygon3DBox[{{-0.49931102769779956`, 0.7330824366911348, 
        0.35031854515397826`}, {-0.4620785821294837, 0.7520769574763599, 
        0.3609821026238722}, {-0.6, 0.9765572176192484, 
        0.35543775927122856`}}]},
      Lighting->"Neutral"]}}, {
    {Thickness[0.008], 
     Line3DBox[{{0., -0.10260604299770061`, 0.2819077862357725}, {
      0., -0.3232090354427569, 0.8880095266426834}}]}, 
    {Hue[0.15], 
     StyleBox[
      {Opacity[1], EdgeForm[None], Polygon3DBox[CompressedData["
1:eJxTTMoPSmViYGDgBWJmBgRYz87b/G3C+f3mnqc39VS9tQ8Fg6X7bxSy7Ior
ubC/jXffDpfot/ayxhNcl1du2j+LfUfhL89L+xcJb249xwpTv3V/TPfLhZWn
r+znvTcrQmDiG7h6OX7pSz98ru+vWNGkHSTzBm7+gyXnOqco3dw/ZV35j9vH
XtvD3PNgkg9Txbmb+x8XZf2bvPw1TL09unqo+fbYzd9qj8M99tjdv9Qe3b+4
wgcA9bCUvQ==
        "]], 
       Polygon3DBox[{{0., -0.2466114177605596, 
        0.9212096683570853}, {-0.041666666666666664`, -0.25710266271360416`, 
        0.9173911674737816}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{-0.041666666666666664`, -0.25710266271360416`, 
        0.9173911674737816}, {-0.07216878364870323, -0.28576527695997245`, 
        0.9069588290518491}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{-0.07216878364870323, -0.28576527695997245`, 
        0.9069588290518491}, {-0.08333333333333333, -0.3249191361593853, 
        0.8927079897466129}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{-0.08333333333333333, -0.3249191361593853, 
        0.8927079897466129}, {-0.07216878364870323, -0.3640729953587981, 
        0.8784571504413767}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{-0.07216878364870323, -0.3640729953587981, 
        0.8784571504413767}, {-0.041666666666666664`, -0.3927356096051664, 
        0.8680248120194443}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{-0.041666666666666664`, -0.3927356096051664, 
        0.8680248120194443}, {0., -0.40322685455821095`, 
        0.8642063111361405}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{0., -0.40322685455821095`, 0.8642063111361405}, {
        0.041666666666666664`, -0.3927356096051664, 0.8680248120194443}, {
        0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{0.041666666666666664`, -0.3927356096051664, 
        0.8680248120194443}, {0.07216878364870323, -0.3640729953587981, 
        0.8784571504413767}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{0.07216878364870323, -0.3640729953587981, 
        0.8784571504413767}, {0.08333333333333333, -0.3249191361593853, 
        0.8927079897466129}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{0.08333333333333333, -0.3249191361593853, 
        0.8927079897466129}, {0.07216878364870323, -0.28576527695997245`, 
        0.9069588290518491}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{0.07216878364870323, -0.28576527695997245`, 
        0.9069588290518491}, {0.041666666666666664`, -0.25710266271360416`, 
        0.9173911674737816}, {0., -0.41042417199080244`, 1.12763114494309}}], 
       Polygon3DBox[{{0.041666666666666664`, -0.25710266271360416`, 
        0.9173911674737816}, {0., -0.2466114177605596, 0.9212096683570853}, {
        0., -0.41042417199080244`, 1.12763114494309}}]},
      Lighting->"Neutral"]}}},
  ImageSize->{254.77146318721668`, 158.},
  ViewPoint->{3.0334702850749706`, -0.2016867725823639, 1.4857255720127078`},
  ViewVertical->{0.23309712589913403`, 0.27064242339227984`, 
   1.4448583299350042`}]], "Output",
 CellChangeTimes->{{3.7108754768464737`*^9, 3.7108755101913834`*^9}, {
   3.710875570283825*^9, 3.710875605383835*^9}, 3.7108756898356705`*^9, 
   3.710875951833675*^9, 3.7108759858156204`*^9, 3.7108850314334974`*^9, 
   3.710885087386747*^9, {3.7108851282305765`*^9, 3.710885141918092*^9}, {
   3.7108855218487167`*^9, 3.7108855299268575`*^9}, 3.7111239948630066`*^9, 
   3.7111287242938447`*^9, 3.711286624835774*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Principal axes as lines, no arrows.", "Subsection",
 CellChangeTimes->{{3.5599422151587963`*^9, 3.5599422323656263`*^9}, {
  3.559952432268276*^9, 3.5599524345926805`*^9}, {3.594498643467292*^9, 
  3.5944986618773165`*^9}, {3.5945021638672047`*^9, 3.5945021871872363`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PrincipalAxes", "[", 
    RowBox[{
    "t1_", ",", "t2_", ",", "t3_", ",", "u_", ",", "c_", ",", "lengthAxis_", 
     ",", "BBrad_", ",", "tkns_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Thickness", "[", "tkns", "]"}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"lines", ",", " ", 
        RowBox[{"no", " ", "arrows"}]}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".01", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "lengthAxis"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"lengthAxis", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], " ", "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".57", ",", "1", ",", "1"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "lengthAxis"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "lengthAxis", ",", "0"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"t3", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Hue", "[", 
          RowBox[{".15", ",", "1", ",", ".9"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "+", 
             RowBox[{"u", ".", "#"}]}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "lengthAxis"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "lengthAxis"}], "}"}]}], "}"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.504471849812714*^9, 3.5044718903327703`*^9}, {
   3.5044719323628283`*^9, 3.5044719941229134`*^9}, {3.5122275063263364`*^9, 
   3.5122275300227776`*^9}, {3.5122278033508544`*^9, 3.51222780634606*^9}, {
   3.512227916029851*^9, 3.51222798997398*^9}, {3.5122280516876874`*^9, 
   3.512228053700091*^9}, {3.512228085165346*^9, 3.5122281150705976`*^9}, {
   3.5123939753233414`*^9, 3.5123939753533416`*^9}, {3.5183042958838587`*^9, 
   3.518304332216322*^9}, {3.51830439414843*^9, 3.5183044095612564`*^9}, {
   3.522959570528062*^9, 3.522959584538081*^9}, {3.52295998940864*^9, 
   3.5229600030186586`*^9}, {3.5468753296470337`*^9, 
   3.5468753366358457`*^9}, {3.546875437568022*^9, 3.546875439268425*^9}, {
   3.546920669441621*^9, 3.5469206878652525`*^9}, {3.547069861331265*^9, 
   3.547069899816532*^9}, {3.5479172086508427`*^9, 3.547917209774045*^9}, {
   3.559264686152985*^9, 3.5592646885553894`*^9}, {3.5944937685858965`*^9, 
   3.594493777165909*^9}, {3.698767816765506*^9, 3.698767817358539*^9}, 
   3.6987687967186327`*^9, {3.698768832365678*^9, 3.6987688341737814`*^9}, 
   3.698777024974787*^9, {3.69877829283139*^9, 3.698778315407683*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Another section", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927430126146345`*^9, 3.692743015099022*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigensystemAsPairsPreliminary", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "v1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]2", ",", "v2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]3", ",", "v3"}], "}"}]}], "}"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"don", "'"}], "t", " ", "normalize", " ", "yet"}], ";", " ", 
     RowBox[{
     "they", " ", "are", " ", "complex", " ", "in", " ", "some", " ", 
      "apps"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"EigensystemAsPairsPreliminary", "[", 
       RowBox[{"Eigensystem", "[", "M", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ">", 
        RowBox[{"#2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], ";"}], "       ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "Mathematica", " ", "cannot", " ", "always", " ", "find", " ", 
      "eigenvectors", " ", "of", " ", "double", " ", "couples", " ", 
      "correctly"}], ",", " ", 
     RowBox[{
     "so", " ", "look", " ", "here", " ", "when", " ", "problems", " ", 
      "arise"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAxisCandidate", "[", "u_", "]"}], ":=", 
    RowBox[{"unit", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"EigensystemAsPairsPreliminary", "[", 
         RowBox[{"Eigensystem", "[", "u", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "the", " ", "eigenvector", " ", "with", " ", "eigenvalue", " ", "1"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Wperp", "[", "u_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "==", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]",
      "                            ", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "                            ", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"RotationAxisCandidate", "[", "u", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAngleCandidate", "[", "u_", "]"}], ":=", " ", 
    RowBox[{"SignedAngle", "[", 
     RowBox[{
      RowBox[{"Wperp", "[", "u", "]"}], ",", 
      RowBox[{"u", ".", 
       RowBox[{"Wperp", "[", "u", "]"}]}], ",", 
      RowBox[{"RotationAxisCandidate", "[", "u", "]"}]}], "]"}]}], ";"}], 
  "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"became", " ", "radians", " ", "Nov"}], "-", 
     RowBox[{"Dec", " ", "of", " ", "2013"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAxis", "[", "u_", "]"}], ":=", 
    RowBox[{"MakeReal", "[", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"RotationAngleCandidate", "[", "u", "]"}], "/", "2"}], "]"}], 
      RowBox[{"RotationAxisCandidate", "[", "u", "]"}]}], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"magnitude", " ", "is", " ", 
     RowBox[{"Abs", "[", 
      RowBox[{"Sin", "[", 
       RowBox[{"RotAngle", "/", "2"}], "]"}], "]"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAngle", "[", "u_", "]"}], ":=", 
    RowBox[{"Angle", "[", 
     RowBox[{
      RowBox[{"Wperp", "[", "u", "]"}], ",", 
      RowBox[{"u", ".", 
       RowBox[{"Wperp", "[", "u", "]"}]}]}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "changed", " ", "to", " ", "radians", " ", "Dec", " ", "of", " ", "2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotationAngle", "[", "u_", "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"Tr", "[", "u", "]"}]}], "2"], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "March", " ", "of", " ", "2016"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QuatOfU", "[", "u_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"length", "[", 
          RowBox[{"RotationAxis", "[", "u", "]"}], "]"}], "2"]}]], ",", 
      RowBox[{"RotationAxis", "[", "u", "]"}]}], "}"}]}], ";"}], 
  "            ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"w", " ", "automatically", " ", "non"}], "-", "negative"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WRepForU", "[", "U_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"U", ",", 
         RowBox[{"U", ".", 
          RowBox[{"xrot", "[", "180", "]"}]}], ",", 
         RowBox[{"U", ".", 
          RowBox[{"yrot", "[", "180", "]"}]}], ",", 
         RowBox[{"U", ".", 
          RowBox[{"zrot", "[", "180", "]"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"IsOnGreen", "[", 
         RowBox[{"RotationAxis", "[", "#", "]"}], "]"}], "&"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "this", " ", "is", " ", "NOT", " ", "for", " ", "the", " ", "Kagan", " ", 
     "setup", " ", "Bw"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.511625132793008*^9, 3.511625133666609*^9}, 
   3.511625437102738*^9, 3.511658711102789*^9, {3.5133060509992743`*^9, 
   3.513306053620079*^9}, {3.514402628816926*^9, 3.514402638551343*^9}, 
   3.514737096677024*^9, {3.52449593206017*^9, 3.5244959443061914`*^9}, {
   3.593024989853939*^9, 3.593024993383944*^9}, {3.5944959807015743`*^9, 
   3.594495981311575*^9}, {3.5944978762042255`*^9, 3.5944978908242455`*^9}, {
   3.5948752078132*^9, 3.594875251485263*^9}, {3.597341194101532*^9, 
   3.5973412871088943`*^9}, {3.668214368625022*^9, 3.6682143785850363`*^9}, {
   3.66821441045508*^9, 3.668214437855118*^9}, {3.668214532395248*^9, 
   3.668214560285287*^9}, 3.688343419048484*^9, 3.688343462925025*^9, 
   3.6924864795048723`*^9, {3.702399132582429*^9, 3.7023991392718105`*^9}}],

Cell["\<\
Mathematica occasionally fails to find the correct eigenvectors for double \
couples. (See the file EigensystemBugForWolfram.) The following commands \
should be avoided, or at least checked, when M is a double couple.\
\>", "Text",
 CellChangeTimes->{{3.5949166905740185`*^9, 3.594916758664112*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P1", "[", "M_", "]"}], ":=", 
    RowBox[{"Unit", "[", 
     RowBox[{
      RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "P1", " ", "is", " ", "the", " ", "eigenvector", " ", "with", " ", 
     "biggest", " ", 
     RowBox[{"eigenvalue", "."}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P2", "[", "M_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"P1", "[", "M", "]"}], ",", 
          RowBox[{
           RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"P3", "[", "M", "]"}]}], "}"}], "]"}], ">", "0"}], ",", 
      RowBox[{"Unit", "[", 
       RowBox[{
        RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Unit", "[", 
        RowBox[{
         RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "]"}]}]}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P3", "[", "M_", "]"}], ":=", 
    RowBox[{"Unit", "[", 
     RowBox[{
      RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", "  ", 
   StyleBox[
    RowBox[{
    "P3", " ", "is", " ", "the", " ", "eigenvector", " ", "with", " ", 
     "smallest", " ", 
     RowBox[{"eigenvalue", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]1ofM", "[", "M_", "]"}], ":=", 
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]2ofM", "[", "M_", "]"}], ":=", 
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]3ofM", "[", "M_", "]"}], ":=", 
   RowBox[{
    RowBox[{"EigensystemAsPairs", "[", "M", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]ofMnotNormalized", "[", "M_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]1ofM", "[", "M", "]"}], ",", 
        RowBox[{"\[Lambda]2ofM", "[", "M", "]"}], ",", 
        RowBox[{"\[Lambda]3ofM", "[", "M", "]"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"#1", ">", "#2"}], "&"}]}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]ofM", "[", "M_", "]"}], ":=", 
    RowBox[{"Unit", "[", 
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]1ofM", "[", "M", "]"}], ",", 
         RowBox[{"\[Lambda]2ofM", "[", "M", "]"}], ",", 
         RowBox[{"\[Lambda]3ofM", "[", "M", "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"#1", ">", "#2"}], "&"}]}], "]"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NORMALIZED", " ", "2012"}], "-", "11", "-", "22"}], ";", " ", 
      "somehow"}], ",", " ", 
     RowBox[{"without", " ", "the", " ", "sorting"}], ",", " ", 
     RowBox[{
     "the", " ", "entries", " ", "are", " ", "not", " ", "in", " ", "order", 
      " ", "for", " ", "some", " ", "crack", " ", "tensors"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Uraw", "[", "M_", "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"P1", "[", "M", "]"}], ",", 
      RowBox[{"P2", "[", "M", "]"}], ",", 
      RowBox[{"P3", "[", "M", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DCforM", "[", "M_", "]"}], ":=", 
    RowBox[{"LamSubU", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"Uraw", "[", "M", "]"}]}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      StyleBox[
       RowBox[{"n", 
        StyleBox["ot",
         FontColor->RGBColor[1, 0, 0]]}]], " ", "closest", " ", "DC"}], ",", 
     " ", 
     RowBox[{"not", " ", "normalized"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"V", "[", "M_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Uraw", "[", "M", "]"}], ".", 
      RowBox[{"yrot", "[", "45", "]"}]}]}], ";"}], "*)"}], "          ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"Eq", " ", 
       RowBox[{"(", "26", ")"}], " ", "of", " ", "TapeTapeBeach"}], ";", " ", 
      RowBox[{
      "the", " ", "first", " ", "and", " ", "third", " ", "frame", " ", 
       "vectors", " ", "of", " ", "V", " ", "are", " ", 
       RowBox[{"(", 
        RowBox[{"N", ",", "S"}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "N"}], ",", 
         RowBox[{"-", "S"}]}], ")"}], ".", " ", 
       RowBox[{"(", 
        RowBox[{"S", ",", "N"}], ")"}]}], " ", "or", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "S"}], ",", 
        RowBox[{"-", "N"}]}], ")"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ucan", "[", "M_", " ", "]"}], ":=", 
    RowBox[{"WRepForU", "[", 
     RowBox[{"Uraw", "[", "M", "]"}], "]"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"canonical", " ", "U"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintUdata", "[", "M_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(U\), \(RAW\)]\)[M] = {P1,P2,P3} = \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Uraw", "[", "M", "]"}], ",", ".001"}], "]"}], "]"}], ",", 
       "\"\<, \!\(\*SubscriptBox[\(U\), \
\(RAW\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(RAW\)], \(T\)]\) = \>\"",
        ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Uraw", "[", "M", "]"}], "]"}], ".", 
          RowBox[{"Uraw", "[", "M", "]"}]}], "]"}], "]"}], ",", 
       "\"\<, det \!\(\*SubscriptBox[\(U\), \(RAW\)]\) = \>\"", ",", 
       RowBox[{"Det", "[", 
        RowBox[{"Uraw", "[", "M", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(U\), \(CAN\)]\)[M] = \>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"Ucan", "[", "M", "]"}], ",", ".001"}], "]"}], "]"}], ",", 
       "\"\<, \!\(\*SubscriptBox[\(U\), \
\(CAN\)]\)\!\(\*SuperscriptBox[SubscriptBox[\(U\), \(CAN\)], \(T\)]\) = \>\"",
        ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Ucan", "[", "M", "]"}], ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Ucan", "[", "M", "]"}], "]"}]}], "]"}], "]"}], ",", 
       "\"\<, det \!\(\*SubscriptBox[\(U\), \(CAN\)]\) = \>\"", ",", 
       RowBox[{"Det", "[", 
        RowBox[{"Ucan", "[", "M", "]"}], "]"}]}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BeachballForM", "[", 
     RowBox[{"M_", ",", "c_", ",", "BBrad_"}], "]"}], ":=", 
    RowBox[{"BeachBall", "[", 
     RowBox[{
      RowBox[{"\[CapitalLambda]ofM", "[", "M", "]"}], ",", 
      RowBox[{"Uraw", "[", "M", "]"}], ",", "c", ",", "BBrad"}], "]"}]}], 
   ";"}], "  "}]}], "Input",
 CellChangeTimes->{{3.5093955617346*^9, 3.5093956488847203`*^9}, {
   3.5093966955561647`*^9, 3.5093967281262097`*^9}, {3.50939680107631*^9, 
   3.509396808796321*^9}, {3.5094034704952726`*^9, 3.509403630755494*^9}, {
   3.5094052339777064`*^9, 3.50940525132773*^9}, {3.5097247108236847`*^9, 
   3.509724710843684*^9}, {3.5097247438337297`*^9, 3.5097248140038266`*^9}, {
   3.50972484512387*^9, 3.5097248686639023`*^9}, {3.5097253274145355`*^9, 
   3.5097253598845797`*^9}, {3.509725414714656*^9, 3.509725421744665*^9}, {
   3.509725477094742*^9, 3.509725550344843*^9}, {3.509730446767604*^9, 
   3.5097304593376207`*^9}, {3.509730648537882*^9, 3.5097306649879045`*^9}, {
   3.5097310495984354`*^9, 3.5097310525584393`*^9}, {3.509731149978574*^9, 
   3.5097311721786046`*^9}, {3.5097386461289186`*^9, 
   3.5097387055390005`*^9}, {3.509738742899052*^9, 3.5097387836791086`*^9}, {
   3.50976718615437*^9, 3.5097672806345005`*^9}, {3.5098042015502777`*^9, 
   3.509804400660552*^9}, {3.5101993779124537`*^9, 3.51019950759548*^9}, {
   3.5101995383963346`*^9, 3.510199633026099*^9}, {3.510199715441043*^9, 
   3.5101997657823305`*^9}, {3.510199800944792*^9, 3.5101998073876033`*^9}, {
   3.510199844593668*^9, 3.5101999038737717`*^9}, {3.5101999544178596`*^9, 
   3.5101999745262947`*^9}, {3.5102001017601166`*^9, 3.510200130666967*^9}, {
   3.5102004217166743`*^9, 3.51020042517988*^9}, {3.5102004808875775`*^9, 
   3.510200489202392*^9}, {3.5102460071585693`*^9, 3.5102460729750843`*^9}, {
   3.510246114159156*^9, 3.51024611628076*^9}, {3.510363189787038*^9, 
   3.51036319690065*^9}, {3.5103640464937315`*^9, 3.5103640484749346`*^9}, {
   3.510772975664796*^9, 3.510772977544798*^9}, {3.510939725024397*^9, 
   3.510939770420476*^9}, {3.511622781619308*^9, 3.5116228029133453`*^9}, {
   3.51162285734184*^9, 3.5116228920987005`*^9}, {3.5116252490132103`*^9, 
   3.5116252551752205`*^9}, {3.5116420095352383`*^9, 3.5116420648373346`*^9}, 
   3.5116420958501883`*^9, {3.5116421457078753`*^9, 3.511642188015149*^9}, {
   3.5116422669668865`*^9, 3.511642273565698*^9}, {3.5116431630456486`*^9, 
   3.5116431815784807`*^9}, {3.5116432151497393`*^9, 
   3.5116432191745462`*^9}, {3.511643565061549*^9, 3.5116436303944635`*^9}, {
   3.5116436633261204`*^9, 3.5116436980985813`*^9}, {3.5116439905054913`*^9, 
   3.511644032438364*^9}, {3.511644738725196*^9, 3.511644739676797*^9}, {
   3.511645516715352*^9, 3.511645526418569*^9}, {3.511663172856595*^9, 
   3.5116631848998156`*^9}, {3.5123913190856752`*^9, 3.512391320195677*^9}, 
   3.514737078222192*^9, {3.5157290708393345`*^9, 3.515729071931337*^9}, {
   3.515730441698127*^9, 3.515730448546539*^9}, {3.5249708309603434`*^9, 
   3.5249709233004704`*^9}, {3.5249709608705225`*^9, 3.5249711125107317`*^9}, 
   3.5249720959220886`*^9, {3.525013335390806*^9, 3.5250133827056885`*^9}, {
   3.5250137157506695`*^9, 3.525013738635909*^9}, {3.5579324320829763`*^9, 
   3.5579325376639605`*^9}, {3.557932615960497*^9, 3.5579327727875705`*^9}, {
   3.557932936260256*^9, 3.5579329385690594`*^9}, {3.5579335132740617`*^9, 
   3.557933526721285*^9}, 3.5579335764541717`*^9, {3.557933682237956*^9, 
   3.557933688509167*^9}, {3.557933728429637*^9, 3.557933729896039*^9}, {
   3.5579338380510283`*^9, 3.5579338394550304`*^9}, 3.5602215933973017`*^9, {
   3.560223301509659*^9, 3.560223307409667*^9}, {3.562531042626876*^9, 
   3.5625310451540804`*^9}, {3.5625310996605754`*^9, 
   3.5625311319058313`*^9}, {3.562613918610786*^9, 3.5626139271908007`*^9}, {
   3.5626141997544765`*^9, 3.562614260906583*^9}, {3.5626149918926573`*^9, 
   3.562615021002308*^9}, {3.5783365397936935`*^9, 3.578336555483715*^9}, {
   3.580500080629549*^9, 3.580500096447976*^9}, {3.5806611998286266`*^9, 
   3.5806613041616087`*^9}, {3.5944965658423977`*^9, 3.594496576492412*^9}, {
   3.594496608982457*^9, 3.5944966093724575`*^9}, {3.5944966911845713`*^9, 
   3.594496692754574*^9}, {3.594496728468626*^9, 3.5944967291186275`*^9}, {
   3.594497682829956*^9, 3.5944978229821506`*^9}, {3.594753965528139*^9, 
   3.594754031765232*^9}, {3.5947540663077793`*^9, 3.5947540891418133`*^9}, {
   3.5948711541024694`*^9, 3.5948711603624783`*^9}, {3.595217323377353*^9, 
   3.595217326837358*^9}, {3.5952173994894595`*^9, 3.595217464063551*^9}, 
   3.595217561323685*^9, 3.595217906776163*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"quaternion", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Sqrt]", 
      RowBox[{"Chop", "[", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"length", "[", "v", "]"}], "2"]}], "]"}]}], ",", "v"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lengthWV", "[", 
    RowBox[{"{", 
     RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
   RowBox[{"length", "[", 
    RowBox[{"{", 
     RowBox[{"w", ",", 
      RowBox[{"length", "[", "v", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotAxisOfWV", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"w", "\[GreaterEqual]", "0"}], ",", "v", ",", 
      RowBox[{"{", 
       RowBox[{"999", ",", "999", ",", "999"}], "}"}]}], "]"}]}], ";"}], 
  "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "had", " ", "to", " ", "be", " ", "changed", " ", "from", " ", "RotAxis",
       " ", "so", " ", "as", " ", "not", " ", "to", " ", "conflict", " ", 
      "with", " ", "CRYSTALLOGRAPHIC", " ", "GROUPS"}], ",", " ", 
     RowBox[{"04", "-", "04", "-", "2011"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotAngOfWV", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"w", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{"2", 
       RowBox[{"arcsind", "[", 
        RowBox[{"length", "[", "v", "]"}], "]"}]}], ",", "999"}], "]"}]}], 
   ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "had", " ", "to", " ", "be", " ", "changed", " ", "from", " ", 
      "RotAngle", " ", "so", " ", "as", " ", "not", " ", "to", " ", 
      "conflict", " ", "with", " ", "CRYSTALLOGRAPHIC", " ", "GROUPS"}], ",", 
     " ", 
     RowBox[{"04", "-", "04", "-", "2011"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
  "        "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WVproduct", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"w1_", ",", 
       RowBox[{"{", 
        RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"w2_", ",", 
       RowBox[{"{", 
        RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"w1", " ", "w2"}], "-", 
      RowBox[{"x1", " ", "x2"}], "-", 
      RowBox[{"y1", " ", "y2"}], "-", 
      RowBox[{"z1", " ", "z2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"w2", " ", "x1"}], "+", 
        RowBox[{"w1", " ", "x2"}], "-", 
        RowBox[{"y2", " ", "z1"}], "+", 
        RowBox[{"y1", " ", "z2"}]}], ",", 
       RowBox[{
        RowBox[{"w2", " ", "y1"}], "+", 
        RowBox[{"w1", " ", "y2"}], "+", 
        RowBox[{"x2", " ", "z1"}], "-", 
        RowBox[{"x1", " ", "z2"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "x2"}], " ", "y1"}], "+", 
        RowBox[{"x1", " ", "y2"}], "+", 
        RowBox[{"w2", " ", "z1"}], "+", 
        RowBox[{"w1", " ", "z2"}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WVproduct", "[", 
    RowBox[{"q1_", ",", "q2_", ",", "q3_"}], "]"}], ":=", 
   RowBox[{"WVproduct", "[", 
    RowBox[{
     RowBox[{"WVproduct", "[", 
      RowBox[{"q1", ",", "q2"}], "]"}], ",", "q3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"wPositivePt", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"sign", "[", "w", "]"}], 
     RowBox[{"{", 
      RowBox[{"w", ",", "v"}], "}"}]}]}], ";"}], "    "}]}], "Input",
 CellChangeTimes->{{3.5054402308477435`*^9, 3.505440252282181*^9}, {
   3.5054403043706717`*^9, 3.505440407720852*^9}, {3.5054405825362186`*^9, 
   3.5054405838934207`*^9}, {3.505440613985873*^9, 3.5054406262162943`*^9}, 
   3.505440693546012*^9, 3.5114658714374523`*^9, {3.5114663897079563`*^9, 
   3.5114663966187677`*^9}, {3.5114677692039614`*^9, 
   3.5114677702335634`*^9}, {3.5116236451588135`*^9, 3.511623653317628*^9}, {
   3.5116246389429464`*^9, 3.51162464689896*^9}, {3.511624713729477*^9, 
   3.511624776566386*^9}, {3.5116250129535985`*^9, 3.5116250364940395`*^9}, {
   3.5116250730449033`*^9, 3.511625079877715*^9}, {3.511625130858604*^9, 
   3.511625139407419*^9}, {3.5133049124156895`*^9, 3.5133049570629673`*^9}, {
   3.5133051334368744`*^9, 3.513305134248076*^9}, {3.5133062472788167`*^9, 
   3.513306265733649*^9}, {3.513308973765971*^9, 3.513308989428399*^9}, {
   3.514737018708088*^9, 3.51473703671052*^9}, {3.5147371022150335`*^9, 
   3.514737120467066*^9}, 3.5223807941244354`*^9, {3.5223808283544827`*^9, 
   3.52238083368449*^9}, {3.5930249376838675`*^9, 3.5930249617339*^9}, {
   3.5944962535439587`*^9, 3.5944962585839653`*^9}, {3.594496331438069*^9, 
   3.5944963320380697`*^9}, {3.5944963698281217`*^9, 3.594496377268132*^9}, 
   3.594497511455717*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["uvw coordinates in \[CapitalLambda] - space", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"uG", "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["2"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["6"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], 
       SqrtBox["3"]]}], "}"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"this", " ", "is", " ", "V", " ", "of", " ", "Eq", " ", 
      RowBox[{"(", "14", ")"}], " ", "of", " ", "TapeTape2013"}], ",", " ", 
     RowBox[{
     "also", " ", "U", " ", "on", " ", "p", " ", "8", " ", "of", " ", 
      "TapeTape2012beach"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uvw\[CapitalLambda]", "[", "\[CapitalLambda]_", "]"}], ":=", 
   RowBox[{"uG", ".", "\[CapitalLambda]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uFN", "[", "\[CapitalLambda]_", "]"}], ":=", 
    RowBox[{
     RowBox[{"uvw\[CapitalLambda]", "[", "\[CapitalLambda]", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "same", " ", "notation", " ", "is", " ", "used", " ", "for", " ", "the", 
     " ", "orientation", " ", "in", " ", "beachball", " ", "plotting"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vFN", "[", "\[CapitalLambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"uvw\[CapitalLambda]", "[", "\[CapitalLambda]", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wFN", "[", "\[CapitalLambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"uvw\[CapitalLambda]", "[", "\[CapitalLambda]", "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5704628783153825`*^9, 3.570462880436986*^9}, {
  3.5944983435308743`*^9, 3.594498344120875*^9}, {3.5944987105073843`*^9, 
  3.594498713437388*^9}, {3.594585788620703*^9, 3.594585802630723*^9}, {
  3.594592813492484*^9, 3.59459281765249*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Beta] \[Gamma] coordinates on lune, in radians", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927431254429502`*^9, 3.692743137318003*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]of\[Beta]\[Gamma]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Transpose", "[", "uG", "]"}], ".", 
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ",", "\[Beta]"}], "}"}], "]"}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "WATCH", " ", "ORDER", " ", "ON", " ", "\[Gamma]", " ", "AND", " ", 
     "\[Beta]"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]\[Gamma]FN", "[", "\[CapitalLambda]_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Beta]FN", "[", "\[CapitalLambda]", "]"}], ",", 
      RowBox[{"\[Gamma]FN", "[", "\[CapitalLambda]", "]"}]}], "}"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]FN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", "\[Lambda]3"}], 
      RowBox[{
       SqrtBox["3"], 
       RowBox[{"length", "[", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}], 
        "]"}]}]], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eq", " ", 
      RowBox[{"(", "20", ")"}], " ", "of", " ", "TapeTape2013"}], ",", " ", 
     RowBox[{"also", " ", "Eq", " ", 
      RowBox[{"(", "21", ")"}], " ", "of", " ", "TapeTape2012beach"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]FN", "[", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
    "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "\[Lambda]1"}], "+", 
      RowBox[{"2", "\[Lambda]2"}], "-", "\[Lambda]3"}], 
     RowBox[{
      SqrtBox["3"], 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", "-", "\[Lambda]3"}], ")"}]}]], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Gamma]FN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{
       SqrtBox["3"], 
       RowBox[{"(", 
        RowBox[{"\[Lambda]1", "-", "\[Lambda]3"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"-", "\[Lambda]1"}], "+", 
       RowBox[{"2", "\[Lambda]2"}], "-", "\[Lambda]3"}]}], "]"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", 
   StyleBox[
    RowBox[{" ", 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]]}]], 
   StyleBox[
    RowBox[{"changed", " ", "March", " ", "2017"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.594498627307269*^9, {3.594498812221527*^9, 3.5944988228615417`*^9}, {
   3.5945927530124006`*^9, 3.5945927718624268`*^9}, 3.5948265368658333`*^9, {
   3.5948279139343724`*^9, 3.5948279177243776`*^9}, 3.594828172822736*^9, {
   3.5982348284605865`*^9, 3.5982349377077384`*^9}, {3.6979965530945663`*^9, 
   3.6979965935108805`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
uv coodinates for lune. u v \[Kappa] \[Sigma] h are uniform in space of \
moment tensors of unit norm\
\>", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927431254429502`*^9, 3.692743137318003*^9}, {3.6927431792712083`*^9, 
  3.692743218818122*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vof\[Gamma]", "[", "\[Gamma]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"3", "\[Gamma]"}], "]"}], "/", "3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"uof\[Beta]", "[", "\[Beta]_", "]"}], ":=", 
    RowBox[{
     FractionBox[
      RowBox[{"3", " ", "\[Beta]"}], "4"], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Beta]"}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "16"], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"4", " ", "\[Beta]"}], "]"}]}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"integral", " ", "of", " ", 
     SuperscriptBox["sin", "4"]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]ofu", "[", "u_", "]"}], ":=", 
   RowBox[{"\[Beta]", "/.", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"uof\[Beta]", "[", "\[Beta]", "]"}], "\[Equal]", "u"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", 
        FractionBox[
         RowBox[{"3", " ", "\[Pi]"}], "16"]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]ofv", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", "3"}], " ", 
    RowBox[{"ArcSin", "[", 
     RowBox[{"3", "v"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]\[Gamma]ofuv", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]ofu", "[", "u", "]"}], ",", 
     RowBox[{"\[Gamma]ofv", "[", "v", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]ofuv", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"\[CapitalLambda]of\[Beta]\[Gamma]", "[", 
     RowBox[{"\[Beta]\[Gamma]ofuv", "[", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v"}], "}"}], "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "not", " ", "same", " ", "order", " ", "as", " ", "in", " ", "our", " ", 
     "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.633548216523103*^9, 3.633548287773202*^9}, 
   3.633548357853298*^9, 3.6335492868416023`*^9, 3.633703383291732*^9, 
   3.6337035039638996`*^9, {3.6337035759139986`*^9, 3.633703612688052*^9}, {
   3.633703810082327*^9, 3.6337038184423385`*^9}, {3.633703863912401*^9, 
   3.6337039029944563`*^9}, {3.6337039725445523`*^9, 
   3.6337039955445843`*^9}, {3.633704028274629*^9, 3.6337040314146338`*^9}, {
   3.6347833840283585`*^9, 3.634783403978386*^9}, {3.636231067914963*^9, 
   3.6362311134920273`*^9}, 3.636231150872079*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uof\[Beta]", "[", "\[Pi]", "]"}]], "Input",
 CellChangeTimes->{
  3.6347830127778463`*^9, {3.634783419788408*^9, 3.634783420528409*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", "\[Pi]"}], "4"]], "Output",
 CellChangeTimes->{3.634783013397847*^9, 3.6347834247284145`*^9, 
  3.642958295146806*^9, 3.6452289580965166`*^9, 3.645980147813698*^9, 
  3.6464885516453714`*^9, 3.6480873331106052`*^9, 3.6529377643459673`*^9, 
  3.6571675061784515`*^9, 3.671384367008089*^9, 3.6718108834371433`*^9, 
  3.6788241777719836`*^9, 3.6856487296168013`*^9, 3.690833499118154*^9, 
  3.6954834763753057`*^9, 3.6979930776185236`*^9, 3.6987677864257793`*^9, 
  3.698792305274748*^9, 3.7111239951140194`*^9, 3.7111287244598436`*^9, 
  3.711286624966124*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]of\[Beta]\[Gamma]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Transpose", "[", "uG", "]"}], ".", 
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]", ",", "\[Beta]"}], "}"}], "]"}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "WATCH", " ", "ORDER", " ", "ON", " ", "\[Gamma]", " ", "AND", " ", 
     "\[Beta]"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\[Phi] \[Theta] coodinates for lune. in radians, centered at ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalLambda]", "D"], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927431254429502`*^9, 3.692743137318003*^9}, {3.6927431792712083`*^9, 
  3.692743218818122*^9}, {3.692743285224499*^9, 3.6927433382558603`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]of\[Phi]\[Theta]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Transpose", "[", "uG", "]"}], ".", 
     RowBox[{"XRot", "[", "\[Pi]", "]"}], ".", 
     RowBox[{"YRot", "[", 
      RowBox[{"\[Pi]", "/", "2"}], "]"}], ".", 
     RowBox[{"xyzTP", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"WATCH", " ", "ORDER", " ", "ON", " ", "THETA", " ", "AND", " ", 
     RowBox[{"PHI", ".", " ", "Max"}], " ", "\[Phi]", " ", "is", " ", 
     RowBox[{
      RowBox[{"\[Phi]crack\[Theta]", "[", "\[Theta]", "]"}], "."}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]FN", "[", "\[CapitalLambda]_", "]"}], ":=", 
    RowBox[{"Theta", "[", 
     RowBox[{
      RowBox[{"ZRot", "[", "\[Pi]", "]"}], ".", 
      RowBox[{"YRot", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ".", "uG", ".", 
      "\[CapitalLambda]"}], "]"}]}], ";"}], "       ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"changed", " ", "Feb", " ", "2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]FN", "[", "\[CapitalLambda]_", "]"}], ":=", 
    RowBox[{"Phi", "[", 
     RowBox[{
      RowBox[{"ZRot", "[", "\[Pi]", "]"}], ".", 
      RowBox[{"YRot", "[", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ".", "uG", ".", 
      "\[CapitalLambda]"}], "]"}]}], ";"}], "       ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"added", " ", "Jan", " ", "2014"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TanThetaFN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    FractionBox[
     RowBox[{"\[Lambda]1", "-", 
      RowBox[{"2", " ", "\[Lambda]2"}], "+", "\[Lambda]3"}], 
     RowBox[{
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", "\[Lambda]3"}], 
       ")"}]}]]}], ";"}], "  "}]}], "Input",
 CellChangeTimes->{{3.5944990360718355`*^9, 3.594499066051877*^9}, {
   3.5964877540904684`*^9, 3.5964877547304697`*^9}, 3.5964878048405385`*^9, {
   3.59976102203093*^9, 3.5997610521109715`*^9}, 3.600028657806818*^9, {
   3.600028747756942*^9, 3.6000287574069552`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Classical model", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927431254429502`*^9, 3.692743137318003*^9}, {3.6927431792712083`*^9, 
  3.692743218818122*^9}, {3.692743285224499*^9, 3.6927433382558603`*^9}, {
  3.6927433835372047`*^9, 3.692743386662241*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]FN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"\[Lambda]1", "-", 
       RowBox[{"2", " ", "\[Lambda]2"}], "+", "\[Lambda]3"}], 
      RowBox[{"\[Lambda]1", "-", "\[Lambda]3"}]], "]"}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Eq", " ", 
     RowBox[{"(", "32", ")"}], "a", " ", "of", " ", "TapeTape2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Nu]FN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    FractionBox["\[Lambda]2", 
     RowBox[{"\[Lambda]1", "+", "\[Lambda]3"}]]}], ";"}], 
  "                       ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Eq", " ", 
     RowBox[{"(", "32", ")"}], "b", " ", "of", " ", "TapeTape2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"N1classical", "[", "M_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Uraw", "[", "M", "]"}], ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Alpha]FN", "[", 
         RowBox[{"\[CapitalLambda]ofM", "[", "M", "]"}], "]"}]}], "/", "2"}], 
      "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Eq", " ", 
     RowBox[{"(", "36", ")"}], " ", "of", " ", "TapeTape2013"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"N2classical", "[", "M_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Uraw", "[", "M", "]"}], ".", 
     RowBox[{"YRot", "[", "  ", 
      RowBox[{
       RowBox[{"\[Alpha]FN", "[", 
        RowBox[{"\[CapitalLambda]ofM", "[", "M", "]"}], "]"}], "/", "2"}], 
      "]"}], ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalLambda]of\[Alpha]\[Nu]", "[", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]_", ",", "\[Nu]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "\[Nu]"}]}]]}], ",", 
     FractionBox[
      RowBox[{"2", " ", "\[Nu]", " ", 
       RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "\[Nu]"}]}]], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       RowBox[{"Cos", "[", "\[Alpha]", "]"}], 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "\[Nu]"}]}]]}]}], "}"}]}], ";", "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"not", " ", "normalized"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5948432916647186`*^9, 3.5948433121747465`*^9}, {
   3.5948434048368764`*^9, 3.5948436011911497`*^9}, 3.595009661180732*^9, 
   3.595009796020919*^9, {3.59639072706717*^9, 3.5963907292671733`*^9}, {
   3.596690988838355*^9, 3.596690997490368*^9}, {3.5974353873870983`*^9, 
   3.597435394377108*^9}, {3.5977262814327316`*^9, 3.5977262888227415`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Basic CDC functions of \[CapitalLambda].  No generalized  CDCs.  Angles in \
radians.\
\>", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927431254429502`*^9, 3.692743137318003*^9}, {3.6927431792712083`*^9, 
  3.692743218818122*^9}, {3.692743285224499*^9, 3.6927433382558603`*^9}, {
  3.6927433835372047`*^9, 3.6927434465061216`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Chi]FN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     FractionBox[
      SqrtBox[
       RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}]], 
      SqrtBox[
       RowBox[{"\[Lambda]2", "-", "\[Lambda]3"}]]], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"equivalent", " ", "to", " ", "Eq", " ", 
     RowBox[{"(", "51", ")"}], " ", "of", " ", "TapeTape2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sFN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Lambda]2", "-", "\[Lambda]3"}], ")"}]}]}]]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Sin", " ", 
      RowBox[{"\[Zeta]", ".", " ", 
       StyleBox["Ass",
        FontColor->RGBColor[1, 0, 0]]}], "umes"}], " ", "|", 
     "\[CapitalLambda]", "|", " ", 
     RowBox[{"=", " ", 
      RowBox[{"1.", " ", "Equivalent", " ", "to", " ", "Eq", " ", 
       RowBox[{"(", "46", ")"}], " ", "of", " ", "TapeTape2013"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Zeta]FN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     SqrtBox[
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"\[Lambda]2", "-", "\[Lambda]3"}], ")"}]}]], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eq", " ", 
      RowBox[{"(", "46", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2013", ".", " ", 
       StyleBox[
        RowBox[{"A", 
         StyleBox["ss",
          FontColor->RGBColor[1, 0, 0]]}]]}], "umes"}], " ", "|", 
     "\[CapitalLambda]", "|", " ", 
     RowBox[{"=", " ", "1"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KmatFN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    FractionBox[
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]2", ",", "\[Lambda]2", ",", 
        RowBox[{"\[Lambda]1", "-", "\[Lambda]2", "+", "\[Lambda]3"}]}], "}"}],
       "]"}], 
     RowBox[{"sFN", "[", 
      RowBox[{"{", 
       RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}], 
      "]"}]]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eq", " ", 
      RowBox[{"(", "47", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2013", ".", " ", "REQUIRES"}]}], " ", "|", 
     "\[CapitalLambda]", "|", " ", 
     RowBox[{"=", " ", "1."}]}],
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]crackFN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       RowBox[{"sFN", "[", 
        RowBox[{"{", 
         RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], " ", 
         "}"}], "]"}]}]], 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]1", "+", "\[Lambda]3", "+", " ", 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "-", 
            RowBox[{"2", " ", "\[Lambda]2"}], "+", "\[Lambda]3"}], ")"}], 
          "2"]]}], ",", 
       RowBox[{"2", "\[Lambda]2"}], ",", 
       RowBox[{"\[Lambda]1", "+", "\[Lambda]3", "-", " ", 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "-", 
            RowBox[{"2", " ", "\[Lambda]2"}], "+", "\[Lambda]3"}], ")"}], 
          "2"]]}]}], "}"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"REQUIRES", " ", "|", "\[CapitalLambda]", "|", " ", 
     RowBox[{"=", " ", "1."}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CDCmatFN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[Lambda]2", "0", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "-", "\[Lambda]3"}], ")"}]}]]},
       {"0", "\[Lambda]2", "0"},
       {
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "-", "\[Lambda]3"}], ")"}]}]], "0", 
        RowBox[{"\[Lambda]1", "-", "\[Lambda]2", "+", "\[Lambda]3"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], "           ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eq", " ", 
      RowBox[{"(", "48", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2013", ".", " ", "REQUIRES"}]}], " ", "|", 
     "\[CapitalLambda]", "|", " ", 
     RowBox[{"=", " ", "1."}]}],
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UhFN", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          SqrtBox[
           RowBox[{"\[Lambda]2", "-", "\[Lambda]3"}]], 
          SqrtBox[
           RowBox[{"\[Lambda]1", "-", "\[Lambda]3"}]]], ",", "0", ",", 
         FractionBox[
          SqrtBox[
           RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}]], 
          SqrtBox[
           RowBox[{"\[Lambda]1", "-", "\[Lambda]3"}]]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SqrtBox[
            RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}]], 
           SqrtBox[
            RowBox[{"\[Lambda]1", "-", "\[Lambda]3"}]]]}], ",", "0", ",", 
         FractionBox[
          SqrtBox[
           RowBox[{"\[Lambda]2", "-", "\[Lambda]3"}]], 
          SqrtBox[
           RowBox[{"\[Lambda]1", "-", "\[Lambda]3"}]]]}], "}"}]}], "}"}], 
     "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Frame", " ", "matrix", " ", "of", " ", 
      SuperscriptBox["M", "h"]}], ",", " ", 
     RowBox[{"Eq", " ", 
      RowBox[{"(", "48", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2013", ".", " ", "Basic"}], " ", "CDC", " ", "only"}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.560701622459776*^9, 3.5607016233957777`*^9}, {
   3.560701660684243*^9, 3.5607016615404453`*^9}, {3.5607017572972126`*^9, 
   3.560701758308114*^9}, {3.5607021406656837`*^9, 3.560702147802396*^9}, {
   3.5607024363157005`*^9, 3.560702468038056*^9}, {3.560704804906631*^9, 
   3.560704806107833*^9}, {3.5608758281968718`*^9, 3.560875828992473*^9}, 
   3.5609187335888596`*^9, {3.5609187917925606`*^9, 3.5609187933681636`*^9}, 
   3.5615246278065753`*^9, {3.5615252550820694`*^9, 3.5615252561272707`*^9}, {
   3.5625253702160645`*^9, 3.562525466296632*^9}, {3.564773269498176*^9, 
   3.564773303241035*^9}, {3.5647733447371073`*^9, 3.5647733589799323`*^9}, {
   3.5647746840930424`*^9, 3.5647747288183203`*^9}, {3.56477498110196*^9, 
   3.564774988262373*^9}, {3.565842633716466*^9, 3.5658426507198963`*^9}, {
   3.5668558400962963`*^9, 3.5668558408606973`*^9}, {3.5668783214146695`*^9, 
   3.566878323551873*^9}, {3.5668784613732147`*^9, 3.5668784659596224`*^9}, {
   3.5703880647541676`*^9, 3.570388067334171*^9}, {3.5703881113842316`*^9, 
   3.5703881127892337`*^9}, {3.5703881433392763`*^9, 
   3.5703881438092766`*^9}, {3.570388289296978*^9, 3.570388321369522*^9}, {
   3.5703948694563074`*^9, 3.57039488582633*^9}, {3.5703954881611624`*^9, 
   3.5703954890411634`*^9}, 3.5704622929717565`*^9, 3.5704628394245143`*^9, {
   3.5705059073211737`*^9, 3.5705059225936003`*^9}, {3.570507225741872*^9, 
   3.570507229548279*^9}, {3.570508438213587*^9, 3.570508502158098*^9}, {
   3.5705085401129646`*^9, 3.5705085405653653`*^9}, {3.5705086109058876`*^9, 
   3.570508687892022*^9}, 3.5705111222294664`*^9, 3.5705449754937096`*^9, 
   3.570545091651512*^9, 3.570545171383251*^9, 3.57054524538978*^9, {
   3.570545444138527*^9, 3.5705454614389567`*^9}, 3.570546313654043*^9, {
   3.570546818564523*^9, 3.570546876581024*^9}, 3.5705469719283905`*^9, {
   3.570547016684869*^9, 3.5705470228000793`*^9}, {3.570553012671291*^9, 
   3.570553036320932*^9}, {3.570553132797901*^9, 3.570553133484302*^9}, {
   3.5705532038404245`*^9, 3.5705532204700537`*^9}, {3.5705532506405063`*^9, 
   3.5705532507497063`*^9}, 3.5708554033368163`*^9, {3.5708554384524775`*^9, 
   3.5708554454256897`*^9}, {3.5721195820194263`*^9, 
   3.5721195972994475`*^9}, {3.582675943703022*^9, 3.5826759448262243`*^9}, {
   3.582676858192217*^9, 3.5826770081864777`*^9}, {3.5826778800095983`*^9, 
   3.5826778825368023`*^9}, {3.5827729364535313`*^9, 
   3.5827729680735745`*^9}, {3.5827731241437902`*^9, 3.582773128333796*^9}, {
   3.5944992927181935`*^9, 3.594499293608195*^9}, {3.5944993871303253`*^9, 
   3.594499409204358*^9}, {3.5944998140209208`*^9, 3.594499841900959*^9}, {
   3.5944998936810303`*^9, 3.5944999431851015`*^9}, {3.594499973735143*^9, 
   3.5944999997171803`*^9}, {3.594500056117258*^9, 3.594500056767259*^9}, {
   3.594500109537332*^9, 3.5945001678594136`*^9}, {3.594500375913703*^9, 
   3.594500379723708*^9}, {3.594500479823847*^9, 3.5945005518559504`*^9}, {
   3.594500640328074*^9, 3.5945006780681257`*^9}, 3.5963904205607433`*^9, {
   3.596390722517164*^9, 3.5963907338071795`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Other basic CDC functions, not as functions of the eigenvalues.  No \
generalized CDCs.  Angles in radians.\
\>", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927431254429502`*^9, 3.692743137318003*^9}, {3.6927431792712083`*^9, 
  3.692743218818122*^9}, {3.692743285224499*^9, 3.6927433382558603`*^9}, {
  3.6927433835372047`*^9, 3.692743504724985*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]of\[Zeta]", "[", 
     RowBox[{"\[Zeta]_", ",", "\[Theta]_"}], "]"}], ":=", 
    RowBox[{"ArcSin", "[", 
     RowBox[{
      SqrtBox[
       FractionBox[
        RowBox[{"2", " "}], 
        RowBox[{"5", "-", 
         RowBox[{"3", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]]], 
      RowBox[{"Sin", "[", "\[Zeta]", "]"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"\[Phi]", " ", "is", " ", 
     RowBox[{"arclength", ".", " ", "See"}], " ", "Eq", " ", 
     RowBox[{"(", "59", ")"}], " ", "of", " ", "TapeTape2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rCrack\[Theta]", "[", "\[Theta]_", "]"}], ":=", 
   FractionBox[
    SqrtBox["2"], 
    SqrtBox[
     RowBox[{"5", "-", 
      RowBox[{"3", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Theta]"}], "]"}]}]}]]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rCrack\[Theta]", "[", "\[Theta]_", "]"}], ":=", 
   FractionBox["1", 
    SqrtBox[
     RowBox[{
      RowBox[{"4", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}]]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]crack\[Theta]", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"ArcSin", "[", 
    SqrtBox[
     FractionBox[
      RowBox[{"2", " "}], 
      RowBox[{"5", "-", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Theta]"}], "]"}]}]}]]], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]crack\[Theta]", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{
     RowBox[{"rCrack\[Theta]", "[", "\[Theta]", "]"}], 
     RowBox[{
      RowBox[{"Transpose", "[", "uG", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SqrtBox["3"], 
         SqrtBox[
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]]}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"signs", " ", "changed", " ", "2013"}], "-", "01", "-", 
      RowBox[{"10", " ", "when", " ", "\[Theta]"}]}], " ", "\[Rule]", " ", 
     RowBox[{"\[Theta]", " ", "-", " ", "\[Pi]"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Kmat\[Theta]", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{"KmatFN", "[", 
     RowBox[{"\[CapitalLambda]crack\[Theta]", "[", "\[Theta]", "]"}], "]"}]}],
    ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Eq", " ", 
     RowBox[{"(", "41", ")"}], " ", "of", " ", "TapeTape2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesOfXmatrix", "[", 
    RowBox[{"s1_", ",", "s2_", ",", "s3_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"s1", "+", "s3"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s1", "-", "s3"}], ")"}], "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["t", "2"]}]}]]}]}], ",", "s2", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"s1", "+", "s3"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"s1", "-", "s3"}], ")"}], "2"], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["t", "2"]}]}]]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesOfXmatrix", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"s1_", "0.", "t_"},
       {"0.", "s2_", "0."},
       {"t_", "0.", "s3_"}
      }], "\[NoBreak]", ")"}], "]"}], ":=", 
   RowBox[{"EigenvaluesOfXmatrix", "[", 
    RowBox[{"s1", ",", "s2", ",", "s3", ",", "t"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CDCmat\[Zeta]\[Theta]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Zeta]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Zeta]", "]"}], 
      RowBox[{"Dmat", "[", 
       RowBox[{"0", ",", " ", "0"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Zeta]", "]"}], 
      RowBox[{"Kmat\[Theta]", "[", "\[Theta]", "]"}]}]}]}], ";"}], 
  "         ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "same", " ", "notation", " ", "for", " ", "generalized", " ", "CDCs"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalLambda]CDC\[Zeta]\[Theta]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Zeta]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
    RowBox[{"EigenvaluesOfXmatrix", "[", 
     RowBox[{"CDCmat\[Zeta]\[Theta]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Zeta]", ",", "\[Theta]"}], "}"}], "]"}], "]"}]}], ";"}], 
  "        ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "same", " ", "notation", " ", "for", " ", "generalized", " ", "CDCs"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZetaContour", "[", "\[Zeta]_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]CDC\[Zeta]\[Theta]", "[", 
       RowBox[{"{", 
        RowBox[{"\[Zeta]", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
       RowBox[{"\[Pi]", "/", "72."}]}], "]"}]}]}], " ", ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThetaContour", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalLambda]CDC\[Zeta]\[Theta]", "[", 
       RowBox[{"{", 
        RowBox[{"#", ",", "\[Theta]"}], "}"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"\[Pi]", "/", "2"}], ",", 
       RowBox[{"\[Pi]", "/", "72."}]}], "]"}]}]}], " ", ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhiContour", "[", 
     RowBox[{"\[Phi]_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "\[LessEqual]", 
       RowBox[{"\[Pi]", "/", "6."}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"MapEyeward", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"YRot", "[", 
             RowBox[{"\[Pi]", "/", "2"}], "]"}], ".", 
            RowBox[{"xyzTP", "[", 
             RowBox[{"{", 
              RowBox[{"#", ",", "\[Phi]"}], "}"}], "]"}]}], ",", ".01", ",", 
           "eye"}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"2", "\[Pi]"}], ",", 
          RowBox[{"\[Pi]", "/", "36"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"A", " ", "LIST", " ", "OF", " ", "LINES"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"YRot", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ".", 
             RowBox[{"xyzTP", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", "\[Phi]"}], "}"}], "]"}]}], ",", ".01", ",", 
            "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"myRange", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"ArcSin", "[", 
             RowBox[{
              RowBox[{"Cot", "[", "\[Phi]", "]"}], "/", 
              SqrtBox["3."]}], "]"}]}], ",", 
           RowBox[{"ArcSin", "[", 
            RowBox[{
             RowBox[{"Cot", "[", "\[Phi]", "]"}], "/", 
             SqrtBox["3"]}], "]"}], ",", "30"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"MapEyeward", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"YRot", "[", 
              RowBox[{"\[Pi]", "/", "2"}], "]"}], ".", 
             RowBox[{"xyzTP", "[", 
              RowBox[{"{", 
               RowBox[{"#", ",", "\[Phi]"}], "}"}], "]"}]}], ",", ".01", ",", 
            "eye"}], "]"}], "&"}], "/@", 
         RowBox[{"myRange", "[", 
          RowBox[{
           RowBox[{"\[Pi]", "-", 
            RowBox[{"ArcSin", "[", 
             RowBox[{
              RowBox[{"Cot", "[", "\[Phi]", "]"}], "/", 
              SqrtBox["3."]}], "]"}]}], ",", 
           RowBox[{"\[Pi]", "+", 
            RowBox[{"ArcSin", "[", 
             RowBox[{
              RowBox[{"Cot", "[", "\[Phi]", "]"}], "/", 
              SqrtBox["3"]}], "]"}]}], ",", "30"}], "]"}]}]}], "}"}]}], " ", 
     "]"}]}], ";"}], "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NuContour", "[", "\[Nu]_", "]"}], ":=", 
   RowBox[{"arc", "[", 
    RowBox[{
     RowBox[{"Unit", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "-", "\[Nu]"}], ",", "\[Nu]", ",", "\[Nu]"}], "}"}], 
      "]"}], ",", 
     RowBox[{"Unit", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "\[Nu]"}], ",", 
        RowBox[{"-", "\[Nu]"}], ",", 
        RowBox[{"\[Nu]", "-", "1"}]}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ThetaOfNu", "[", "\[Nu]_", "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    FractionBox[
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "\[Nu]"}]}], 
     RowBox[{
      SqrtBox["2"], "+", 
      RowBox[{
       SqrtBox["2"], " ", "\[Nu]"}]}]], "]"}]}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Eq", " ", 
     RowBox[{"(", 
      RowBox[{"33", "b"}], ")"}], " ", "of", " ", "TapeTape2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NuOfTheta", "[", "\[Theta]_", "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], "-", 
      RowBox[{
       SqrtBox["2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
      RowBox[{
       SqrtBox["2"], 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]]}], ";"}], "  "}]}], "Input",
 CellChangeTimes->{{3.51966778111898*^9, 3.519667924795331*^9}, {
   3.519667956920787*^9, 3.519668057033662*^9}, {3.5196681199404716`*^9, 
   3.519668139026805*^9}, {3.5196681900507946`*^9, 3.519668249070098*^9}, {
   3.5196684617834697`*^9, 3.5196684679922805`*^9}, {3.5200876541901865`*^9, 
   3.5200876720678177`*^9}, {3.520097515434721*^9, 3.5200975744184237`*^9}, {
   3.520097642684143*^9, 3.52009770962386*^9}, {3.5200978033332233`*^9, 
   3.520097803754424*^9}, {3.520192061029451*^9, 3.52019207778388*^9}, {
   3.53194990156399*^9, 3.5319499040599947`*^9}, 3.531951314069653*^9, {
   3.5577851538243146`*^9, 3.557785154697916*^9}, {3.5577852146020203`*^9, 
   3.557785234273655*^9}, {3.557785268484514*^9, 3.5577854036431503`*^9}, {
   3.557785473375272*^9, 3.5577855846190653`*^9}, {3.557785695020458*^9, 
   3.5577857831762123`*^9}, {3.5577858176834717`*^9, 
   3.5577858191186743`*^9}, {3.5577859296136675`*^9, 3.557785961578123*^9}, 
   3.557786023869032*^9, {3.5577860756611223`*^9, 3.5577860908243484`*^9}, {
   3.5577862421758122`*^9, 3.5577863184443455`*^9}, {3.5577899719610496`*^9, 
   3.5577899877170773`*^9}, {3.5577900351099596`*^9, 3.5577900390411663`*^9}, 
   3.5577900837040443`*^9, {3.557790239736392*^9, 3.5577902408127937`*^9}, {
   3.5577905222216845`*^9, 3.5577905309108996`*^9}, {3.5577905985838175`*^9, 
   3.5577905995978193`*^9}, {3.557793566812111*^9, 3.557793615000595*^9}, {
   3.557793662502678*^9, 3.5577936634854794`*^9}, {3.557796786330125*^9, 
   3.557796787297327*^9}, {3.557846085466526*^9, 3.557846088274531*^9}, {
   3.5578461608302574`*^9, 3.557846167335469*^9}, {3.5578816077010365`*^9, 
   3.557881618717156*^9}, {3.55805796217122*^9, 3.5580580187213182`*^9}, {
   3.558314987332371*^9, 3.5583150045236015`*^9}, {3.558315051234483*^9, 
   3.5583151139353924`*^9}, {3.5583151931636314`*^9, 3.558315234961104*^9}, {
   3.558315274980174*^9, 3.5583153929875803`*^9}, {3.5583154392909613`*^9, 
   3.558315483690539*^9}, {3.5583155974110374`*^9, 3.5583156588514442`*^9}, {
   3.558315703706523*^9, 3.5583157220234547`*^9}, {3.558315769618538*^9, 
   3.5583158378674574`*^9}, {3.558315895218158*^9, 3.5583160649627542`*^9}, {
   3.5583173359362755`*^9, 3.5583173824942565`*^9}, {3.5583179475556445`*^9, 
   3.558317948788047*^9}, {3.5583186893865404`*^9, 3.5583187130854816`*^9}, {
   3.5583188830684795`*^9, 3.5583188867656856`*^9}, {3.5583225249836345`*^9, 
   3.558322527339238*^9}, 3.558326208040856*^9, {3.558326253405735*^9, 
   3.558326298068613*^9}, {3.5583272706367087`*^9, 3.5583272957059526`*^9}, {
   3.558327326266406*^9, 3.5583273273896074`*^9}, {3.558328304980912*^9, 
   3.558328306213314*^9}, {3.5583285294029036`*^9, 3.5583285385133195`*^9}, {
   3.5583286006326275`*^9, 3.558328611583847*^9}, {3.558328965205263*^9, 
   3.558328972677676*^9}, 3.5583290319109793`*^9, {3.558329429924474*^9, 
   3.558329533493054*^9}, {3.5583309546867323`*^9, 3.5583310870841627`*^9}, 
   3.5583311763007183`*^9, {3.5583637014882364`*^9, 3.5583637744807634`*^9}, {
   3.558363866926525*^9, 3.5583638965353765`*^9}, 3.558363945971863*^9, {
   3.558363980525923*^9, 3.558363981040724*^9}, {3.55836401327038*^9, 
   3.558364033519215*^9}, {3.558374719964761*^9, 3.558374742226*^9}, {
   3.5583748710666246`*^9, 3.558374928927125*^9}, {3.558375310750191*^9, 
   3.5583753161946006`*^9}, {3.5583805820367823`*^9, 3.558380582941584*^9}, {
   3.55838096522025*^9, 3.5583809790730743`*^9}, {3.558387370661144*^9, 
   3.558387373172748*^9}, {3.558396643616088*^9, 3.5583966936609745`*^9}, {
   3.55839674804267*^9, 3.558396788727541*^9}, 3.558396945539014*^9, {
   3.5584154781108675`*^9, 3.5584155086557207`*^9}, {3.558488242816142*^9, 
   3.558488244578945*^9}, {3.5584883123454633`*^9, 3.5584883469463234`*^9}, {
   3.5584891578723516`*^9, 3.5584891815999928`*^9}, {3.558489277914561*^9, 
   3.5584892795837636`*^9}, {3.5584893340278587`*^9, 3.558489339971469*^9}, {
   3.558489374104328*^9, 3.5584893746815295`*^9}, {3.558489996685814*^9, 
   3.5584900037526264`*^9}, {3.558490035795082*^9, 3.5584901294576454`*^9}, {
   3.558490164854107*^9, 3.558490164869707*^9}, {3.558490206989781*^9, 
   3.5584902320434246`*^9}, {3.55849028115231*^9, 3.5584902816827106`*^9}, 
   3.558490357327243*^9, {3.558499399219924*^9, 3.5584994156935525`*^9}, {
   3.558499480043665*^9, 3.5584995040989065`*^9}, {3.5585000463782525`*^9, 
   3.558500080635912*^9}, {3.5585001634252567`*^9, 3.558500233016978*^9}, {
   3.558500289957077*^9, 3.5585003256655397`*^9}, {3.5585004632733793`*^9, 
   3.558500465519783*^9}, {3.5585007231386323`*^9, 3.5585007250262356`*^9}, {
   3.5585007834639378`*^9, 3.5585008126827884`*^9}, {3.5585008469248486`*^9, 
   3.5585008501540537`*^9}, {3.5585010587832174`*^9, 3.558501060920421*^9}, {
   3.5585011477373714`*^9, 3.558501185012236*^9}, {3.5585704190390296`*^9, 
   3.558570492608758*^9}, {3.558574267304537*^9, 3.558574312263815*^9}, 
   3.5585743490398793`*^9, {3.5585743815747356`*^9, 3.5585744358316307`*^9}, 
   3.5585745486854267`*^9, {3.5585746173343463`*^9, 3.558574618410748*^9}, {
   3.5585746664208317`*^9, 3.5585746719900413`*^9}, {3.5585748756691957`*^9, 
   3.558574881004405*^9}, {3.5586442364437337`*^9, 3.558644256489769*^9}, {
   3.558644313960269*^9, 3.5586443410263157`*^9}, {3.5586443717583694`*^9, 
   3.558644378123181*^9}, 3.5586444399772882`*^9, {3.5586445549338894`*^9, 
   3.558644559286297*^9}, {3.558644593731157*^9, 3.558644697596138*^9}, {
   3.558645484014109*^9, 3.558645546960219*^9}, {3.5586733928075476`*^9, 
   3.558673399203559*^9}, {3.5587382518729987`*^9, 3.558738278720646*^9}, {
   3.5587395302484274`*^9, 3.558739533368433*^9}, {3.5587397204819593`*^9, 
   3.55873973227558*^9}, {3.558740015128473*^9, 3.5587400289188967`*^9}, {
   3.55874006509536*^9, 3.558740145794301*^9}, {3.5587438359000435`*^9, 
   3.558743922620595*^9}, {3.5587442998448524`*^9, 3.558744393039415*^9}, {
   3.5587444432403026`*^9, 3.5587445074344144`*^9}, {3.5587445402880716`*^9, 
   3.5587445419416747`*^9}, {3.5587445813629436`*^9, 3.558744582330145*^9}, {
   3.5587446473978586`*^9, 3.5587447243527927`*^9}, {3.558744773196478*^9, 
   3.5587447753648815`*^9}, {3.5587448423825984`*^9, 3.558744853817418*^9}, {
   3.5587458506747565`*^9, 3.5587458770856028`*^9}, {3.5587467025142417`*^9, 
   3.558746703107043*^9}, {3.5587506419875393`*^9, 3.558750700596842*^9}, {
   3.558753762869382*^9, 3.5587537661297874`*^9}, 3.5587538149022727`*^9, {
   3.558892721843849*^9, 3.5588927579423122`*^9}, 3.558892796224779*^9, 
   3.5589052789605565`*^9, {3.558905312469415*^9, 3.5589053328162503`*^9}, {
   3.5589055411234136`*^9, 3.558905559484646*^9}, 3.5591490325330763`*^9, {
   3.559160287627308*^9, 3.55916030045053*^9}, {3.559240882750165*^9, 
   3.5592408948801823`*^9}, {3.559241013680346*^9, 3.559241095510459*^9}, {
   3.559241136920516*^9, 3.5592411741805677`*^9}, 3.5592412401506586`*^9, {
   3.5592436102239294`*^9, 3.559243660823999*^9}, {3.5592442829648576`*^9, 
   3.559244316654904*^9}, {3.5592451039059906`*^9, 3.559245157496064*^9}, {
   3.559245475286503*^9, 3.5592455053465443`*^9}, {3.55924553872659*^9, 
   3.5592455555366135`*^9}, {3.559490527383271*^9, 3.5594905274768715`*^9}, {
   3.559519799103754*^9, 3.5595198108037744`*^9}, {3.5595199444492073`*^9, 
   3.5595199445896077`*^9}, {3.559519994150894*^9, 3.559520029032555*^9}, {
   3.5595201123055*^9, 3.559520134629139*^9}, {3.559520191818839*^9, 
   3.5595203785979643`*^9}, {3.5595343480178566`*^9, 
   3.5595343488290577`*^9}, {3.5595854021078796`*^9, 
   3.5595854165223045`*^9}, {3.5595854674095936`*^9, 
   3.5595855148648763`*^9}, {3.5595856008990264`*^9, 
   3.5595856035042305`*^9}, {3.5595861591927996`*^9, 
   3.5595861670396137`*^9}, {3.5599234409691024`*^9, 3.5599234795167694`*^9}, 
   3.559923545957285*^9, 3.5599298216768813`*^9, {3.5599302299778957`*^9, 
   3.5599302392599115`*^9}, {3.5599358099578533`*^9, 3.5599358156543636`*^9}, 
   3.5599361441897373`*^9, 3.5599422644361825`*^9, 3.5599423183049765`*^9, {
   3.56037180071799*^9, 3.560371823748021*^9}, {3.5603722034185457`*^9, 
   3.5603722077985516`*^9}, {3.5603723704907765`*^9, 3.560372389380803*^9}, {
   3.560372433130863*^9, 3.560372434410865*^9}, {3.5603759045366545`*^9, 
   3.5603760312568293`*^9}, {3.5603770141961746`*^9, 3.560377047476221*^9}, {
   3.560377114916314*^9, 3.5603771232063255`*^9}, {3.5603771921164207`*^9, 
   3.5603771936964226`*^9}, {3.5603787586051297`*^9, 3.560378770875147*^9}, {
   3.5603788344152346`*^9, 3.5603788669952793`*^9}, {3.5603789302053666`*^9, 
   3.5603789371053762`*^9}, {3.56037896889542*^9, 3.560379086895583*^9}, {
   3.560379419316042*^9, 3.5603794197260423`*^9}, {3.5603796049362974`*^9, 
   3.5603796060162992`*^9}, {3.5603796415963483`*^9, 
   3.5603796537463655`*^9}, {3.560379705016436*^9, 3.5603797955565605`*^9}, 
   3.5603800335468893`*^9, {3.560380133847028*^9, 3.5603801388870344`*^9}, {
   3.5603804273274326`*^9, 3.5603804306574373`*^9}, {3.5603805372475843`*^9, 
   3.5603806243477044`*^9}, {3.560381014068242*^9, 3.56038101979825*^9}, {
   3.560656630023868*^9, 3.5606566359518785`*^9}, {3.560656673454344*^9, 
   3.560656750112878*^9}, {3.560656800422965*^9, 3.560656827723013*^9}, {
   3.560656913273562*^9, 3.5606569340995984`*^9}, {3.5606571761808205`*^9, 
   3.5606572058988724`*^9}, {3.560695778632554*^9, 3.5606958281520405`*^9}, {
   3.5606963909533253`*^9, 3.5606965198626504`*^9}, {3.5606965999800906`*^9, 
   3.5606966026476955`*^9}, {3.5606968366938047`*^9, 3.5606968554475374`*^9}, 
   3.5606983549096622`*^9, {3.5606986144785147`*^9, 3.5606986189557223`*^9}, {
   3.560701581484104*^9, 3.5607015894869184`*^9}, {3.560701712502034*^9, 
   3.5607017407093835`*^9}, {3.5607018246938314`*^9, 
   3.5607018300003405`*^9}, {3.5607019858247128`*^9, 
   3.5607020223381767`*^9}, {3.560702083713084*^9, 3.560702123144353*^9}, 
   3.5607047894002037`*^9, {3.5608732894752455`*^9, 3.560873291534449*^9}, {
   3.5608755847428474`*^9, 3.560875589329255*^9}, 3.5609118712233734`*^9, {
   3.5615238681468544`*^9, 3.5615239033405156`*^9}, 3.561523990111866*^9, {
   3.5615241100380745`*^9, 3.5615241634837675`*^9}, 3.5615242201914654`*^9, {
   3.5615252431636486`*^9, 3.561525244723651*^9}, {3.562615069783593*^9, 
   3.5626150808128123`*^9}, 3.562615139758915*^9, {3.563590701056597*^9, 
   3.563590710245013*^9}, {3.5635907419442687`*^9, 3.5635908174016*^9}, {
   3.566839527576385*^9, 3.566839533156393*^9}, {3.5668559187167335`*^9, 
   3.56685600811369*^9}, {3.566856692914188*^9, 3.5668567018499036`*^9}, {
   3.566857732413306*^9, 3.566857760890256*^9}, {3.566857810513343*^9, 
   3.566857819189458*^9}, {3.5668578970941944`*^9, 3.5668578978897953`*^9}, {
   3.5692175756324816`*^9, 3.569217588783304*^9}, 3.56981119517185*^9, {
   3.5698130654052105`*^9, 3.5698131128448935`*^9}, 3.5703837100116367`*^9, {
   3.570386714524798*^9, 3.5703867775798855`*^9}, {3.5703868712650146`*^9, 
   3.5703868718050156`*^9}, {3.5703870143377132`*^9, 
   3.5703870368377447`*^9}, {3.5703870863653126`*^9, 
   3.5703870911653194`*^9}, {3.570387282663085*^9, 3.570387283623086*^9}, {
   3.570387342663168*^9, 3.570387346643173*^9}, {3.570387521265915*^9, 
   3.5703875229559174`*^9}, 3.5703876337160707`*^9, {3.570387739481217*^9, 
   3.5703877421912208`*^9}, {3.570388072884178*^9, 3.5703881009342175`*^9}, {
   3.570388282526969*^9, 3.570388307869504*^9}, {3.570388343194553*^9, 
   3.57038836995459*^9}, {3.570388535699819*^9, 3.570388548369837*^9}, 
   3.5703885896898937`*^9, {3.570389371158476*^9, 3.570389372298477*^9}, {
   3.570389414863536*^9, 3.5703894642986045`*^9}, {3.5703904249024367`*^9, 
   3.570390467904998*^9}, {3.5703926752431717`*^9, 3.57039270242821*^9}, {
   3.570392787088327*^9, 3.57039281061086*^9}, {3.570392911821*^9, 
   3.570392913751003*^9}, {3.570393532801862*^9, 3.570393537176868*^9}, {
   3.5703939134973907`*^9, 3.570393941002428*^9}, 3.5703954783911486`*^9, {
   3.570410671168415*^9, 3.570410686472042*^9}, {3.5704107671441827`*^9, 
   3.570410767440583*^9}, {3.57049776115617*^9, 3.5704977650405765`*^9}, {
   3.570507340979273*^9, 3.570507363256112*^9}, 3.5705074212322135`*^9, 
   3.5705075265323973`*^9, {3.5705076649982386`*^9, 3.570507673110253*^9}, 
   3.5705449890345335`*^9, {3.5705455173182545`*^9, 3.5705455256642685`*^9}, 
   3.5705456126344204`*^9, 3.5705456767349324`*^9, 3.570545716156201*^9, {
   3.5705457698826947`*^9, 3.570545794093937*^9}, {3.570545937412587*^9, 
   3.5705459394249907`*^9}, {3.5705460983580675`*^9, 
   3.5705461023204746`*^9}, {3.5705461390273385`*^9, 3.570546147451353*^9}, {
   3.570547101783017*^9, 3.5705471157138414`*^9}, {3.5750795309226327`*^9, 
   3.5750795319834347`*^9}, {3.5826620407490034`*^9, 3.582662140299141*^9}, 
   3.594501191529852*^9, {3.5945013484300685`*^9, 3.594501364720091*^9}, {
   3.594501473600241*^9, 3.594501483422256*^9}, {3.5945859265528946`*^9, 
   3.5945859416829157`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["For generalized CDCs.  Angles in radians.", "Subsection",
 CellChangeTimes->{{3.6927429504269824`*^9, 3.6927429703332586`*^9}, {
  3.6927431254429502`*^9, 3.692743137318003*^9}, {3.6927431792712083`*^9, 
  3.692743218818122*^9}, {3.692743285224499*^9, 3.6927433382558603`*^9}, {
  3.6927433835372047`*^9, 3.6927435355063004`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dmat", "[", 
    RowBox[{"xx_", ",", "yy_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{
     RowBox[{"XRot", "[", "xx", "]"}], ".", 
     RowBox[{"YRot", "[", "yy", "]"}], ".", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"0", "0", "1"},
        {"0", "0", "0"},
        {"1", "0", "0"}
       }], "\[NoBreak]", ")"}], ".", 
     RowBox[{"YRot", "[", 
      RowBox[{"-", "yy"}], "]"}], ".", 
     RowBox[{"XRot", "[", 
      RowBox[{"-", "xx"}], "]"}]}]}]}], ";"}]], "Input"]
}, Open  ]],

Cell["Most GENERALIZED CDCS are not yet moved to this AA file.", "Subsection",
 CellChangeTimes->{{3.5703881525392885`*^9, 3.570388195526849*^9}, {
   3.570388235621904*^9, 3.5703882387719083`*^9}, 3.5704124440522156`*^9, {
   3.594501632194463*^9, 3.5945016399544735`*^9}, {3.5945045607740498`*^9, 
   3.594504562834052*^9}, {3.5963905138728733`*^9, 3.5963905151728754`*^9}, {
   3.692743933928943*^9, 3.6927439348508263`*^9}}],

Cell["Old beachball code.  Not sure what is relevant. ", "Subsection",
 CellChangeTimes->{{3.5703881525392885`*^9, 3.570388195526849*^9}, {
   3.570388235621904*^9, 3.5703882387719083`*^9}, 3.5704124440522156`*^9, {
   3.594501632194463*^9, 3.5945016399544735`*^9}, {3.5945045607740498`*^9, 
   3.594504562834052*^9}, {3.5963905138728733`*^9, 3.5963905151728754`*^9}, {
   3.692743569021986*^9, 3.6927435709125633`*^9}, {3.692743695053483*^9, 
   3.692743713850382*^9}, {3.702396959558264*^9, 3.702396984789689*^9}, 
   3.702397033333467*^9}],

Cell[CellGroupData[{

Cell["\<\
Null contour on beachball.  This stuff is old and can probably be done better \
now.\
\>", "Subsection",
 CellChangeTimes->{{3.5703881525392885`*^9, 3.570388195526849*^9}, {
  3.5944992286781054`*^9, 3.594499250098135*^9}, {3.5944993684602995`*^9, 
  3.5944993738103065`*^9}, {3.5945009818775616`*^9, 3.594500991587575*^9}, {
  3.594502675607917*^9, 3.5945027028079543`*^9}, {3.5945045329320087`*^9, 
  3.59450455378404*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 1]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Orient", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"a", "\[GreaterEqual]", "b", "\[GreaterEqual]", "c"}], ",", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"1", "0", "0"},
        {"0", "1", "0"},
        {"0", "0", "1"}
       }], "\[NoBreak]", ")"}], ",", "\[IndentingNewLine]", 
     "                                               ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", "\[GreaterEqual]", "c", "\[GreaterEqual]", "b"}], ",", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {"1", "0", "0"},
          {"0", "0", "1"},
          {"0", "1", "0"}
         }], "\[NoBreak]", ")"}], ",", "\[IndentingNewLine]", 
       "                                            ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"b", "\[GreaterEqual]", "a", "\[GreaterEqual]", "c"}], ",", 
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", "1", "0"},
            {"1", "0", "0"},
            {"0", "0", "1"}
           }], "\[NoBreak]", ")"}], ",", "\[IndentingNewLine]", 
         "                                         ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"b", "\[GreaterEqual]", "c", "\[GreaterEqual]", "a"}], ",", 
           RowBox[{"rot111", ".", "rot111"}], ",", "\[IndentingNewLine]", 
           "                                       ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", "\[GreaterEqual]", "a", "\[GreaterEqual]", "b"}], 
             ",", "rot111", ",", "\[IndentingNewLine]", 
             "                                    ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"c", "\[GreaterEqual]", "b", "\[GreaterEqual]", "a"}], 
               ",", 
               RowBox[{"(", "\[NoBreak]", GridBox[{
                  {"0", "0", "1"},
                  {"0", "1", "0"},
                  {"1", "0", "0"}
                 }], "\[NoBreak]", ")"}]}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Perm", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{
      RowBox[{"#1", "\[GreaterEqual]", "#2"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"signs", "[", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
    "]"}], ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}],
          "]"}], ",", 
        RowBox[{
         RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}],
          "]"}], ",", 
        RowBox[{
         RowBox[{"#", "<", "0"}], "&"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"{", 
          RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}],
          "]"}], ",", 
        RowBox[{
         RowBox[{"#", "==", "0"}], "&"}]}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"t_", ",", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"unit", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SqrtBox["b"], 
        SqrtBox[
         RowBox[{"-", "c"}]], 
        RowBox[{"Sin", "[", "t", "]"}]}], ",", 
       RowBox[{
        SqrtBox["a"], 
        SqrtBox[
         RowBox[{"-", "c"}]], 
        RowBox[{"Cos", "[", "t", "]"}]}], ",", 
       RowBox[{
        SqrtBox["a"], 
        SqrtBox["b"]}]}], "}"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "t", " ", "changed", " ", "to", " ", "radians", " ", "August", " ", 
     "2016"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t_", ",", "k_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"unit", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{"b", "-", "k"}]], 
         SqrtBox[
          RowBox[{"k", "-", "c"}]], 
         RowBox[{"sind", "[", "t", "]"}]}], ",", 
        RowBox[{
         SqrtBox[
          RowBox[{"a", "-", "k"}]], 
         SqrtBox[
          RowBox[{"k", "-", "c"}]], 
         RowBox[{"cosd", "[", "t", "]"}]}], ",", 
        RowBox[{
         SqrtBox[
          RowBox[{"a", "-", "k"}]], 
         SqrtBox[
          RowBox[{"b", "-", "k"}]]}]}], "}"}], "]"}]}], ";", "   ", 
    StyleBox[
     RowBox[{
     "Maybe", " ", "a", " ", "relic", " ", "from", " ", "an", " ", "old", " ",
       "beachball", " ", "drawing", " ", 
      RowBox[{"code", "?"}]}],
     FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.593059361159136*^9, 3.593059366769144*^9}, {
   3.5930596792155795`*^9, 3.5930596801155806`*^9}, {3.593060161706256*^9, 
   3.593060162706257*^9}, {3.5945859667929506`*^9, 3.594585967842952*^9}, {
   3.681932424229165*^9, 3.681932426963532*^9}, 3.6819328539175096`*^9, {
   3.681933288636364*^9, 3.681933323904217*^9}, {3.6819334434249897`*^9, 
   3.6819335016861076`*^9}, {3.681933716054347*^9, 3.681933718040305*^9}, {
   3.681933826847722*^9, 3.6819338527486677`*^9}, {3.6819339205595627`*^9, 
   3.681933964791152*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
   "BeachBallZeroContourInCoordPlane", "[", "\[CapitalLambda]_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       RowBox[{
        RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ">", "0"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "    ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{
        "I", " ", "changed", " ", "to", " ", "lists", " ", "of", " ", "lines",
          " ", "Nov", " ", "2013"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"rot111", ".", 
            RowBox[{"Orient", "[", "\[CapitalLambda]", "]"}]}], "]"}], ".", 
          RowBox[{"xyztp", "[", 
           RowBox[{"{", "        ", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"th0", "[", 
               RowBox[{"rot111", ".", 
                RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}]}], "]"}]}], 
             ",", "#"}], "}"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0.", ",", "180"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"rot111", ".", 
            RowBox[{"Orient", "[", "\[CapitalLambda]", "]"}]}], "]"}], ".", 
          RowBox[{"xyztp", "[", 
           RowBox[{"{", "           ", 
            RowBox[{
             RowBox[{"th0", "[", 
              RowBox[{"rot111", ".", 
               RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}]}], "]"}], ",", 
             "#"}], "}"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0.", ",", "180"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"rot111", ".", 
            RowBox[{"Orient", "[", "\[CapitalLambda]", "]"}]}], "]"}], ".", 
          RowBox[{"xyztp", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"180", "-", 
              RowBox[{"th0", "[", 
               RowBox[{"rot111", ".", 
                RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}]}], "]"}]}], 
             ",", "#"}], "}"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0.", ",", "180"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"rot111", ".", 
            RowBox[{"Orient", "[", "\[CapitalLambda]", "]"}]}], "]"}], ".", 
          RowBox[{"xyztp", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"180", "+", 
              RowBox[{"th0", "[", 
               RowBox[{"rot111", ".", 
                RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}]}], "]"}]}], 
             ",", "#"}], "}"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0.", ",", "180"}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeachBallZeroContour", "[", "\[CapitalLambda]_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{
         RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "<", "0"}]}], ",", 
     RowBox[{
     "BeachBallZeroContourInCoordPlane", "[", "\[CapitalLambda]", "]"}], ",", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalLambda]", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"\[CapitalLambda]", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"\[CapitalLambda]", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[GreaterEqual]", "0"}]}], ",", 
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", "0"}], "&&", 
          RowBox[{
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", "0"}], "&&", 
          RowBox[{
           RowBox[{"\[CapitalLambda]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", "0"}]}], ",", 
         RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"signs", "[", "\[CapitalLambda]", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"Orient", "[", "\[CapitalLambda]", "]"}], "]"}], ".",
                 " ", 
                RowBox[{"f", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}]}], "]"}]}], 
               "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"2", "\[Pi]"}], ",", 
                RowBox[{"1", "Degree"}]}], "]"}]}], ",", "    ", 
             RowBox[{"(*", " ", 
              StyleBox[
               RowBox[{"used", " ", "to", " ", "be", " ", 
                RowBox[{"f", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"#", ",", "0"}], "}"}], ",", " ", 
                  RowBox[{"instead", " ", "of", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{";", " ", 
                    RowBox[{"changed", " ", "August", " ", "2016"}]}]}], 
                    " "}]}]}]}]}],
               FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
             "                                             ", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Orient", "[", "\[CapitalLambda]", "]"}], "]"}], 
                 ".", " ", 
                 RowBox[{"f", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Perm", "[", "\[CapitalLambda]", "]"}]}], 
                  "]"}]}]}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0.", ",", 
                RowBox[{"2", "\[Pi]"}], ",", 
                RowBox[{"1", "Degree"}]}], "]"}]}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"signs", "[", "\[CapitalLambda]", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], ",", 
             RowBox[{"BeachBallZeroContour", "[", 
              RowBox[{"-", "\[CapitalLambda]"}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5945046576941833`*^9, 3.5945047161942644`*^9}, {
  3.5945049346985693`*^9, 3.59450494086058*^9}, {3.5945053660091715`*^9, 
  3.594505366839173*^9}, {3.6819333459636335`*^9, 3.681933404636829*^9}, {
  3.6819335339891863`*^9, 3.6819335543045177`*^9}, {3.6819335879189053`*^9, 
  3.6819336702899904`*^9}, {3.6819339774571114`*^9, 3.681934005286397*^9}, {
  3.681934069936535*^9, 3.6819340716156664`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HueContinuous", "[", 
   RowBox[{"v_", ",", "\[CapitalLambda]_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DiagonalMatrix", "[", "\[CapitalLambda]", "]"}], ".", "v"}], 
       ")"}], ".", "v"}], "\[GreaterEqual]", "0"}], ",", 
    RowBox[{"Hue", "[", 
     RowBox[{".01", ",", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DiagonalMatrix", "[", "\[CapitalLambda]", "]"}], ".", 
          "v"}], ")"}], ".", "v"}], 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]], ",", "1"}], "]"}],
     ",", "       ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{"continuous", " ", "coloring"}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    "                                                                         \
                                                  ", 
    RowBox[{"Hue", "[", 
     RowBox[{".60", ",", 
      FractionBox[
       RowBox[{"-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DiagonalMatrix", "[", "\[CapitalLambda]", "]"}], ".", 
           "v"}], ")"}], ".", "v"}]}], 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[CapitalLambda]", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.59305860649608*^9, 3.593058687248193*^9}, 
   3.593058720198238*^9, {3.5930587804028225`*^9, 3.5930587890128345`*^9}, {
   3.5945053854691987`*^9, 3.594505401589221*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Beachball code.  See the file BeachballCodeAlone or BeachballCodeExplanation.\
\>", "Subsection",
 CellChangeTimes->{{3.5703881525392885`*^9, 3.570388195526849*^9}, {
   3.570388235621904*^9, 3.5703882387719083`*^9}, 3.5704124440522156`*^9, {
   3.594501632194463*^9, 3.5945016399544735`*^9}, {3.5945045607740498`*^9, 
   3.594504562834052*^9}, {3.5963905138728733`*^9, 3.5963905151728754`*^9}, {
   3.6901659144833593`*^9, 3.690165939940239*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HueIn", "=", 
    RowBox[{"GrayLevel", "[", ".8", "]"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HueOut", "=", "Red"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HueBeach", "[", 
     RowBox[{"v_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", ".", "v"}], ")"}], ".", "v"}], ">", "0"}], ",", 
      "HueOut", ",", "HueIn"}], "]"}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiN", "[", 
   RowBox[{"\[Theta]_", ",", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}]}],
    "]"}], ":=", 
  RowBox[{"arccosd", "[", 
   SqrtBox[
    FractionBox[
     RowBox[{
      RowBox[{"\[Lambda]1", " ", 
       SuperscriptBox[
        RowBox[{"cosd", "[", "\[Theta]", "]"}], "2"]}], "+", 
      RowBox[{"\[Lambda]2", " ", 
       SuperscriptBox[
        RowBox[{"sind", "[", "\[Theta]", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{"\[Lambda]1", " ", 
       SuperscriptBox[
        RowBox[{"cosd", "[", "\[Theta]", "]"}], "2"]}], "+", 
      RowBox[{"\[Lambda]2", " ", 
       SuperscriptBox[
        RowBox[{"sind", "[", "\[Theta]", "]"}], "2"]}], "-", "\[Lambda]3"}]]],
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.546877320699519*^9, 3.5468773686852026`*^9}, {
   3.546877400400058*^9, 3.5468774326141143`*^9}, {3.5468789485311575`*^9, 
   3.5468789506527615`*^9}, {3.546878999980047*^9, 3.5468790047536554`*^9}, {
   3.5468790500249343`*^9, 3.546879089446203*^9}, {3.5468795592878227`*^9, 
   3.546879571159443*^9}, {3.546879736925332*^9, 3.5468797433213434`*^9}, {
   3.546880425853733*^9, 3.546880438224555*^9}, {3.546880804247993*^9, 
   3.546880831938041*^9}, {3.546888800652553*^9, 3.546888801229754*^9}, {
   3.5469127498017044`*^9, 3.5469127516113076`*^9}, 3.5469129694500875`*^9, {
   3.5497402996289463`*^9, 3.549740300408947*^9}, {3.5517193891705613`*^9, 
   3.5517194228816204`*^9}, {3.55777034059748*^9, 3.557770353280302*^9}, {
   3.5945030229064007`*^9, 3.594503024336403*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubdivideForLambda", "[", 
    RowBox[{"poly_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Lambda]1", "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{"\[Lambda]2", "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{"\[Lambda]3", "\[GreaterEqual]", "0"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Lambda]1", "<=", "0"}], "&&", 
        RowBox[{"\[Lambda]2", "<=", "0"}], "&&", 
        RowBox[{"\[Lambda]3", "<=", "0"}]}], ")"}]}], ",", "poly", ",", 
     RowBox[{"SubdivideMine", "[", 
      RowBox[{"poly", ",", 
       RowBox[{
        RowBox[{"phiN", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], 
           "}"}]}], "]"}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubdivideMine", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x3_", ",", "y3_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x4_", ",", "y4_"}], "}"}]}], "}"}], ",", "f_"}], "]"}], ":=",
    "                   ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{
      "my", " ", "old", " ", "Subdivide", " ", "command", " ", "is", " ", 
       "apparently", " ", "in", " ", "Mathematica", " ", "10", " ", "a", " ", 
       "canned", " ", "command"}], ",", " ", 
      RowBox[{
      "so", " ", "I", " ", "changed", " ", "it", " ", "to", " ", 
       "SubdivideMine", " ", "January", " ", "2016"}]}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"y1", "<=", 
       RowBox[{"f", "[", "x1", "]"}], "<=", "y4"}], "&&", 
      RowBox[{"y2", "<=", 
       RowBox[{"f", "[", "x2", "]"}], "<=", "y3"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x1", ",", "y1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2", ",", "y2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2", ",", 
           RowBox[{"f", "[", "x2", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"f", "[", "x1", "]"}]}], "}"}]}], "}"}], ",", "       ", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{"lower", " ", "quadrilateral"}],
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x4", ",", "y4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x3", ",", "y3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x2", ",", 
           RowBox[{"f", "[", "x2", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x1", ",", 
           RowBox[{"f", "[", "x1", "]"}]}], "}"}]}], "}"}]}], "}"}], ",", 
     "    ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"upper", " ", "quadrilateral"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"y1", "<=", 
         RowBox[{"f", "[", "x1", "]"}], "<=", "y4"}], "&&", 
        RowBox[{
         RowBox[{"f", "[", "x2", "]"}], "<=", "y2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"f", "[", "x1", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x1", "+", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y1", "-", 
                  RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"x2", "-", "x1"}], ")"}]}], 
               RowBox[{
                RowBox[{"f", "[", "x2", "]"}], "-", 
                RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"f", "[", "x1", "]"}]}], "}"}]}], "}"}], ",", "  ", 
         RowBox[{"(*", " ", 
          StyleBox[
           RowBox[{"upper", " ", "left", " ", "triangle"}],
           FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x1", ",", 
             RowBox[{"f", "[", "x1", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x1", "+", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y1", "-", 
                  RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"x2", "-", "x1"}], ")"}]}], 
               RowBox[{
                RowBox[{"f", "[", "x2", "]"}], "-", 
                RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x2", ",", "y2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x3", ",", "y3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x4", ",", "y4"}], "}"}]}], "}"}]}], "}"}], ",", "  ", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{"the", " ", "remaining", " ", "pentagon"}],
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"f", "[", "x1", "]"}], "<=", "y1"}], "&&", 
          RowBox[{"y2", "<=", 
           RowBox[{"f", "[", "x2", "]"}], "<=", "y3"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y1", "-", 
                    RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"x2", "-", "x1"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"f", "[", "x2", "]"}], "-", 
                  RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", 
               RowBox[{"f", "[", "x2", "]"}]}], "}"}]}], "}"}], ",", "  ", 
           RowBox[{"(*", " ", 
            StyleBox[
             RowBox[{"upper", " ", "right", " ", "triangle"}],
             FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x1", "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"y1", "-", 
                    RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"x2", "-", "x1"}], ")"}]}], 
                 RowBox[{
                  RowBox[{"f", "[", "x2", "]"}], "-", 
                  RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", 
               RowBox[{"f", "[", "x2", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x3", ",", "y3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x4", ",", "y4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "y1"}], "}"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"y4", "<=", 
             RowBox[{"f", "[", "x1", "]"}]}], "&&", 
            RowBox[{"y2", "<=", 
             RowBox[{"f", "[", "x2", "]"}], "<=", "y3"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x1", "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y3", "-", 
                    RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x1"}], ")"}]}], 
                   RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y3"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x3", ",", "y3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x3", ",", 
                 RowBox[{"f", "[", "x3", "]"}]}], "}"}]}], "}"}], ",", "   ", 
             RowBox[{"(*", " ", 
              StyleBox[
               RowBox[{"lower", " ", "right", " ", "triangle"}],
               FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x1", "+", 
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y3", "-", 
                    RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x1"}], ")"}]}], 
                   RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y3"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x3", ",", 
                 RowBox[{"f", "[", "x3", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x2", ",", "y2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x1", ",", "y1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"x4", ",", "y4"}], "}"}]}], "}"}]}], "}"}], ",", "  ",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"y1", "<=", 
               RowBox[{"f", "[", "x1", "]"}], "<=", "y4"}], "&&", 
              RowBox[{"y3", "<=", 
               RowBox[{"f", "[", "x2", "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x1", "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y3", "-", 
                    RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x1"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y3"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"x4", ",", "y4"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x4", ",", 
                   RowBox[{"f", "[", "x4", "]"}]}], "}"}]}], "}"}], ",", 
               RowBox[{"(*", " ", 
                StyleBox[
                 RowBox[{"lower", " ", "left", " ", "triangle"}],
                 FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x1", "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y3", "-", 
                    RowBox[{"f", "[", "x1", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x1"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x1", "]"}]}]]}], ",", "y3"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"x3", ",", "y3"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x2", ",", "y2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x1", ",", "y1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x1", ",", 
                   RowBox[{"f", "[", "x1", "]"}]}], "}"}]}], "}"}]}], "}"}], 
             ",", "  ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"f", "[", "x2", "]"}], "<=", "y2"}], "&&", 
                  RowBox[{"y4", "<=", 
                   RowBox[{"f", "[", "x4", "]"}]}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"f", "[", "x1", "]"}], "<=", "y1"}], "&&", 
                  RowBox[{"y3", "<=", 
                   RowBox[{"f", "[", "x3", "]"}]}]}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x4", "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", "-", 
                    RowBox[{"f", "[", "x4", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x4"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x4", "]"}]}]]}], ",", "y1"}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"x2", ",", "y2"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x3", ",", "y3"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x4", "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y4", "-", 
                    RowBox[{"f", "[", "x4", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x4"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x4", "]"}]}]]}], ",", "y3"}], "}"}]}], 
                  "}"}], ",", 
                 RowBox[{"(*", " ", 
                  StyleBox[
                   RowBox[{"left", " ", "quadrilateral"}],
                   FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x4", "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y1", "-", 
                    RowBox[{"f", "[", "x4", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x4"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x4", "]"}]}]]}], ",", "y1"}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"x1", ",", "y1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x4", ",", "y4"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x4", "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y4", "-", 
                    RowBox[{"f", "[", "x4", "]"}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"x2", "-", "x4"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"f", "[", "x2", "]"}], "-", 
                    RowBox[{"f", "[", "x4", "]"}]}]]}], ",", "y3"}], "}"}]}], 
                  "}"}]}], "}"}], ",", "  ", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x1", ",", "y1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x2", ",", "y2"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x3", ",", "y3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x4", ",", "y4"}], "}"}]}], "}"}], "}"}]}], 
              "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.5466796283781233`*^9, 3.5466797133202715`*^9}, {
   3.546679753349941*^9, 3.546679775080779*^9}, {3.5466798540637164`*^9, 
   3.546679872206548*^9}, {3.5466799473986793`*^9, 3.546680010422789*^9}, 
   3.5466800494384575`*^9, {3.546680084476118*^9, 3.5466801752838764`*^9}, {
   3.5466802279183683`*^9, 3.5466804013750706`*^9}, 3.546680432996326*^9, {
   3.5467116947856245`*^9, 3.5467116964548273`*^9}, {3.5467117464529147`*^9, 
   3.5467118108342266`*^9}, {3.546711865949123*^9, 3.5467119437620583`*^9}, {
   3.5467121225071707`*^9, 3.546712188120885*^9}, {3.546712324901923*^9, 
   3.5467124144928794`*^9}, {3.54671247775099*^9, 3.5467124805433946`*^9}, {
   3.5467125308222823`*^9, 3.546712532319885*^9}, {3.5467125667647448`*^9, 
   3.546712602286007*^9}, 3.5467151467958436`*^9, {3.546715303139316*^9, 
   3.546715474599215*^9}, {3.546715694596797*^9, 3.546715766793723*^9}, {
   3.5467158074473934`*^9, 3.5467158102397985`*^9}, 3.546716056096227*^9, {
   3.5467161077791176`*^9, 3.5467161154543304`*^9}, {3.5467173738461246`*^9, 
   3.5467173844541435`*^9}, {3.546717515603572*^9, 3.5467176757846513`*^9}, {
   3.546717719495928*^9, 3.5467177275767417`*^9}, {3.5467179340275016`*^9, 
   3.546717935025903*^9}, {3.5467180682189355`*^9, 3.5467181268126373`*^9}, {
   3.5467181637379017`*^9, 3.5467184048831224`*^9}, {3.5467184525880055`*^9, 
   3.546718464194426*^9}, {3.54671850104169*^9, 3.5467186180886946`*^9}, {
   3.5467189218456354`*^9, 3.546718948209681*^9}, {3.54671898774015*^9, 
   3.546718994120561*^9}, 3.546719122851986*^9, {3.5467191625540547`*^9, 
   3.546719187872899*^9}, {3.5467192416929927`*^9, 3.5467192832826653`*^9}, {
   3.54671944087414*^9, 3.5467194623553777`*^9}, {3.546719499889043*^9, 
   3.5467195278442917`*^9}, {3.546719569527564*^9, 3.5467195993080163`*^9}, {
   3.546719645640097*^9, 3.546719646576099*^9}, {3.5467265003597727`*^9, 
   3.5467265009681735`*^9}, {3.5467272079614067`*^9, 3.546727241033464*^9}, {
   3.546746580453994*^9, 3.546746584525601*^9}, {3.5467466517617183`*^9, 
   3.5467466526665196`*^9}, {3.5467467305574555`*^9, 
   3.5467468631576867`*^9}, {3.546748188348797*^9, 3.546748307907406*^9}, {
   3.546748596055508*^9, 3.546748618254347*^9}, {3.546748667113632*^9, 
   3.546748790821848*^9}, {3.546748956665737*^9, 3.5467489569777374`*^9}, {
   3.546749029486664*^9, 3.5467490710607367`*^9}, 3.546749109374403*^9, {
   3.5467492353446226`*^9, 3.546749277683097*^9}, {3.5467493292567863`*^9, 
   3.5467493635456467`*^9}, 3.5467494045893183`*^9, {3.5469017948723984`*^9, 
   3.54690183602527*^9}, {3.5469029930900865`*^9, 3.546903103585079*^9}, {
   3.5469031401603427`*^9, 3.546903218044478*^9}, {3.546903258276948*^9, 
   3.546903310412239*^9}, {3.5469033619267282`*^9, 3.546903448643679*^9}, {
   3.54690406283235*^9, 3.546904086279191*^9}, {3.546904656818986*^9, 
   3.546904658051388*^9}, {3.546904780308801*^9, 3.546904798092832*^9}, {
   3.5469048322100916`*^9, 3.546904833005693*^9}, {3.5469051842091055`*^9, 
   3.546905184583506*^9}, {3.5469100778678455`*^9, 3.5469100788194466`*^9}, {
   3.5469128270686393`*^9, 3.546912830516245*^9}, {3.546912975596498*^9, 
   3.5469129789505043`*^9}, {3.594262106703995*^9, 3.594262157886067*^9}, {
   3.6630427551104207`*^9, 3.6630428678205767`*^9}, {3.6630429239306536`*^9, 
   3.66304297204072*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"th0", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
    RowBox[{"arctand", "[", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", "a"}], "/", "b"}]], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    StyleBox[
     RowBox[{
     "special", " ", "case", " ", "for", " ", "\[Lambda]1", " ", "\[Lambda]2",
       " ", "\[Lambda]3"}],
     FontColor->RGBColor[1, 0, 0]], " ", "=", " ", "0"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OrangeSlice", "[", 
    RowBox[{"\[Theta]1_", ",", "\[Theta]2_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xyztp", "[", "#", "]"}], "&"}], ",", 
     RowBox[{"BasicPolys", "[", 
      RowBox[{
       RowBox[{"myRange", "[", 
        RowBox[{"\[Theta]1", ",", "\[Theta]2", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Range", "[", "60", "]"}], ",", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"\[Theta]2", "-", "\[Theta]1"}], "#"], "\[LessEqual]", 
              "5"}], "&"}]}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"0.", ",", "180", ",", "5"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5468879733987107`*^9, 3.5468879797167215`*^9}, {
   3.5468880191067905`*^9, 3.5468880208227935`*^9}, {3.5468880638632684`*^9, 
   3.546888108619746*^9}, 3.546888235042367*^9, {3.595020797718475*^9, 
   3.595020803378483*^9}, {3.5964784272294965`*^9, 3.5964784311295013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolyListForBB", "=", 
    RowBox[{"BasicPolys", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0.", ",", "360", ",", "5"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0.", ",", "90", ",", "10"}], "]"}]}], "]"}]}], ";"}], 
  "  "}]], "Input",
 CellChangeTimes->{{3.610057147541768*^9, 3.6100571481033688`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PolyListForBB", "=", 
    RowBox[{"BasicPolys", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0.", ",", "360", ",", "5"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0.", ",", "90", ",", "5"}], "]"}]}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], ")"}], " ", "polys", " ", 
       "for", " ", "hemisphere"}], ";"}], " ", "take", " ", "larger", " ", 
     "increments", " ", "if", " ", "desired"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyListRough", "=", 
    RowBox[{"BasicPolys", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"0.", ",", "360", ",", "15"}], "]"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0.", ",", "90", ",", "15"}], "]"}]}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SubdividePolyList", "[", 
     RowBox[{"PolyListForBB_", ",", "\[CapitalLambda]_"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"SubdivideForLambda", "[", 
         RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "&"}], "/@", 
       "PolyListForBB"}], ",", "1"}], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Theta]", ",", " ", "\[Phi]"}], ")"}], " ", "polys", " ", 
     "for", " ", "hemisphere", " ", "after", " ", "the", " ", "subdivision"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.557852552130735*^9, 3.557852566014759*^9}, 
   3.594571037594542*^9, 3.5945710906946154`*^9, {3.594756114979149*^9, 
   3.5947561278611684`*^9}, 3.595017403455211*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeEllipsoid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "\[CapitalLambda]_"}],
     "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"\[CapitalLambda]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"\[CapitalLambda]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"\[CapitalLambda]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "x"}], ",", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "y"}], ",", 
      RowBox[{
       RowBox[{"\[CapitalLambda]", "[", 
        RowBox[{"[", "3", "]"}], "]"}], " ", "z"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SignsSame", "[", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_"}], "}"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Lambda]1", "\[GreaterEqual]", "0"}], "&&", 
       RowBox[{"\[Lambda]2", "\[GreaterEqual]", "0"}], "&&", 
       RowBox[{"\[Lambda]3", "\[GreaterEqual]", "0"}]}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Lambda]1", "<=", "0"}], "&&", 
       RowBox[{"\[Lambda]2", "<=", "0"}], "&&", 
       RowBox[{"\[Lambda]3", "<=", "0"}]}], ")"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"all", " ", "white", " ", "or", " ", "all", " ", "red"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5578481080048532`*^9, 3.5578481982510104`*^9}, {
  3.5578482344274735`*^9, 3.5578483245176306`*^9}, {3.557848373408116*^9, 
  3.5578483979469585`*^9}, {3.559264869593705*^9, 3.559264913663782*^9}, {
  3.560873706245572*^9, 3.5608737070723743`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolyListForBeachball0", "[", "\[CapitalLambda]_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"SignsSame", "[", "\[CapitalLambda]", "]"}], ",", " ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"all", " ", "white", " ", "or", " ", "all", " ", "red"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       StyleBox["False",
        FontColor->RGBColor[1, 0, 0]], ",", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MakeEllipsoid", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "<=", 
                  RowBox[{
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "id", ",", 
                 RowBox[{"yrot", "[", "90", "]"}]}], "]"}], ".", "zref", ".", 
               RowBox[{"xyztp", "[", "#", "]"}]}], ",", "\[CapitalLambda]"}], 
             "]"}], "&"}], ",", "PolyListRough", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", "     ", 
         "\[IndentingNewLine]", "        ", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"MakeEllipsoid", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "<=", 
                  RowBox[{
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                   RowBox[{"\[CapitalLambda]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "id", ",", 
                 RowBox[{"yrot", "[", "90", "]"}]}], "]"}], ".", 
               RowBox[{"xyztp", "[", "#", "]"}]}], ",", "\[CapitalLambda]"}], 
             "]"}], "&"}], ",", " ", "PolyListRough", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"SpherePolyList", "[", 
        RowBox[{
        "1", ",", "0", ",", "360", ",", "0", ",", "180", ",", "5", ",", "5"}],
         "]"}]}], "]"}], ",", "  ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{
       "MAKES", " ", "BALLS", " ", "INSTEAD", " ", "OF", " ", "ELLIPSOIDS"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalLambda]", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"\[CapitalLambda]", "[", 
          RowBox[{"[", "2", "]"}], "]"}], 
         RowBox[{"\[CapitalLambda]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "\[Equal]", "0"}], ",", " ", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{
         "at", " ", "least", " ", "one", " ", "eigenvalue", " ", "is", " ", 
          "zero"}],
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"OrangeSlice", "[", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"th0", "[", "\[CapitalLambda]", "]"}]}], ",", 
           RowBox[{"th0", "[", "\[CapitalLambda]", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "        ", 
         RowBox[{"OrangeSlice", "[", "  ", 
          RowBox[{
           RowBox[{"th0", "[", "\[CapitalLambda]", "]"}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"th0", "[", "\[CapitalLambda]", "]"}]}], "+", "180"}]}], 
          "]"}], ",", " ", "\[IndentingNewLine]", "       ", 
         RowBox[{"OrangeSlice", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"th0", "[", "\[CapitalLambda]", "]"}]}], "+", "180"}], 
           ",", "  ", 
           RowBox[{
            RowBox[{"th0", "[", "\[CapitalLambda]", "]"}], "+", "180"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "      ", 
         RowBox[{"OrangeSlice", "[", "   ", 
          RowBox[{
           RowBox[{
            RowBox[{"th0", "[", "\[CapitalLambda]", "]"}], "+", "180"}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"th0", "[", "\[CapitalLambda]", "]"}]}], "+", "360"}]}], 
          "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "Join", "[", "                                                  ", 
        RowBox[{"(*", " ", 
         StyleBox[
          RowBox[{"the", " ", "usual", " ", "case"}],
          FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
        "                                                                     \
                          ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"zref", ".", 
             RowBox[{"xyztp", "[", "#", "]"}]}], "&"}], ",", 
           RowBox[{"SubdividePolyList", "[", 
            RowBox[{"PolyListForBB", ",", "\[CapitalLambda]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Map", "[", "            ", 
          RowBox[{"xyztp", ",", "           ", 
           RowBox[{"SubdividePolyList", "[", 
            RowBox[{"PolyListForBB", ",", "\[CapitalLambda]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.546711068553733*^9, 3.5467111497986746`*^9}, {
   3.5467113126785583`*^9, 3.5467113671538534`*^9}, {3.546711501688488*^9, 
   3.5467115030300903`*^9}, {3.546712650817692*^9, 3.5467126550452986`*^9}, {
   3.5467168401379943`*^9, 3.546716848624409*^9}, {3.546718858618725*^9, 
   3.546718859679527*^9}, {3.5467309625759525`*^9, 3.546730973963973*^9}, 
   3.5467314632120256`*^9, {3.546747924427537*^9, 3.5467479421023684`*^9}, {
   3.546747990259652*^9, 3.546747995251661*^9}, {3.546749501075486*^9, 
   3.546749502682289*^9}, {3.546751188462444*^9, 3.546751192752451*^9}, {
   3.546876518207506*^9, 3.5468765226067133`*^9}, {3.5468796971452627`*^9, 
   3.546879698642865*^9}, {3.5468808394572544`*^9, 3.5468808456816654`*^9}, {
   3.5468809156009874`*^9, 3.546880920577396*^9}, {3.5468825290026007`*^9, 
   3.5468825488458347`*^9}, {3.5468825794374886`*^9, 3.546882591543109*^9}, {
   3.5468826354947863`*^9, 3.546882661110031*^9}, {3.546885445710704*^9, 
   3.546885452527916*^9}, {3.54688597695403*^9, 3.5468860466861515`*^9}, {
   3.5468882984252777`*^9, 3.5468883077540936`*^9}, {3.5468883402177505`*^9, 
   3.5468883516681705`*^9}, {3.5469071324513006`*^9, 
   3.5469072592015214`*^9}, {3.5469073479656763`*^9, 
   3.5469074903003244`*^9}, {3.546907521032378*^9, 3.546907733651949*^9}, {
   3.54690776873641*^9, 3.5469078023388686`*^9}, {3.5469079003070393`*^9, 
   3.5469079130054617`*^9}, 3.5469091651258535`*^9, {3.546909326492535*^9, 
   3.5469093351973505`*^9}, {3.5469093681446075`*^9, 3.546909368409808*^9}, {
   3.5469095704457607`*^9, 3.546909584657385*^9}, {3.546910131875139*^9, 
   3.546910141406756*^9}, {3.546912656673542*^9, 3.546912661915151*^9}, {
   3.5578484325010185`*^9, 3.557848475978295*^9}, {3.5578485742272663`*^9, 
   3.5578485843360834`*^9}, {3.557848972792361*^9, 3.5578489794535723`*^9}, {
   3.557852578525981*^9, 3.557852585358793*^9}, {3.5579401999682016`*^9, 
   3.55794020478861*^9}, {3.5579402587329044`*^9, 3.557940270713725*^9}, {
   3.557940882151494*^9, 3.5579408836334963`*^9}, {3.594571055624567*^9, 
   3.5945710595845723`*^9}, {3.5964782816202917`*^9, 
   3.5964782954203105`*^9}, {3.6901663923912125`*^9, 
   3.6901664126659813`*^9}, {3.690166551060262*^9, 3.690166614266732*^9}, {
   3.690316661471572*^9, 3.6903166737507353`*^9}}],

Cell[TextData[{
 "PolyListForBeachball0 was only for \[Lambda]1 >= 0, \[Lambda]2 >= 0, \
\[Lambda]3 <= 0 OR \[Lambda]1 <= 0, \[Lambda]2 <= 0, \[Lambda]3 >= 0  (or for \
all \[Lambda]s the sam",
 StyleBox["e ",
  FontFamily->"Times New Roman"],
 "sign).  PolyListForBeachball removes the restriction.\nNOTE \
PolyListForBeachball[\[CapitalLambda]] IS REMEMBERED.  MAY HAVE TO CLEAR \
PERIODICALLY."
}], "Text",
 CellChangeTimes->{{3.546881206073494*^9, 3.546881210238701*^9}, {
   3.546881578570943*^9, 3.5468816322818365`*^9}, 3.546912884336339*^9, {
   3.5469130664042563`*^9, 3.5469130777922764`*^9}, {3.6002802264488363`*^9, 
   3.6002802576688795`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PolyListForBeachball", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CycleMat", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", ">", "0"}], "&&", 
        RowBox[{"c", ">", "0"}], "&&", 
        RowBox[{"b", "<", "0"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "<", "0"}], "&&", 
        RowBox[{"c", "<", "0"}], "&&", 
        RowBox[{"b", ">", "0"}]}], ")"}], "||", 
      RowBox[{"b", "\[Equal]", "0"}]}], ",", "rot111", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", ">", "0"}], "&&", 
          RowBox[{"c", ">", "0"}], "&&", 
          RowBox[{"a", "<", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", "<", "0"}], "&&", 
          RowBox[{"c", "<", "0"}], "&&", 
          RowBox[{"a", ">", "0"}]}], ")"}], "||", 
        RowBox[{"a", "\[Equal]", "0"}]}], ",", 
       RowBox[{"rot111", ".", "rot111"}], ",", "id"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolyListForBeachball", "[", "\[CapitalLambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"PolyListForBeachball", "[", "\[CapitalLambda]", "]"}], "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"CycleMat", "[", "\[CapitalLambda]", "]"}], "]"}], ".", " ", 
        "#"}], "&"}], ",", 
      RowBox[{"PolyListForBeachball0", "[", 
       RowBox[{
        RowBox[{"CycleMat", "[", "\[CapitalLambda]", "]"}], ".", 
        "\[CapitalLambda]"}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.546731505425699*^9, {3.546731547779773*^9, 3.5467315596825943`*^9}, {
   3.5467461709688797`*^9, 3.546746210312148*^9}, {3.5468810551588306`*^9, 
   3.5468810569684334`*^9}, {3.5468811523002*^9, 3.5468811813786507`*^9}, {
   3.5468883843814273`*^9, 3.5468883904966383`*^9}, {3.600280149738731*^9, 
   3.6002801697087584`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Beachball", "[", 
   RowBox[{"\[CapitalLambda]", ",", "u", ",", "c", ",", "BBrad"}], "]"}], "  ",
   "is", " ", "for", " ", "the", " ", "moment", " ", 
  RowBox[{
   SubscriptBox[
    RowBox[{"tensor", " ", "[", "\[CapitalLambda]", "]"}], "U"], ".", "  ", 
   "BBrad"}], " ", "and", " ", "c", " ", "are", " ", "the", " ", "radius", 
  " ", "and", " ", "center", " ", "of", " ", "the", " ", 
  RowBox[{"ball", "."}]}]], "Text",
 CellChangeTimes->{{3.546881666960697*^9, 3.54688173730122*^9}, {
  3.546881789514511*^9, 3.5468817899513116`*^9}, {3.5468846792813673`*^9, 
  3.5468846904197865`*^9}, {3.546884878836915*^9, 3.5468849135781755`*^9}},
 FontFamily->"Times New Roman",
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BeachBall", "[", 
     RowBox[{"\[CapitalLambda]_", ",", "u_", ",", "c_", ",", "BBrad_"}], 
     "]"}], ":=", "                                           ", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"HueBeach", "[", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "-", "c"}], ")"}], "&"}], "/@", "#"}], "]"}], ",", 
          RowBox[{"u", ".", 
           RowBox[{"DiagonalMatrix", "[", "\[CapitalLambda]", "]"}], ".", 
           RowBox[{"Transpose", "[", "u", "]"}]}]}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SignsSame", "[", "\[CapitalLambda]", "]"}], "&&", 
           RowBox[{
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", 
            RowBox[{"\[CapitalLambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Thickness", "[", 
            RowBox[{".01", "tkns"}], "]"}], "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}]}], "]"}], ",", 
        RowBox[{"Polygon", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "+", 
         RowBox[{"BBrad", "*", 
          RowBox[{"u", ".", "#"}]}]}], "&"}], ",", 
       RowBox[{"PolyListForBeachball", "[", "\[CapitalLambda]", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}], "    "}]], "Input",
 CellChangeTimes->{{3.5469125436045446`*^9, 3.546912561575776*^9}, {
   3.546915617028412*^9, 3.546915617106412*^9}, {3.5469156740933113`*^9, 
   3.546915694638547*^9}, {3.557848724736328*^9, 3.557848725219929*^9}, {
   3.557849017049638*^9, 3.5578490692317295`*^9}, {3.5578494703751493`*^9, 
   3.5578494785495634`*^9}, 3.557849745044828*^9, {3.5596641608453712`*^9, 
   3.5596642357099023`*^9}, {3.5942597189466734`*^9, 3.5942597216966767`*^9}, 
   3.594262051383919*^9, {3.5948682147723646`*^9, 3.594868216622367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BeachBall", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "u_", ",", "c_", ",", "BBrad_"}], "]"}],
    ":=", "          ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"This", " ", "version", " ", "has", " ", 
      RowBox[{"EdgeForm", "[", "]"}], " ", "everywhere", " ", "Previous", " ",
       "has", " ", "poly", " ", "boundaries", " ", "when", " ", "all", " ", 
      "red", " ", "or", " ", "all", " ", "white"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   "                                 ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"HueBeach", "[", 
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "-", "c"}], ")"}], "&"}], "/@", "#"}], "]"}], ",", 
         RowBox[{"u", ".", 
          RowBox[{"DiagonalMatrix", "[", "\[CapitalLambda]", "]"}], ".", 
          RowBox[{"Transpose", "[", "u", "]"}]}]}], "]"}], ",", 
       RowBox[{"EdgeForm", "[", "]"}], ",", 
       RowBox[{"Polygon", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"c", "+", 
        RowBox[{"BBrad", "*", 
         RowBox[{"u", ".", "#"}]}]}], "&"}], ",", 
      RowBox[{"PolyListForBeachball", "[", "\[CapitalLambda]", "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6903168380457344`*^9, 3.6903169559270625`*^9}}],

Cell[BoxData[
 RowBox[{"Test", " ", 
  RowBox[{"example", ".", "  ", "Also"}], " ", "see", " ", 
  RowBox[{"BeachballForM", "."}]}]], "Text",
 CellChangeTimes->{{3.546881666960697*^9, 3.54688173730122*^9}, {
  3.546881789514511*^9, 3.5468817899513116`*^9}, {3.5468846792813673`*^9, 
  3.5468846904197865`*^9}, {3.546884878836915*^9, 3.5468849135781755`*^9}, {
  3.594503147580575*^9, 3.5945031521205816`*^9}, {3.5945894987669315`*^9, 
  3.5945895012669353`*^9}, {3.594868226872381*^9, 3.594868238632397*^9}},
 FontFamily->"Times New Roman",
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"WantExamples", "==", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalLambda]", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "19", ",", 
       RowBox[{"-", "20"}]}], "}"}]}], ";", 
    RowBox[{"u", "=", 
     RowBox[{
      RowBox[{"xrot", "[", "20", "]"}], ".", 
      RowBox[{"yrot", "[", "10", "]"}]}]}], ";", 
    RowBox[{"u", "=", "id"}], ";", 
    RowBox[{"eye", "=", 
     RowBox[{"10", 
      RowBox[{"xyztp", "[", 
       RowBox[{"{", 
        RowBox[{"35", ",", "70"}], "}"}], "]"}]}]}], ";", 
    RowBox[{"c", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
    RowBox[{"BBrad", "=", "1"}], ";", " ", 
    RowBox[{"tkns", "=", ".006"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"BeachBall", "[", 
       RowBox[{"\[CapitalLambda]", ",", "u", ",", "c", ",", "BBrad"}], "]"}], 
      ",", 
      RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
      RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.54674739262261*^9, 3.5467474555843196`*^9}, {
   3.546747489670379*^9, 3.5467474928059845`*^9}, {3.546747595204563*^9, 
   3.546747680115511*^9}, {3.5467477303943987`*^9, 3.5467477874436984`*^9}, {
   3.546749587452837*^9, 3.546749611523679*^9}, {3.546750355956977*^9, 
   3.546750360605785*^9}, {3.546751230847118*^9, 3.546751233218322*^9}, {
   3.5467520384430313`*^9, 3.5467520533435574`*^9}, {3.5468748239565516`*^9, 
   3.5468748266241565`*^9}, {3.546875127595481*^9, 3.546875160776739*^9}, {
   3.5468751958768005`*^9, 3.5468751963760014`*^9}, {3.5468819079343176`*^9, 
   3.546881911257123*^9}, {3.546881941271576*^9, 3.546881977869239*^9}, {
   3.5468828201523085`*^9, 3.5468828203707085`*^9}, {3.5468849456050315`*^9, 
   3.5468849741062813`*^9}, {3.546912390478277*^9, 3.5469124053607035`*^9}, 
   3.5469124934660573`*^9, 3.5469151993638725`*^9, 3.5469156234400225`*^9, 
   3.546964329241476*^9, 3.575683900754984*^9, {3.5756840574186583`*^9, 
   3.575684071396283*^9}, {3.5920787426770315`*^9, 3.5920787704170694`*^9}, {
   3.594259503154374*^9, 3.594259511424385*^9}, {3.5942596392645617`*^9, 
   3.59425964491457*^9}, {3.594261177246703*^9, 3.594261180126707*^9}, {
   3.594262020591875*^9, 3.5942620429119062`*^9}, 3.5942622089561377`*^9, {
   3.5944819860373063`*^9, 3.594481994399319*^9}, {3.594482150757042*^9, 
   3.594482152497044*^9}, {3.5945031015865097`*^9, 3.5945031194665337`*^9}, {
   3.5945894616568804`*^9, 3.5945894730668964`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Gives the option of drawing a cube instead of a beachball. The last argument \
is the number of colors, with zero giving a true beachball.\
\>", "Subsection",
 CellChangeTimes->{{3.5703881525392885`*^9, 3.570388195526849*^9}, {
  3.5944992286781054`*^9, 3.594499250098135*^9}, {3.5944993684602995`*^9, 
  3.5944993738103065`*^9}, {3.5945009818775616`*^9, 3.594500991587575*^9}, {
  3.594502675607917*^9, 3.5945027028079543`*^9}, {3.5945036201842403`*^9, 
  3.5945036288042517`*^9}, {3.6036463521753683`*^9, 3.603646398705433*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 1]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeachBall", "[", 
    RowBox[{
    "\[CapitalLambda]dum_", ",", "u_", ",", "c_", ",", "s_", ",", "3"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".01", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"xrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}], ",", "   ", 
       RowBox[{"(*", " ", 
        StyleBox[
         RowBox[{"three", " ", "colored", " ", "cube"}],
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       "                                                                      \
                                                                              \
   ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"xrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "s"}], ",", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     "                                                                        \
                                                        ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".6", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"yrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "  ", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       "                                                                      \
                                                                              \
   ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"yrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"-", "s"}], ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     "                                                                        \
                                                              ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".15", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"zrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "  ", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       "                                                                      \
                                                                              \
   ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"zrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "s", ",", 
              RowBox[{"-", "s"}]}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BeachBall", "[", 
    RowBox[{
    "\[CapitalLambda]dum_", ",", "u_", ",", "c_", ",", "s_", ",", "6"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".01", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"xrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], ",", 
     "   ", 
     RowBox[{"(*", " ", 
      StyleBox[
       RowBox[{"six", " ", "colored", " ", "cube"}],
       FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
     "                                                                        \
                                                  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".07", "]"}], ",", "  ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"xrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "s"}], ",", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     "                                                                        \
                                                        ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".6", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"yrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "  ", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     "                                                                        \
                                                          ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".8", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"yrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"-", "s"}], ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     "                                                                        \
                                                              ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".15", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"zrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "  ", "s", ",", "s"}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     "                                                                        \
                                                               ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", ".40", "]"}], ",", " ", 
       RowBox[{"Polygon", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"c", "+", 
           RowBox[{"u", ".", 
            RowBox[{"zrot", "[", "#", "]"}], ".", 
            RowBox[{"{", 
             RowBox[{"s", ",", "s", ",", 
              RowBox[{"-", "s"}]}], "}"}]}]}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BeachBall", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "u_", ",", "c_", ",", "s_", ",", "0"}], 
   "]"}], ":=", 
  RowBox[{"BeachBall", "[", 
   RowBox[{"\[CapitalLambda]", ",", "u", ",", "c", ",", "s"}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"a", " ", "true", " ", "beachball"}], ",", " ", 
     RowBox[{"not", " ", "a", " ", "cube"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.504987886486206*^9, 3.5049879919063516`*^9}, {
   3.5049880288264027`*^9, 3.5049881340265474`*^9}, {3.5049881926066284`*^9, 
   3.5049883480768433`*^9}, {3.5052357545282483`*^9, 3.505235767647871*^9}, {
   3.5057523176223125`*^9, 3.5057523284323273`*^9}, {3.505752510162578*^9, 
   3.5057525168325872`*^9}, {3.547070432527461*^9, 3.547070433432263*^9}, {
   3.547070473243532*^9, 3.5470704763011374`*^9}, {3.54707057520531*^9, 
   3.5470706000561533`*^9}, {3.547070727227575*^9, 3.5470707312835817`*^9}, {
   3.5886237596814814`*^9, 3.588623762251485*^9}, {3.603646192793147*^9, 
   3.603646196183152*^9}, {3.6036462890932803`*^9, 3.603646297603292*^9}, 
   3.6036464106074505`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
New beachball code.  Eventually move the previous stuff elsewhere.  No, keep \
it. This new code makes the graphics files too big.\
\>", "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}, {
  3.6960437050283365`*^9, 3.6960437261920023`*^9}, {3.7005144459533033`*^9, 
  3.700514497617272*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"CharFnBeachball", "[", 
     RowBox[{"v_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", ".", "v"}], ")"}], ".", "v"}], ">", "0"}], ",", "1", 
      ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BeachballForM", "[", 
     RowBox[{"M_", ",", 
      RowBox[{"{", 
       RowBox[{"xc_", ",", "yc_", ",", "zc_"}], "}"}], ",", "BBrad_"}], "]"}],
     ":=", 
    RowBox[{"SliceContourPlot3D", "[", 
     RowBox[{
      RowBox[{"CharFnBeachball", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "-", "xc"}], ",", 
          RowBox[{"y", "-", "yc"}], ",", 
          RowBox[{"z", "-", "zc"}]}], "}"}], ",", "M"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "xc"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", "yc"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "-", "zc"}], ")"}], "2"]}], "\[Equal]", 
       SuperscriptBox["BBrad", "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"xc", "-", "BBrad"}], ",", 
        RowBox[{"xc", "+", "BBrad"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"yc", "-", "BBrad"}], ",", 
        RowBox[{"yc", "+", "BBrad"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"zc", "-", "BBrad"}], ",", 
        RowBox[{"zc", "+", "BBrad"}]}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], ",", 
      RowBox[{"ContourShading", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GrayLevel", "[", ".85", "]"}], ",", "Red"}], "}"}]}]}], 
     "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BeachBall", "[", 
     RowBox[{"\[CapitalLambda]_", ",", "u_", ",", "c_", ",", "BBrad_"}], 
     "]"}], ":=", " ", 
    RowBox[{"BeachballForM", "[", 
     RowBox[{
      RowBox[{"u", ".", 
       RowBox[{"DiagonalMatrix", "[", "\[CapitalLambda]", "]"}], ".", 
       RowBox[{"Transpose", "[", "u", "]"}]}], ",", "c", ",", "BBrad"}], 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.695657628900133*^9, 3.695657653090883*^9}, {
  3.695657684943284*^9, 3.6956577341129513`*^9}, {3.6960410048021994`*^9, 
  3.6960410063004875`*^9}, {3.6960410485095654`*^9, 3.6960410496394205`*^9}, {
  3.696043739088909*^9, 3.696043753014617*^9}, {3.700514512659127*^9, 
  3.7005145196345234`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lune (for Ford), with options.", "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Lune", "[", 
   RowBox[{
   "\[CapitalLambda]list_", ",", "ExtraPts_", ",", "eye_", ",", 
    "Want\[CapitalLambda]axes_", ",", "WantUVWaxes_", ",", "WantGrid_", ",", 
    "WantZeroLam1Lam3_", ",", "WantDeviatoricArc_", ",", "WantLuneBoundary_", 
    ",", "\[Nu]List_"}], "]"}], ":=", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"True", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GrayLevel", "[", ".7", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"Polygon", "/@", 
           RowBox[{"SpherePolyList", "[", 
            RowBox[{
            "1", ",", "30", ",", "330", ",", "0", ",", "180", ",", "5", ",", 
             "5"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "        ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"opaque", " ", "sphere"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"True", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Hue", "[", 
           RowBox[{".1", ",", "1", ",", 
            StyleBox[".7",
             FontColor->RGBColor[1, 0, 0]]}], "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"Polygon", "/@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"MapEyeward", "[", 
               RowBox[{"#", ",", 
                RowBox[{"-", ".015"}], ",", "eye"}], "]"}], "&"}], ",", 
             RowBox[{"SpherePolyList", "[", 
              RowBox[{"1", ",", 
               RowBox[{"-", "30"}], ",", "30", ",", "0", ",", "180", ",", "5",
                ",", "5"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "    ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"opaque", " ", "lune"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"WantUVWaxes", ",", 
        RowBox[{"Paxes", "[", 
         RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.3", ",", "1", 
          ",", "ArrowScale", ",", "tkns", ",", "False"}], "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "       ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"uvw", " ", "axes"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"Want\[CapitalLambda]axes", ",", "    ", 
        RowBox[{"Paxes", "[", 
         RowBox[{"True", ",", "True", ",", "True", ",", "uG", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "1.3", ",", "1", 
          ",", "ArrowScale", ",", "tkns", ",", "True"}], "]"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "            ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"\[CapitalLambda]", " ", "axes"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"WantGrid", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Hue", "[", ".10", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"xyztp", "[", 
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", ",", "\[Beta]"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Gamma]", ",", 
                 RowBox[{"-", "30"}], ",", "30", ",", "2."}], "}"}]}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]", ",", "10", ",", "170", ",", "10."}], "}"}]}], 
           "]"}], ",", "       ", 
          RowBox[{"(*", " ", 
           StyleBox[
            RowBox[{
             RowBox[{"lunar", " ", "lat"}], "-", 
             RowBox[{"long", " ", "grid"}]}],
            FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]",
           "                                        ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"xyztp", "[", 
                RowBox[{"{", 
                 RowBox[{"\[Gamma]", ",", "\[Beta]"}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Beta]", ",", "10", ",", "170", ",", "2."}], 
                "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Gamma]", ",", 
              RowBox[{"-", "30"}], ",", "30", ",", "10."}], "}"}]}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"WantZeroLam1Lam3", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Hue", "[", ".01", "]"}], ",", 
            RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
            RowBox[{"Line", "[", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"uG", ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], ",", 
               RowBox[{"uG", ".", 
                RowBox[{"unit", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "0"}], "}"}], "]"}]}]}], "]"}], 
             "]"}]}], "}"}], ",", "       ", 
          RowBox[{"(*", " ", 
           StyleBox[
            RowBox[{
            "zero", " ", "contour", " ", "for", " ", "\[Lambda]1", " ", "and",
              " ", "\[Lambda]3"}],
            FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]",
           "                                     ", 
          RowBox[{"{", 
           RowBox[{"White", ",", "  ", 
            RowBox[{"Thickness", "[", "tkns", "]"}], ",", "    ", 
            RowBox[{"Line", "[", 
             RowBox[{"arc", "[", 
              RowBox[{
               RowBox[{"uG", ".", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], ",", 
               RowBox[{"uG", ".", 
                RowBox[{"unit", "[", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "}"}], "]"}]}]}], "]"}], "]"}]}], 
           "}"}]}], " ", "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"WantDeviatoricArc", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Hue", "[", ".80", "]"}], ",", 
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"arc", "[", 
            RowBox[{
             RowBox[{"uG", ".", 
              RowBox[{"unit", "[", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}]}], ",", 
             RowBox[{"uG", ".", 
              RowBox[{"unit", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1", ",", 
                 RowBox[{"-", "2"}]}], "}"}], "]"}]}]}], "]"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "       ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"deviatoric", " ", "arc"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"WantLuneBoundary", ",", "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Hue", "[", ".10", "]"}], ",", 
          RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xyztp", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "30"}], ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0.", ",", "180", ",", "3"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          "                                                                   \
                                ", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xyztp", "[", 
              RowBox[{"{", "  ", 
               RowBox[{"30", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0.", ",", "180", ",", "3"}], "]"}]}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "       ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"lune", " ", "boundary", " ", "curves"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Hue", "[", ".55", "]"}], ",", 
        RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"uG", ".", "#"}], "&"}], ",", 
           RowBox[{"NuContour", "/@", "\[Nu]List"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], "}"}], ",", "       ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"\[Nu]", " ", "=", " ", 
         RowBox[{"constant", " ", "curves"}]}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      "                                   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Hue", "[", ".15", "]"}], ",", 
        RowBox[{"PointSize", "[", "ptsz", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"MapEyeward", "[", 
            RowBox[{
             RowBox[{"uG", ".", 
              RowBox[{"unit", "[", "#", "]"}]}], ",", ".03", ",", "eye"}], 
            "]"}], "]"}], "&"}], "/@", "\[CapitalLambda]list"}]}], "}"}], ",",
       "      ", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"the", " ", "eigenvalue", " ", "triples"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", "                      ", 
       RowBox[{
        RowBox[{"PointSize", "[", ".02", "]"}], ",", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"MapEyeward", "[", 
            RowBox[{
             RowBox[{"uG", ".", 
              RowBox[{"unit", "[", "#", "]"}]}], ",", ".02", ",", "eye"}], 
            "]"}], "]"}], "&"}], "/@", "ExtraPts"}]}], " ", "}"}]}], 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
    RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
    RowBox[{"Boxed", "->", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5677121804655223`*^9, 3.5677122573268566`*^9}, {
   3.5677123967130995`*^9, 3.567712644878332*^9}, {3.567712688293208*^9, 
   3.5677127378856945`*^9}, {3.5677128682083216`*^9, 
   3.5677129256164217`*^9}, {3.5677129892645326`*^9, 3.567713007703765*^9}, {
   3.567713046922233*^9, 3.5677130562198496`*^9}, {3.567713299049873*^9, 
   3.567713299517874*^9}, {3.567720544952149*^9, 3.5677205668882875`*^9}, 
   3.5677980179584956`*^9, {3.5677980762395973`*^9, 3.5677980797677035`*^9}, 
   3.5677982021169176`*^9, {3.5677983010304904`*^9, 3.5677983023564925`*^9}, 
   3.5926845072389603`*^9, {3.592684539479005*^9, 3.5926846504091578`*^9}, {
   3.592684683889204*^9, 3.5926847066992354`*^9}, {3.5926847565893044`*^9, 
   3.59268480357137*^9}, {3.5926848359214153`*^9, 3.592684946343569*^9}, 
   3.592685060335727*^9, 3.5926851022777863`*^9, {3.592685183307898*^9, 
   3.592685210249936*^9}, {3.592685283602039*^9, 3.592685341882119*^9}, {
   3.592685508452349*^9, 3.5926855096023507`*^9}, {3.59268555877442*^9, 
   3.5926855669044313`*^9}, {3.5926855999644766`*^9, 3.592685627894515*^9}, {
   3.592685740904671*^9, 3.59268580451676*^9}, {3.59268589760889*^9, 
   3.5926858984088907`*^9}, {3.5926859350789413`*^9, 
   3.5926859646289825`*^9}, {3.5926860391190853`*^9, 
   3.5926862829634247`*^9}, {3.592686320763477*^9, 3.592686335403497*^9}, {
   3.5926863666255417`*^9, 3.5926864609776726`*^9}, 3.5926864923877163`*^9, {
   3.592686522507758*^9, 3.5926866381019197`*^9}, 3.5926866952819986`*^9, {
   3.5926867274820433`*^9, 3.592686750322075*^9}, {3.592686804776152*^9, 
   3.592686974068387*^9}, {3.5926870311004667`*^9, 3.5926872088827133`*^9}, {
   3.5926873329328847`*^9, 3.5926873490429068`*^9}, {3.5926874450650406`*^9, 
   3.5926874931651073`*^9}, {3.5926875500951853`*^9, 
   3.5926875901772423`*^9}, {3.5926876223072863`*^9, 3.592687624057289*^9}, {
   3.5926877766274996`*^9, 3.5926878245995665`*^9}, 3.5926886968197803`*^9, {
   3.592688908682074*^9, 3.592688909362075*^9}, {3.592688947772128*^9, 
   3.5926889487921295`*^9}, {3.592689041424258*^9, 3.5926890422342596`*^9}, {
   3.5927065839312325`*^9, 3.5927066991298957`*^9}, {3.5927067394199514`*^9, 
   3.5927067495924654`*^9}, 3.592707484733987*^9, {3.5927075169840317`*^9, 
   3.5927075170940323`*^9}, {3.5927075752441125`*^9, 
   3.5927075958541408`*^9}, {3.592707715196307*^9, 3.592707721126315*^9}, {
   3.5927078055589323`*^9, 3.5927078189589505`*^9}, {3.5927078680510197`*^9, 
   3.5927078736210275`*^9}, 3.592709412742171*^9, {3.5927615773461347`*^9, 
   3.592761799678443*^9}, {3.592761838140997*^9, 3.592761906243591*^9}, {
   3.5927620022202263`*^9, 3.5927620163402452`*^9}, {3.5927621101778755`*^9, 
   3.592762154722438*^9}, {3.5927622163770247`*^9, 3.592762338906197*^9}, {
   3.59276265722814*^9, 3.5927627706007967`*^9}, {3.592762872363437*^9, 
   3.592762925132513*^9}, {3.592763012727634*^9, 3.5927630598276987`*^9}, 
   3.592763249511964*^9, {3.5927637912592216`*^9, 3.5927638503263044`*^9}, {
   3.592763899586373*^9, 3.592763974650978*^9}, {3.5927640224650464`*^9, 
   3.5927640320200596`*^9}, {3.592764123844688*^9, 3.592764137764707*^9}, {
   3.594503365111887*^9, 3.5945033813019094`*^9}, {3.594587487719565*^9, 
   3.594587490299568*^9}, {3.5945875216396112`*^9, 3.594587522759613*^9}, {
   3.594587598682218*^9, 3.59458759988222*^9}, {3.5945876586918025`*^9, 
   3.5945876860683427`*^9}, {3.594587738868416*^9, 3.594587740740918*^9}, 
   3.684343536764926*^9, {3.7108852251370516`*^9, 3.7108852536370606`*^9}}],

Cell[BoxData[
 RowBox[{"Test", " ", 
  RowBox[{"example", ":"}]}]], "Text",
 CellChangeTimes->{{3.546881666960697*^9, 3.54688173730122*^9}, {
  3.546881789514511*^9, 3.5468817899513116`*^9}, {3.5468846792813673`*^9, 
  3.5468846904197865`*^9}, {3.546884878836915*^9, 3.5468849135781755`*^9}, {
  3.594503147580575*^9, 3.5945031521205816`*^9}, {3.5945895086169453`*^9, 
  3.594589509876947*^9}},
 FontFamily->"Times New Roman",
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"WantExamples", "==", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eye", "=", 
     RowBox[{"10.", 
      RowBox[{"xyztp", "[", 
       RowBox[{"{", 
        RowBox[{"20", ",", "70"}], "}"}], "]"}]}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
       RowBox[{"20", " ", "is", " ", "azimuth", " ", "of", " ", "eye"}], ",", 
       " ", 
       RowBox[{"70", " ", "is", " ", "colatitude", " ", "of", " ", "eye"}]}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[CapitalLambda]list", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1", ",", 
         RowBox[{"-", "3"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], " ", "}"}]}], ";", " ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
       RowBox[{
        RowBox[{"your", " ", "eigenvalue", " ", "triples"}], ";", " ", 
        RowBox[{"you", " ", 
         RowBox[{"specify", ".", " ", "You"}], " ", "can", " ", "read", " ", 
         "them", " ", "in", " ", "from", " ", "a", " ", "data", " ", 
         RowBox[{"file", ".", " ", "They"}], " ", "do", " ", "not", " ", 
         "have", " ", "to", " ", "be", " ", "normalized"}]}], ",", " ", 
       RowBox[{
       "but", " ", "they", " ", "have", " ", "to", " ", "be", " ", "ordered", 
        " ", "if", " ", "you", " ", "want", " ", "them", " ", "on", " ", 
        "the", " ", "lune"}]}],
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[
      RowBox[{
       StyleBox["*",
        FontColor->RGBColor[1, 0, 0]], ")"}]]}], "\[IndentingNewLine]", 
    RowBox[{"ExtraPts", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
       RowBox[{"other", " ", "points"}], ",", " ", 
       RowBox[{
        RowBox[{"in", " ", "\[CapitalLambda]", " ", "coordinates"}], ";", " ", 
        RowBox[{"you", " ", 
         RowBox[{"specify", ".", " ", "They"}], " ", "do", " ", "not", " ", 
         "have", " ", "to", " ", "be", " ", 
         RowBox[{"normalized", "."}]}]}]}],
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[
      RowBox[{
       StyleBox["*",
        FontColor->RGBColor[1, 0, 0]], ")"}]]}], "\[IndentingNewLine]", 
    RowBox[{"WantUVWaxes", "=", "False"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Want\[CapitalLambda]axes", "=", "False"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WantGrid", "=", "False"}], ";", "\[IndentingNewLine]", 
    RowBox[{"WantZeroLam1Lam3", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"WantDeviatoricArc", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"WantLuneBoundary", "=", "True"}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Nu]List", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], ";", "   ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
       RowBox[{"specifies", " ", "the", " ", "Poisson", " ", "contours"}], 
       ";", " ", 
       RowBox[{
        RowBox[{"make", " ", "\[Nu]List"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"(", ")"}], " ", "if", " ", "you", " ", "do", " ", "not", 
         " ", "want", " ", 
         RowBox[{"any", "."}]}]}]}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"tkns", "=", ".006"}], ";", 
    RowBox[{"ptsz", "=", ".02"}], ";", 
    RowBox[{"ArrowScale", "=", ".055"}], ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
      "ptsz", " ", "is", " ", "point", " ", "size", " ", "for", " ", "the", 
       " ", "eigenvalue", " ", "triples"}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Lune", "[", 
     RowBox[{
     "\[CapitalLambda]list", ",", "ExtraPts", ",", "eye", ",", 
      "Want\[CapitalLambda]axes", ",", "WantUVWaxes", ",", "WantGrid", ",", 
      "WantZeroLam1Lam3", ",", "WantDeviatoricArc", ",", "WantLuneBoundary", 
      ",", "\[Nu]List"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.592687640827312*^9, 3.5926877062774024`*^9}, {
   3.5926879330997167`*^9, 3.592687939259725*^9}, {3.592688055429886*^9, 
   3.5926880555798855`*^9}, {3.5926880881199303`*^9, 
   3.5926880882599306`*^9}, {3.5926882609491715`*^9, 
   3.5926882826492014`*^9}, {3.5927068103145504`*^9, 3.592706833564583*^9}, {
   3.592706884124653*^9, 3.592706909516689*^9}, {3.5927069510217466`*^9, 
   3.592706959431758*^9}, {3.5927074491939383`*^9, 3.5927074525339427`*^9}, {
   3.5927081032758465`*^9, 3.5927081325483866`*^9}, {3.5927094177721777`*^9, 
   3.592709447692219*^9}, {3.592709509412304*^9, 3.592709525342326*^9}, {
   3.5927615570861063`*^9, 3.59276155975611*^9}, {3.5927618118009605`*^9, 
   3.592761817800969*^9}, {3.592762323749674*^9, 3.5927623291796813`*^9}, {
   3.592762941292535*^9, 3.592762953305052*^9}, {3.5927632724144955`*^9, 
   3.592763374106637*^9}, {3.5927634163086967`*^9, 3.5927634236087065`*^9}, {
   3.592763478506283*^9, 3.5927635372988644`*^9}, {3.592763614502475*^9, 
   3.5927636539100294`*^9}, 3.592763703615098*^9, {3.5927637629191823`*^9, 
   3.592763773709197*^9}, {3.5927640659501066`*^9, 3.592764095092647*^9}, {
   3.5945874862695627`*^9, 3.5945875197196093`*^9}, {3.594587596382215*^9, 
   3.5945875974322166`*^9}, {3.5945876561317987`*^9, 3.594587687198344*^9}, {
   3.5945877354784107`*^9, 3.594587736818413*^9}, {3.5945893464567213`*^9, 
   3.5945893606667414`*^9}, {3.595018681319003*^9, 3.5950186937790203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeachballOnSphereForLamU", "[", 
   RowBox[{
   "\[CapitalLambda]_", ",", "u_", ",", "BBrad_", ",", "SpokeLength_", ",", 
    "eye_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"BeachBall", "[", 
     RowBox[{"\[CapitalLambda]", ",", "u", ",", 
      RowBox[{"SpokeLength", "*", 
       RowBox[{"uG", ".", 
        RowBox[{"unit", "[", "\[CapitalLambda]", "]"}]}]}], ",", "BBrad"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thickness", "[", 
       RowBox[{".8", "tkns"}], "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"uG", ".", "#"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"unit", "[", "\[CapitalLambda]", "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SpokeLength", "-", "BBrad"}], ")"}], 
           RowBox[{"unit", "[", "\[CapitalLambda]", "]"}]}]}], "}"}]}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PointSize", "[", "ptsz", "]"}], ",", 
      RowBox[{"Point", "[", 
       RowBox[{"MapEyeward", "[", 
        RowBox[{
         RowBox[{"uG", ".", 
          RowBox[{"unit", "[", "\[CapitalLambda]", "]"}]}], ",", ".02", ",", 
         "eye"}], "]"}], "]"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.594229152634428*^9, 3.5942293572712135`*^9}, 
   3.5942293962237673`*^9, {3.5942314076615825`*^9, 3.594231408891584*^9}, 
   3.5942314577416515`*^9, {3.594231545423774*^9, 3.5942315688658075`*^9}, {
   3.594231702345991*^9, 3.59423188698225*^9}, {3.594257687047845*^9, 
   3.5942577090778756`*^9}, {3.594258916623558*^9, 3.5942589174035597`*^9}, {
   3.5950159274351444`*^9, 3.595015933135152*^9}, {3.5950159632951937`*^9, 
   3.5950159841352224`*^9}, {3.5950161992935247`*^9, 3.595016206103534*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Some TapeTape2012beach.  Watch out for \[Phi] versus h.  See \
BeachballArticleChecks for lots of checks.\
\>", "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}, {
  3.6927438364130945`*^9, 3.6927438784288416`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Kappa]", ",", "\[Phi]", ",", "\[Sigma]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"WVproduct", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"-", "\[Kappa]"}], "/", "2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"-", "\[Kappa]"}], "/", "2"}], "]"}]}], "}"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]", "/", "2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "/", "2"}], "]"}], ",", "0", ",", "0"}], 
          "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Sigma]", "/", "2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Sigma]", "/", "2"}], "]"}]}], "}"}]}], "}"}]}], "]"}], 
     "]"}], "]"}], "]"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "from", " ", "Eq", " ", "B1", " ", "of", " ", 
      RowBox[{"TapeTape2012beach", ".", " ", "The"}], " ", "result", " ", 
      "explains", " ", "the", " ", "definition", " ", 
      "V\[Kappa]\[Sigma]\[Phi]"}], ",", " ", "next", ",", " ", 
     RowBox[{
     "which", " ", "is", " ", "the", " ", "same", " ", "as", " ", "in", " ", 
      "Prop", " ", "2", " ", "of", " ", 
      RowBox[{"TapeTape2012beach", ".", " ", "BUT"}], " ", "NOTE", " ", "IN", 
      " ", "TERMS", " ", "OF", " ", "\[Phi]"}], ",", " ", 
     RowBox[{
      RowBox[{"NOT", " ", "h", 
       RowBox[{
        RowBox[{
         StyleBox[".",
          FontColor->RGBColor[1, 0, 0]], " ", "Basis"}], " ", "should", " ", 
        "be", " ", "north"}]}], "-", "west", "-", 
      RowBox[{"up", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.5931936303523417`*^9, 3.593193747262504*^9}, {
   3.593193813258599*^9, 3.5931938635506697`*^9}, {3.5931939143732395`*^9, 
   3.5931939155832415`*^9}, {3.5945168978557334`*^9, 3.594516921375766*^9}, {
   3.5945169775658436`*^9, 3.5945170282079144`*^9}, 3.594916284587453*^9, {
   3.596332365812251*^9, 3.5963323724622602`*^9}, 3.6924981301442027`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Kappa]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
     {
      RowBox[{
       RowBox[{"Sin", "[", "\[Sigma]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.591837170040862*^9, 3.593187658000834*^9, 
  3.5931876918826942`*^9, 3.593188243451214*^9, 3.59319340176152*^9, 
  3.5931934362915673`*^9, 3.5947429662390213`*^9, 3.594745917608799*^9, 
  3.59501823735038*^9, 3.595020436503953*^9, 3.595036901595127*^9, 
  3.5963914899522257`*^9, 3.5964901073572493`*^9, 3.5966909654483223`*^9, 
  3.6100570926920724`*^9, 3.6313012978771534`*^9, 3.642958296326807*^9, 
  3.6452289592290344`*^9, 3.6459801489525003`*^9, 3.646488552135372*^9, 
  3.648087334430607*^9, 3.6529377655360355`*^9, 3.6571675069272523`*^9, 
  3.6713843683301644`*^9, 3.671810884647145*^9, 3.6788241789942102`*^9, 
  3.6856487307953205`*^9, 3.69083350038291*^9, 3.6954834774090276`*^9, 
  3.697993079781658*^9, 3.698767787664835*^9, 3.698792306489816*^9, 
  3.711123996516104*^9, 3.7111287254849157`*^9, 3.7112866261465883`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
    RowBox[{"{", 
     RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
       {
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], " ", 
          RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Kappa]", "]"}]}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]},
       {
        RowBox[{
         RowBox[{"Sin", "[", "\[Sigma]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
        RowBox[{
         RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
        RowBox[{"Cos", "[", "\[Phi]", "]"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"U\[Kappa]\[Sigma]\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Inputs", " ", "in", " ", "radians"}], ";", " ", 
     RowBox[{
      RowBox[{"basis", " ", "should", " ", "be", " ", "north"}], "-", "west", 
      "-", "up"}], ";", " ", 
     RowBox[{"Eq", " ", 
      RowBox[{"(", "26", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2012beach", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K\[Kappa]", "[", "\[Kappa]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ROT", "[", 
     RowBox[{
      RowBox[{"-", "\[Kappa]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "                     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Strike", " ", "vector", " ", "from", " ", "\[Kappa]"}], ";", 
     " ", 
     RowBox[{
      RowBox[{"coords", " ", "are", " ", "wrt", " ", "north"}], "-", "west", 
      "-", 
      RowBox[{"up", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N\[Kappa]\[Phi]", "[", 
    RowBox[{"\[Kappa]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], "                ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "Normal", " ", "vector", " ", "from", " ", "\[Kappa]", " ", "and", " ", 
      "\[Phi]"}], ";", " ", 
     RowBox[{
      RowBox[{"coords", " ", "are", " ", "wrt", " ", "north"}], "-", "west", 
      "-", 
      RowBox[{"up", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S\[Kappa]\[Sigma]\[Phi]", "[", 
    RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], ".", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Slip", " ", "vector", " ", "from", " ", "\[Kappa]"}], ",", " ", 
     "\[Sigma]", ",", " ", 
     RowBox[{"\[Phi]", ";", " ", 
      RowBox[{
       RowBox[{"coords", " ", "are", " ", "wrt", " ", "north"}], "-", "west", 
       "-", 
       RowBox[{"up", "."}]}]}]}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DC\[Kappa]\[Sigma]\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{"LamSubU", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"U\[Kappa]\[Sigma]\[Phi]", "[", 
       RowBox[{"{", 
        RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}]}], 
     "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"new", " ", "August", " ", "2017"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.591837219910931*^9, 3.591837303551047*^9}, 
   3.591837372821142*^9, {3.5918374136111984`*^9, 3.5918374145811996`*^9}, {
   3.5918414457328067`*^9, 3.5918414638328314`*^9}, {3.591841539824938*^9, 
   3.5918415498449516`*^9}, {3.592967620773458*^9, 3.592967631363473*^9}, 
   3.5929677599661503`*^9, {3.592967979886461*^9, 3.5929679841264668`*^9}, {
   3.592968129871169*^9, 3.592968158303709*^9}, {3.592968255686343*^9, 
   3.5929682795988765`*^9}, {3.5945168165536203`*^9, 3.594516875005702*^9}, {
   3.594517076117981*^9, 3.5945170813979883`*^9}, {3.5949162868674564`*^9, 
   3.594916288597459*^9}, 3.594916551136824*^9, {3.594925932058935*^9, 
   3.594925941278948*^9}, {3.5949295418269944`*^9, 3.594929577069045*^9}, {
   3.595642600593803*^9, 3.5956427979680777`*^9}, {3.595643060702443*^9, 
   3.595643061412444*^9}, {3.710897870956524*^9, 3.710897898236086*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ".", 
     StyleBox[
      RowBox[{"XRot", "[", "\[Pi]", "]"}],
      FontColor->RGBColor[1, 0, 0]]}], 
    StyleBox[
     RowBox[{
      StyleBox["=",
       FontColor->RGBColor[1, 0, 0]], "="}]], 
    RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]", "+", "\[Pi]"}], ",", 
       RowBox[{"\[Pi]", "-", "\[Sigma]"}], ",", 
       RowBox[{"\[Pi]", "-", "\[Phi]"}]}], "}"}], "]"}]}], "]"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox["SAVE",
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ".", 
     StyleBox[
      RowBox[{"YRot", "[", "\[Pi]", "]"}],
      FontColor->RGBColor[1, 0, 0]]}], 
    StyleBox[
     RowBox[{
      StyleBox["=",
       FontColor->RGBColor[1, 0, 0]], "="}]], 
    RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]", "+", "\[Pi]"}], ",", 
       RowBox[{"-", "\[Sigma]"}], ",", 
       RowBox[{"\[Pi]", "-", "\[Phi]"}]}], "}"}], "]"}]}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox["SAVE",
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ".", 
     StyleBox[
      RowBox[{"ZRot", "[", "\[Pi]", "]"}],
      FontColor->RGBColor[1, 0, 0]]}], 
    StyleBox[
     RowBox[{
      StyleBox["=",
       FontColor->RGBColor[1, 0, 0]], "="}]], 
    RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]", ",", 
       RowBox[{"\[Pi]", "+", "\[Sigma]"}], ",", "\[Phi]"}], "}"}], "]"}]}], 
   "]"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox["SAVE",
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6743100425419884`*^9, 3.6743100945264845`*^9}, {
   3.674311393966526*^9, 3.6743114059821606`*^9}, {3.6743114377009325`*^9, 
   3.6743114450291257`*^9}, {3.674316215846019*^9, 3.6743162479085693`*^9}, {
   3.6743162816586037`*^9, 3.6743162847211533`*^9}, 3.6743163205961714`*^9, {
   3.674316350783739*^9, 3.6743163681588163`*^9}, {3.6743167650970497`*^9, 
   3.6743167660814652`*^9}, {3.674316889425455*^9, 3.6743169246598544`*^9}, {
   3.674323675447798*^9, 3.6743236836978135`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6743236900884075`*^9, 3.6788241790452585`*^9, 
  3.6856487308421936`*^9, 3.690833500420698*^9, 3.695483477455864*^9, 
  3.6979930799026527`*^9, 3.69876778771185*^9, 3.69879230653681*^9, 
  3.7111239967021112`*^9, 3.711128725530918*^9, 3.711286626228169*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6743236900884075`*^9, 3.6788241790452585`*^9, 
  3.6856487308421936`*^9, 3.690833500420698*^9, 3.695483477455864*^9, 
  3.6979930799026527`*^9, 3.69876778771185*^9, 3.69879230653681*^9, 
  3.7111239967021112`*^9, 3.711128725530918*^9, 3.711286626229143*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6743236900884075`*^9, 3.6788241790452585`*^9, 
  3.6856487308421936`*^9, 3.690833500420698*^9, 3.695483477455864*^9, 
  3.6979930799026527`*^9, 3.69876778771185*^9, 3.69879230653681*^9, 
  3.7111239967021112`*^9, 3.711128725530918*^9, 3.71128662622993*^9}]
}, Open  ]],

Cell[TextData[{
 "This is the version for \[Kappa] \[Sigma] ",
 StyleBox["h",
  FontSlant->"Italic"],
 " coordinates,",
 StyleBox[" h",
  FontSlant->"Italic"],
 " = cos \[Phi]."
}], "Text",
 CellChangeTimes->{{3.509941979449625*^9, 3.5099420014396553`*^9}, {
   3.509942059099735*^9, 3.509942066029744*^9}, {3.5099907263006573`*^9, 
   3.5099907541706963`*^9}, {3.5949576641581774`*^9, 3.594957772778328*^9}, {
   3.595283040481172*^9, 3.595283044241177*^9}, {3.5952831077912645`*^9, 
   3.595283182011367*^9}, 3.5952833862576528`*^9, {3.595300109674762*^9, 
   3.595300110344763*^9}, {3.5955362108468776`*^9, 3.5955362195368896`*^9}, {
   3.5955372451863174`*^9, 3.5955372610083404`*^9}, {3.5956431457245617`*^9, 
   3.595643157354578*^9}, {3.596312051214464*^9, 3.5963120582944736`*^9}, {
   3.6334910659739738`*^9, 3.633491102184024*^9}, {3.674323710432236*^9, 
   3.674323713416622*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"V\[Kappa]\[Sigma]h", "[", 
    RowBox[{"{", 
     RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "h_"}], "}"}], "]"}], ":=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], "+", 
         RowBox[{"h", " ", 
          RowBox[{"Sin", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{"h", " ", 
          RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["h", "2"]}]]}], " ", 
         RowBox[{"Sin", "[", "\[Kappa]", "]"}]}]},
       {
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], " ", 
          RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], "+", 
         RowBox[{"h", " ", 
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{"h", " ", 
          RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Kappa]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], 
        RowBox[{
         RowBox[{"-", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["h", "2"]}]]}], " ", 
         RowBox[{"Cos", "[", "\[Kappa]", "]"}]}]},
       {
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["h", "2"]}]], " ", 
         RowBox[{"Sin", "[", "\[Sigma]", "]"}]}], 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["h", "2"]}]], " ", 
         RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], "h"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}]], "Input"],

Cell["\<\
This cell gives the strike vector, normal vector, and slip vector in whatever \
coordinates you want. Just give the zenith vector and north vector in your \
coordinates.  (It is not used.)\
\>", "Text",
 CellChangeTimes->{{3.509941979449625*^9, 3.5099420014396553`*^9}, {
   3.509942059099735*^9, 3.509942066029744*^9}, {3.5099907263006573`*^9, 
   3.5099907541706963`*^9}, {3.5949576641581774`*^9, 3.594957772778328*^9}, {
   3.595283040481172*^9, 3.595283044241177*^9}, {3.5952831077912645`*^9, 
   3.595283182011367*^9}, 3.5952833862576528`*^9, {3.595300109674762*^9, 
   3.595300110344763*^9}, {3.5955362108468776`*^9, 3.5955362195368896`*^9}, {
   3.5955372451863174`*^9, 3.5955372610083404`*^9}, {3.5956431457245617`*^9, 
   3.595643157354578*^9}, {3.596312051214464*^9, 3.5963120582944736`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"K\[Kappa]", "[", 
     RowBox[{"\[Kappa]_", ",", "Zen_", ",", "North_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ROT", "[", 
      RowBox[{
       RowBox[{"-", "\[Kappa]"}], ",", "Zen"}], "]"}], ".", "North"}]}], 
   ";"}], "          ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Strike", " ", "vector", " ", "from", " ", "strike", " ", "angle", " ", 
     "\[Kappa]"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"N\[Kappa]\[Phi]", "[", 
     RowBox[{"\[Kappa]_", ",", "\[Phi]_", ",", "Zen_", ",", "North_"}], "]"}],
     ":=", 
    RowBox[{
     RowBox[{"ROT", "[", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"K\[Kappa]", "[", 
        RowBox[{"\[Kappa]", ",", "Zen", ",", "North"}], "]"}]}], "]"}], ".", 
     "Zen"}]}], ";"}], "       ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Normal", " ", "vector", " ", "from", " ", "\[Kappa]", " ", "and", " ", 
     "\[Phi]"}],
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S\[Kappa]\[Sigma]\[Phi]", "[", 
   RowBox[{
   "\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_", ",", "Zen_", ",", 
    "North_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ROT", "[", 
    RowBox[{"\[Sigma]", ",", 
     RowBox[{"N\[Kappa]\[Phi]", "[", 
      RowBox[{"\[Kappa]", ",", "\[Phi]", ",", "Zen", ",", "North"}], "]"}]}], 
    "]"}], ".", 
   RowBox[{"K\[Kappa]", "[", "\[Kappa]", "]"}], "     ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"Slip", " ", "vector", " ", "from", " ", "\[Kappa]"}], ",", " ",
       "\[Sigma]", ",", " ", "\[Phi]"}],
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.595263552895418*^9, 3.595263596317479*^9}, {
   3.5952636647775736`*^9, 3.5952636871676044`*^9}, {3.5952637295676627`*^9, 
   3.5952637639277105`*^9}, {3.595263830377802*^9, 3.5952639272599373`*^9}, 
   3.595264740773067*^9, 3.5952667170448413`*^9, {3.595281420421392*^9, 
   3.595281438531417*^9}, {3.5952815397715645`*^9, 3.595281633981694*^9}, {
   3.595281703753792*^9, 3.5952818061559343`*^9}, {3.5952829165489984`*^9, 
   3.5952829172489996`*^9}, {3.595283226325431*^9, 3.59528333347758*^9}, {
   3.5953025120641165`*^9, 3.595302548604167*^9}, {3.5963385385901093`*^9, 
   3.5963385606001396`*^9}, {3.5963386464422593`*^9, 
   3.5963386474822607`*^9}, {3.596338681092307*^9, 3.596338699354334*^9}, {
   3.596388831762493*^9, 3.5963888381025014`*^9}, 3.596388877542556*^9}],

Cell[TextData[{
 "Next cell: Strike-rake-dip (\[Kappa], \[Sigma], \[Phi]) from the moment \
tensor.  M is the ",
 StyleBox["matrix representation",
  FontSlant->"Italic"],
 " of the moment tensor with respect to a certain basis B. Zen and North are ",
 StyleBox["coordinates",
  FontSlant->"Italic"],
 " of the zenith and north vectors with respect to that ",
 StyleBox["same basis",
  FontSlant->"Italic"],
 " B. Then SofM, NofM, and KofM  are the coordinates of the slip, normal, and \
strike vectors with respect to that same basis B, and they depend on B. But \
the strike, rake, and dip angles do not depend on B; use any right-handed \
orthonormal basis for B, so long as it is the same for M, Zen, and North. i = \
1, 2, 3, 4. The fault planes and slips are NOT those of the classical model \
unless M happens to be a double couple.\n     Warning: For randomly oriented \
moment tensors M, the vectors NofM[M, i, Zen], for fixed i, are ",
 StyleBox["not",
  FontSlant->"Italic"],
 " uniform on the sphere. Angles in radians."
}], "Text",
 CellChangeTimes->{{3.595365960336661*^9, 3.59536604660678*^9}, 
   3.595366107516864*^9, {3.595366156668933*^9, 3.5953661865589743`*^9}, {
   3.595366237169044*^9, 3.5953663713852367`*^9}, 3.5963181934785123`*^9, 
   3.5963182884906445`*^9, 3.596318383690776*^9, {3.5963310660813704`*^9, 
   3.5963310969339128`*^9}, {3.596338885426592*^9, 3.5963389158766336`*^9}, {
   3.596338955296688*^9, 3.5963389713767104`*^9}, 3.5963392079990377`*^9, 
   3.5963392992431664`*^9, 3.5963393538432417`*^9, {3.5963862394999285`*^9, 
   3.5963862458499365`*^9}, {3.596386284779492*^9, 3.596386373452114*^9}, {
   3.5963864253946867`*^9, 3.596386438508707*^9}, {3.596386541623351*^9, 
   3.596386600445932*^9}, {3.5963869098073645`*^9, 3.596386942487409*^9}, {
   3.5963888470325136`*^9, 3.596388859672531*^9}, {3.6143079103424454`*^9, 
   3.614308070114667*^9}, {3.680720278020338*^9, 3.680720287986923*^9}, {
   3.6934295782347407`*^9, 3.693429584803479*^9}},
 FontSize->16,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsInBrick", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"0", "\[LessEqual]", "\[Kappa]", "\[LessEqual]", 
      RowBox[{"2", "\[Pi]"}]}], " ", "&&", " ", 
     RowBox[{
      RowBox[{"Abs", "[", "\[Sigma]", "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], " ", "&&", " ", 
     RowBox[{"0", "\[LessEqual]", "\[Phi]", "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}]}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"the", " ", "\[Phi]", " ", "brick"}], ",", " ", 
     RowBox[{
      RowBox[{"not", " ", "the", " ", "h"}], "-", "brick"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NofM", "[", 
     RowBox[{"M_", ",", "i_", ",", "Zen_"}], "]"}], ":=", 
    RowBox[{"Unit", "[", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"P1", "[", "M", "]"}], "+", 
           RowBox[{"P3", "[", "M", "]"}]}], ",", 
          RowBox[{
           RowBox[{"P1", "[", "M", "]"}], "-", 
           RowBox[{"P3", "[", "M", "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"P1", "[", "M", "]"}]}], "+", 
           RowBox[{"P3", "[", "M", "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"P1", "[", "M", "]"}]}], "-", 
           RowBox[{"P3", "[", "M", "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Angle", "[", 
           RowBox[{"#1", ",", "Zen"}], "]"}], "<=", 
          RowBox[{"Angle", "[", 
           RowBox[{"#2", ",", "Zen"}], "]"}]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"fault", " ", "normals"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SofM", "[", 
     RowBox[{"M_", ",", "i_", ",", "Zen_"}], "]"}], ":=", 
    RowBox[{"Unit", "[", 
     RowBox[{
      RowBox[{"DCforM", "[", "M", "]"}], ".", 
      RowBox[{"NofM", "[", 
       RowBox[{"M", ",", "i", ",", "Zen"}], "]"}]}], "]"}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"slip", " ", "vector"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KofM", "[", 
     RowBox[{"M_", ",", "i_", ",", "Zen_"}], "]"}], ":=", 
    RowBox[{"Cross", "[", 
     RowBox[{"Zen", ",", 
      RowBox[{"NofM", "[", 
       RowBox[{"M", ",", "i", ",", "Zen"}], "]"}]}], "]"}]}], ";"}], 
  "                           ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"strike", " ", "vector"}], ",", " ", 
     RowBox[{"not", " ", "a", " ", "unit", " ", "vector"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Kappa]ofM", "[", 
     RowBox[{"M_", ",", "i_", ",", "Zen_", ",", "North_"}], "]"}], ":=", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"SignedAngle", "[", 
        RowBox[{"North", ",", 
         RowBox[{"KofM", "[", 
          RowBox[{"M", ",", "i", ",", "Zen"}], "]"}], ",", "Zen"}], "]"}]}], 
      ",", 
      RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";"}], "             ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"undefined", " ", "if", " ", "NofM", " ", "is", " ", "vertical"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]ofM", "[", 
     RowBox[{"M_", ",", "i_", ",", "Zen_"}], "]"}], ":=", 
    RowBox[{"SignedAngle", "[", 
     RowBox[{
      RowBox[{"KofM", "[", 
       RowBox[{"M", ",", "i", ",", "Zen"}], "]"}], ",", 
      RowBox[{"SofM", "[", 
       RowBox[{"M", ",", "i", ",", "Zen"}], "]"}], ",", 
      RowBox[{"NofM", "[", 
       RowBox[{"M", ",", "i", ",", "Zen"}], "]"}]}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"undefined", " ", "if", " ", "NofM", " ", "is", " ", "vertical"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]ofM", "[", 
    RowBox[{"M_", ",", "i_", ",", "Zen_"}], "]"}], ":=", "    ", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"Zen", ".", 
     RowBox[{"NofM", "[", 
      RowBox[{"M", ",", "i", ",", "Zen"}], "]"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.595292566895501*^9, 3.595292594385539*^9}, {
   3.595292653427622*^9, 3.595292693087676*^9}, {3.595292770399784*^9, 
   3.595292771759786*^9}, {3.595297671770602*^9, 3.595297706572652*^9}, {
   3.5952977616627274`*^9, 3.595297767712736*^9}, 3.595297825602816*^9, {
   3.5952978565228586`*^9, 3.595297877722888*^9}, {3.595297912912936*^9, 
   3.5952979190729446`*^9}, {3.5952983721815786`*^9, 
   3.5952984224936495`*^9}, {3.5952995840420275`*^9, 3.595299584882029*^9}, {
   3.595365482847495*^9, 3.595365488477503*^9}, {3.5953655986021566`*^9, 
   3.5953656410922155`*^9}, 3.595365674917262*^9, {3.595365774681402*^9, 
   3.595365802781441*^9}, {3.5953662175390167`*^9, 3.5953662194390197`*^9}, {
   3.5953713364667015`*^9, 3.595371372101252*^9}, {3.5954536802815933`*^9, 
   3.595453681391595*^9}, {3.5954548870307755`*^9, 3.595454934865343*^9}, {
   3.5954550049174414`*^9, 3.595455015847456*^9}, {3.5954550482225013`*^9, 
   3.595455049152502*^9}, {3.596312998243782*^9, 3.5963130000737844`*^9}, {
   3.5963176810718007`*^9, 3.5963176918218155`*^9}, {3.5963181151984043`*^9, 
   3.5963181186684093`*^9}, 3.5963181984885197`*^9, {3.596318266720615*^9, 
   3.5963182962906556`*^9}, {3.5963183852707787`*^9, 
   3.5963183882507825`*^9}, {3.59631843730085*^9, 3.59631850224094*^9}, 
   3.596318645981138*^9, 3.5963187629233017`*^9, 3.5963188263933897`*^9, 
   3.596319033007677*^9, {3.5963191664738646`*^9, 3.596319210543926*^9}, {
   3.5963193063180604`*^9, 3.5963194072702007`*^9}, {3.5963194513502617`*^9, 
   3.596319506352339*^9}, 3.59631958594445*^9, 3.5963196610445538`*^9, 
   3.5963197325646524`*^9, 3.596329177825735*^9, {3.596330534133128*^9, 
   3.5963305369031324`*^9}, {3.5963310220813093`*^9, 
   3.5963310278113174`*^9}, {3.5963390937888803`*^9, 3.596339112248906*^9}, {
   3.596339196939023*^9, 3.5963392098490405`*^9}, {3.59633929494316*^9, 
   3.596339303793173*^9}, 3.596339354653243*^9, 3.596339459733388*^9, {
   3.596341933844827*^9, 3.5963419371248317`*^9}, {3.5963419776348877`*^9, 
   3.5963419840548964`*^9}, {3.596342026228957*^9, 3.596342039848976*^9}, {
   3.5963420995110598`*^9, 3.5963421292811003`*^9}, {3.5963436663672543`*^9, 
   3.5963436743472652`*^9}, 3.5963437183873262`*^9, {3.5963437791664133`*^9, 
   3.5963437862764235`*^9}, {3.596343818476468*^9, 3.5963438518265142`*^9}, {
   3.5963438890915656`*^9, 3.596343897094077*^9}, {3.596343934804129*^9, 
   3.5963440308037634`*^9}, {3.5963440636488085`*^9, 
   3.5963441030188627`*^9}, {3.596382148870384*^9, 3.596382245677519*^9}, {
   3.5963822810475683`*^9, 3.596382306477603*^9}, {3.5963823551521716`*^9, 
   3.596382356742174*^9}, {3.596382549908943*^9, 3.596382575588979*^9}, {
   3.596383441501186*^9, 3.596383516703291*^9}, {3.5963839250598593`*^9, 
   3.596383931709869*^9}, 3.596384043902524*^9, {3.596388861222533*^9, 
   3.596388874842552*^9}, {3.633536656500497*^9, 3.633536815252219*^9}, {
   3.6335369827999516`*^9, 3.633536990947462*^9}, {3.633537525607211*^9, 
   3.6335375265072126`*^9}, 3.6335384070269346`*^9, {3.633543819067408*^9, 
   3.6335438225374126`*^9}}],

Cell["Added February 2015.  They are still slow.", "Text",
 CellChangeTimes->{{3.509941979449625*^9, 3.5099420014396553`*^9}, {
   3.509942059099735*^9, 3.509942066029744*^9}, {3.5099907263006573`*^9, 
   3.5099907541706963`*^9}, {3.5949576641581774`*^9, 3.594957772778328*^9}, {
   3.595283040481172*^9, 3.595283044241177*^9}, {3.5952831077912645`*^9, 
   3.595283182011367*^9}, 3.5952833862576528`*^9, {3.595300109674762*^9, 
   3.595300110344763*^9}, {3.5955362108468776`*^9, 3.5955362195368896`*^9}, {
   3.5955372451863174`*^9, 3.5955372610083404`*^9}, {3.5956431457245617`*^9, 
   3.595643157354578*^9}, {3.596312051214464*^9, 3.5963120582944736`*^9}, {
   3.5963319841057205`*^9, 3.5963321107758956`*^9}, {3.596332462974386*^9, 
   3.5963325245244713`*^9}, {3.596332633646623*^9, 3.596332643766637*^9}, {
   3.5963868049102182`*^9, 3.596386815070232*^9}, {3.633543832627427*^9, 
   3.633543850197451*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]\[Sigma]\[Phi]InBrickofM", "[", 
    RowBox[{"M_", ",", "Zen_", ",", "North_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen", ",", "North"}], "]"}], ",", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], ",", 
       RowBox[{"\[Phi]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]ofM", "[", 
        RowBox[{"M", ",", "2", ",", "Zen", ",", "North"}], "]"}], ",", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "2", ",", "Zen"}], "]"}], ",", 
       RowBox[{"\[Phi]ofM", "[", 
        RowBox[{"M", ",", "2", ",", "Zen"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]\[Sigma]hInBrickofM", "[", 
    RowBox[{"M_", ",", "Zen_", ",", "North_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen", ",", "North"}], "]"}], ",", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]ofM", "[", 
         RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Kappa]ofM", "[", 
        RowBox[{"M", ",", "2", ",", "Zen", ",", "North"}], "]"}], ",", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "2", ",", "Zen"}], "]"}], ",", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]ofM", "[", 
         RowBox[{"M", ",", "2", ",", "Zen"}], "]"}], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Kappa]InBrickofM", "[", 
     RowBox[{"M_", ",", "Zen_", ",", "North_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"\[Sigma]ofM", "[", 
         RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], "]"}], "\[LessEqual]", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"\[Kappa]ofM", "[", 
       RowBox[{"M", ",", "1", ",", "Zen", ",", "North"}], "]"}], ",", 
      RowBox[{"\[Kappa]ofM", "[", 
       RowBox[{"M", ",", "2", ",", "Zen", ",", "North"}], "]"}]}], "]"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"yes", ",", " ", 
     RowBox[{"the", " ", "test", " ", "is", " ", "on", " ", "\[Sigma]"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]InBrickofM", "[", 
    RowBox[{"M_", ",", "Zen_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"\[Sigma]ofM", "[", 
      RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], ",", 
     RowBox[{"\[Sigma]ofM", "[", 
      RowBox[{"M", ",", "2", ",", "Zen"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]InBrickofM", "[", 
    RowBox[{"M_", ",", "Zen_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"\[Sigma]ofM", "[", 
        RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], "]"}], "\[LessEqual]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"\[Phi]ofM", "[", 
      RowBox[{"M", ",", "1", ",", "Zen"}], "]"}], ",", 
     RowBox[{"\[Phi]ofM", "[", 
      RowBox[{"M", ",", "2", ",", "Zen"}], "]"}]}], "]"}]}], ";", "        ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"yes", ",", " ", 
     RowBox[{"the", " ", "test", " ", "is", " ", "on", " ", "\[Sigma]"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.633542435795493*^9, 3.633542472055543*^9}, {
   3.6335425135856004`*^9, 3.633542559795664*^9}, {3.6335425947957125`*^9, 
   3.6335426480157857`*^9}, {3.6335426952058506`*^9, 3.633542722105888*^9}, {
   3.6335428458780603`*^9, 3.6335428534380703`*^9}, 3.633543746927308*^9, {
   3.6335437962873764`*^9, 3.6335438100273952`*^9}, {3.6335438614674664`*^9, 
   3.6335440352317085`*^9}, {3.6335441174618225`*^9, 3.6335441504218674`*^9}}],

Cell["\<\
These commands are equivalent to those in BeachballArticleChecks..\
\>", "Text",
 CellChangeTimes->{{3.509941979449625*^9, 3.5099420014396553`*^9}, {
   3.509942059099735*^9, 3.509942066029744*^9}, {3.5099907263006573`*^9, 
   3.5099907541706963`*^9}, {3.5949576641581774`*^9, 3.594957772778328*^9}, {
   3.595283040481172*^9, 3.595283044241177*^9}, {3.5952831077912645`*^9, 
   3.595283182011367*^9}, 3.5952833862576528`*^9, {3.595300109674762*^9, 
   3.595300110344763*^9}, {3.5955362108468776`*^9, 3.5955362195368896`*^9}, {
   3.5955372451863174`*^9, 3.5955372610083404`*^9}, {3.5956431457245617`*^9, 
   3.595643157354578*^9}, {3.596312051214464*^9, 3.5963120582944736`*^9}, {
   3.5963319841057205`*^9, 3.5963321107758956`*^9}, {3.596332462974386*^9, 
   3.5963325245244713`*^9}, {3.596332633646623*^9, 3.596332643766637*^9}, {
   3.5963868049102182`*^9, 3.596386815070232*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]forSignExplicit", "[", "\[Kappa]_", "]"}], ":=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"\[Kappa]", "+", "\[Pi]"}], ",", 
     RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]forSignExplicit", "[", "\[Sigma]_", "]"}], ":=", 
   RowBox[{"-", "\[Sigma]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]forSignExplicit", "[", "\[Phi]_", "]"}], ":=", 
   RowBox[{"\[Pi]", "-", "\[Phi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Kappa]forSwapExplicit", "[", 
    RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Theta", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Kappa]", "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "\[Kappa]", "]"}], " ", 
           RowBox[{"Cos", "[", "\[Sigma]", "]"}]}], "+", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Kappa]", "]"}], " ", 
           RowBox[{"Sin", "[", "\[Sigma]", "]"}]}]}], ",", "0"}], "}"}], 
       "]"}]}], ",", 
     RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]forSwapExplicit", "[", 
    RowBox[{"\[Sigma]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"sign", "[", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], "]"}], 
    RowBox[{"ArcCos", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"Cos", "[", "\[Sigma]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Sigma]", "]"}], "2"], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Sigma]", "]"}], "2"]}]}]]]}], "]"}]}]}], 
  "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"December", " ", "2013"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]forSwapExplicit", "[", 
    RowBox[{"\[Sigma]_", ",", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"ArcCos", "[", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Sigma]", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5956209171961117`*^9, 3.5956210516462975`*^9}, {
   3.5956211057103744`*^9, 3.5956211079603777`*^9}, {3.5956217975233374`*^9, 
   3.595621809833355*^9}, {3.5956218415433984`*^9, 3.595621887245463*^9}, {
   3.59564479065485*^9, 3.5956447930948534`*^9}, {3.5956454186717296`*^9, 
   3.5956454242817373`*^9}, {3.595648321865769*^9, 3.595648332075783*^9}, 
   3.595699755122466*^9, {3.5960704330369816`*^9, 3.5960704372969875`*^9}, {
   3.5960708939616203`*^9, 3.5960708957216225`*^9}, 3.596311274471377*^9, 
   3.596329655383403*^9, 3.5963297069129753`*^9, 3.5963297572205453`*^9, {
   3.596329902499748*^9, 3.5963299039497504`*^9}, {3.5963398730719633`*^9, 
   3.5963398730719633`*^9}, {3.5963399640340905`*^9, 
   3.5963399640440903`*^9}, {3.596340018044165*^9, 3.596340018054165*^9}, {
   3.5963410879916525`*^9, 3.596341090501656*^9}, {3.5963411509237404`*^9, 
   3.5963411531737432`*^9}, {3.5963412472278757`*^9, 3.596341249207879*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Do", "[", "                                                   ", 
  RowBox[{"(*", " ", 
   StyleBox["SAVE",
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Kappa]", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Phi]", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Pi]"}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
            RowBox[{"{", 
             RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ".", 
           RowBox[{"YRot", "[", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}], ".", 
           StyleBox[
            RowBox[{"XRot", "[", "\[Pi]", "]"}],
            FontColor->RGBColor[1, 0, 0]]}], "-", 
          RowBox[{
           RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Kappa]forSwapExplicit", "[", 
               RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}], 
              ",", 
              RowBox[{"\[Sigma]forSwapExplicit", "[", 
               RowBox[{"\[Sigma]", ",", "\[Phi]"}], "]"}], ",", 
              RowBox[{"\[Phi]forSwapExplicit", "[", 
               RowBox[{"\[Sigma]", ",", "\[Phi]"}], "]"}]}], "}"}], "]"}], 
           ".", 
           RowBox[{"YRot", "[", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], "]"}], "\[Equal]", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
            RowBox[{"{", 
             RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ".", 
           RowBox[{"YRot", "[", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}], ".", 
           StyleBox[
            RowBox[{"YRot", "[", "\[Pi]", "]"}],
            FontColor->RGBColor[1, 0, 0]]}], "-", 
          RowBox[{
           RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Kappa]forSignExplicit", "[", "\[Kappa]", "]"}], ",", 
              "            ", 
              RowBox[{"\[Sigma]forSignExplicit", "[", "\[Sigma]", "]"}], ",", 
              "      ", 
              RowBox[{"\[Phi]forSignExplicit", "[", "\[Phi]", "]"}]}], "}"}], 
            "]"}], ".", 
           RowBox[{"YRot", "[", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], "]"}], "==", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
            RowBox[{"{", 
             RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], 
            "]"}], ".", 
           RowBox[{"YRot", "[", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}], ".", 
           StyleBox[
            RowBox[{"ZRot", "[", "\[Pi]", "]"}],
            FontColor->RGBColor[1, 0, 0]]}], "-", 
          RowBox[{
           RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Kappa]forSwapExplicit", "[", 
               RowBox[{
                RowBox[{"\[Kappa]forSignExplicit", "[", "\[Kappa]", "]"}], 
                ",", 
                RowBox[{"\[Sigma]forSignExplicit", "[", "\[Sigma]", "]"}], 
                ",", 
                RowBox[{"\[Phi]forSignExplicit", "[", "\[Phi]", "]"}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"\[Sigma]forSwapExplicit", "[", 
               RowBox[{
                RowBox[{"\[Sigma]forSignExplicit", "[", "\[Sigma]", "]"}], 
                ",", 
                RowBox[{"\[Phi]forSignExplicit", "[", "\[Phi]", "]"}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"\[Phi]forSwapExplicit", "[", 
               RowBox[{
                RowBox[{"\[Sigma]forSignExplicit", "[", "\[Sigma]", "]"}], 
                ",", 
                RowBox[{"\[Phi]forSignExplicit", "[", "\[Phi]", "]"}]}], 
               "]"}]}], "}"}], "]"}], ".", 
           RowBox[{"YRot", "[", 
            RowBox[{
             RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], "]"}], "\[Equal]", 
        RowBox[{"DiagonalMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}]}], "}"}], "]"}]}],
    ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", 
  RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6743184606317167`*^9, 3.674318518340376*^9}, {
   3.6743185491309032`*^9, 3.6743185575715685`*^9}, {3.674318611827578*^9, 
   3.674318709625453*^9}, 3.6743187524202394`*^9, {3.6743187925499935`*^9, 
   3.674318850448045*^9}, {3.674318932954731*^9, 3.674318960167619*^9}, {
   3.674319005023653*^9, 3.6743190545997686`*^9}, {3.674319188478195*^9, 
   3.6743192120625963`*^9}, {3.674319259169447*^9, 3.674319259320053*^9}, {
   3.6743193032576575`*^9, 3.674319316941367*^9}, {3.6743193528883715`*^9, 
   3.6743193539668493`*^9}, {3.6743194281660967`*^9, 3.6743194389042554`*^9}, 
   3.674319576524615*^9, 3.674319618297654*^9, {3.6743196489798727`*^9, 
   3.6743196700102587`*^9}, {3.6743197218195744`*^9, 3.674319727981022*^9}, {
   3.6743197636794295`*^9, 3.6743197785205264`*^9}, 3.6743228565555162`*^9, {
   3.674323005196432*^9, 3.674323016274585*^9}, 3.67432310299354*^9, {
   3.6743231708842664`*^9, 3.6743231975249367`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True"}], "}"}]], "Print",
 CellChangeTimes->{3.6743231151497707`*^9, 3.674323372619038*^9, 
  3.678824179218274*^9, 3.6856487310140676`*^9, 3.6908335006005955`*^9, 
  3.6954834775782623`*^9, 3.6979930804106817`*^9, 3.698767787882864*^9, 
  3.6987923067178235`*^9, 3.711123996873111*^9, 3.7111287256649113`*^9, 
  3.711286626409648*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True"}], "}"}]], "Print",
 CellChangeTimes->{3.6743231151497707`*^9, 3.674323372619038*^9, 
  3.678824179218274*^9, 3.6856487310140676`*^9, 3.6908335006005955`*^9, 
  3.6954834775782623`*^9, 3.6979930804106817`*^9, 3.698767787882864*^9, 
  3.6987923067178235`*^9, 3.711123996873111*^9, 3.7111287256649113`*^9, 
  3.7112866264178257`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True"}], "}"}]], "Print",
 CellChangeTimes->{3.6743231151497707`*^9, 3.674323372619038*^9, 
  3.678824179218274*^9, 3.6856487310140676`*^9, 3.6908335006005955`*^9, 
  3.6954834775782623`*^9, 3.6979930804106817`*^9, 3.698767787882864*^9, 
  3.6987923067178235`*^9, 3.711123996873111*^9, 3.7111287256649113`*^9, 
  3.71128662641897*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Most of the Kagan stuff has not been moved into this AA file.\
\>", "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}, {
  3.6927438364130945`*^9, 3.692743921475749*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KaganOfXYZ", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"2", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"Max", "[", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"], "+", 
            SuperscriptBox["z", "2"]}], ")"}]}]], ",", 
        RowBox[{"Abs", "[", "x", "]"}], ",", 
        RowBox[{"Abs", "[", "y", "]"}], ",", 
        RowBox[{"Abs", "[", "z", "]"}]}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"sign", "[", "x", "]"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"], "-", 
           SuperscriptBox["y", "2"], "-", 
           SuperscriptBox["z", "2"]}]]}], ",", 
        RowBox[{"-", "z"}], ",", "y"}], "}"}]}]}], ";", "  ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
       RowBox[{"replaces", " ", "X180induced"}], ",", " ", 
       RowBox[{
        RowBox[{
        "March", " ", "2014.", " ", "Some", " ", "fine", " ", "print", " ", 
         "for", " ", "x"}], " ", "=", " ", "0"}]}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fy", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"sign", "[", "y", "]"}], 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"], "-", 
           SuperscriptBox["y", "2"], "-", 
           SuperscriptBox["z", "2"]}]]}], ",", 
        RowBox[{"-", "x"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fz", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"sign", "[", "z", "]"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "y"}], ",", "x", ",", 
        RowBox[{"-", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["x", "2"], "-", 
           SuperscriptBox["y", "2"], "-", 
           SuperscriptBox["z", "2"]}]]}]}], "}"}]}]}], ";"}], "*)"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"commented", " ", "out"}], ",", " ", 
     RowBox[{
     "since", " ", "conflicts", " ", "with", " ", "notation", " ", "in", " ", 
      "the", " ", "VolumeVersusDistanceTSH", " ", "file"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsInBw", "[", "v_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"ToRodrigues", "[", "v", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"ToRodrigues", "[", "v", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"ToRodrigues", "[", "v", "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], "\[LessEqual]", 
     "1"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Replaces", " ", 
      RowBox[{"IsInSw", ".", " ", "Written"}], " ", "May", " ", "2015"}], ",",
      " ", 
     RowBox[{"probably", " ", "rewriting", " ", "old", " ", "stuff"}], ",", 
     " ", 
     RowBox[{
     "but", " ", "I", " ", "cannot", " ", "find", " ", "the", " ", "old", " ",
       "stuff"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsInBwInterior", "[", "v_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"ToRodrigues", "[", "v", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"ToRodrigues", "[", "v", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"ToRodrigues", "[", "v", "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], "<", "1"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsVisibleForBw", "[", 
    RowBox[{"v_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{"!", 
    RowBox[{"IsInBwInterior", "[", 
     RowBox[{
      RowBox[{".999", "v"}], "+", 
      RowBox[{".001", "eye"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.554693091197853*^9, 3.5546931990252414`*^9}, 
   3.5546950300276337`*^9, {3.554695329579356*^9, 3.554695330140957*^9}, {
   3.5546959673252687`*^9, 3.5546959685108705`*^9}, {3.588621074227775*^9, 
   3.5886210929078007`*^9}, {3.588621260048032*^9, 3.588621267448042*^9}, {
   3.5973346553813314`*^9, 3.5973346568165336`*^9}, 3.603557952322356*^9, {
   3.6404475750963464`*^9, 3.6404475775663495`*^9}, {3.640452752441052*^9, 
   3.640452782821094*^9}, {3.6481700025526056`*^9, 3.6481700471326675`*^9}, {
   3.648170080312713*^9, 3.648170090222727*^9}, {3.6481701356027894`*^9, 
   3.6481702046128845`*^9}, {3.6954839250033693`*^9, 3.695483975276538*^9}}],

Cell["\<\
Written January 2015,  NEEDS TO BE CHECKED.   I cannot believe there is no \
old command for this :\
\>", "Text",
 CellChangeTimes->{{3.631653425095397*^9, 3.6316534699054585`*^9}, {
  3.6316536208996696`*^9, 3.631653621669671*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VptInBw", "[", "v_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v", ",", 
         RowBox[{"fx", "[", "v", "]"}], ",", 
         RowBox[{"fy", "[", "v", "]"}], ",", 
         RowBox[{"fz", "[", "v", "]"}]}], "}"}], ",", "IsInBw"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VptInBwOfM", "[", "M_", "]"}], ":=", 
   RowBox[{"VptInBw", "[", 
    RowBox[{"RotationAxis", "[", 
     RowBox[{"Uraw", "[", "M", "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6316531845710626`*^9, 3.631653336383273*^9}, 
   3.631653366945317*^9, 3.6316534747354655`*^9, {3.631653509177514*^9, 
   3.631653550887572*^9}, {3.6316536012896423`*^9, 3.6316536163796635`*^9}, 
   3.640452187000272*^9}],

Cell[TextData[{
 "From the ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " file KaganArticleChecks:"
}], "Text",
 CellChangeTimes->{{3.600397189351655*^9, 3.600397199581669*^9}, {
  3.6003972323617144`*^9, 3.6003972456217327`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WofUdirect", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"u11_", "u12_", "u13_"},
       {"u21_", "u22_", "u23_"},
       {"u31_", "u32_", "u33_"}
      }], "\[NoBreak]", ")"}], "]"}], ":=", 
   FractionBox[
    SqrtBox[
     RowBox[{"1", "+", "u11", "+", "u22", "+", "u33"}]], "2"]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"XofUdirect", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"u11_", "u12_", "u13_"},
       {"u21_", "u22_", "u23_"},
       {"u31_", "u32_", "u33_"}
      }], "\[NoBreak]", ")"}], "]"}], ":=", 
   FractionBox[
    SqrtBox[
     RowBox[{"1", "+", "u11", "-", "u22", "-", "u33"}]], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KVector", "[", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"u11_", "u12_", "u13_"},
       {"u21_", "u22_", "u23_"},
       {"u31_", "u32_", "u33_"}
      }], "\[NoBreak]", ")"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u32", "-", "u23"}], ",", 
     RowBox[{"u13", "-", "u31"}], ",", 
     RowBox[{"u21", "-", "u12"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QsubW", "[", "U_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"WofUdirect", "[", "U", "]"}], ",", 
     FractionBox[
      RowBox[{"KVector", "[", "U", "]"}], 
      RowBox[{"4", " ", 
       RowBox[{"WofUdirect", "[", "U", "]"}]}]]}], "}"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rodrigues", "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}, {
  3.6927438364130945`*^9, 3.692743921475749*^9}, {3.6927441656793475`*^9, 
  3.6927441683199778`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToRodrigues", "[", "v_", "]"}], ":=", 
    FractionBox["v", 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{"v", ".", "v"}]}]]]}], ";"}], 
  StyleBox[
   RowBox[{"  ", 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]]}]], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"v", " ", "in", " ", "open", " ", "unit", " ", "ball"}], ",", 
     " ", 
     RowBox[{"Eq", " ", 
      RowBox[{"(", 
       RowBox[{"61", "a"}], ")"}], " ", "of", " ", "TapeTape2012Kagan"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FromRodrigues", "[", "vp_", "]"}], ":=", 
    FractionBox["vp", 
     SqrtBox[
      RowBox[{"1", "+", 
       RowBox[{"vp", ".", "vp"}]}]]]}], "  ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"vp", " ", "in", " ", 
       SuperscriptBox["R", "3"]}], ",", " ", 
      RowBox[{"Eq", " ", 
       RowBox[{"(", 
        RowBox[{"61", "b"}], ")"}], " ", "of", " ", "TapeTape2012Kagan"}]}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}], 
  StyleBox[
   RowBox[{"  ", 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XfaceOfW", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FromRodrigues", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "&"}], ",", 
     RowBox[{"BasicPolys", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", ".2"}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", ".2"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjRadialCube", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}], 
    RowBox[{"Max", "[", 
     RowBox[{
      RowBox[{"Abs", "[", "x", "]"}], ",", 
      RowBox[{"Abs", "[", "y", "]"}], ",", 
      RowBox[{"Abs", "[", "z", "]"}]}], "]"}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.54991839351775*^9, 3.549918418649393*^9}, {
   3.549918490846319*^9, 3.54991852591518*^9}, {3.5499187271243315`*^9, 
   3.549918771194408*^9}, {3.5499188838734045`*^9, 3.5499188849654064`*^9}, {
   3.549918947708716*^9, 3.54991909345977*^9}, {3.549919129012232*^9, 
   3.5499191428962564`*^9}, {3.54991919081954*^9, 3.5499191915683413`*^9}, {
   3.5500191761794915`*^9, 3.550019223837575*^9}, 3.550191804709987*^9, {
   3.5945180815293865`*^9, 3.594518088489396*^9}, 3.5945277145708256`*^9, {
   3.5945303704060316`*^9, 3.5945304668706665`*^9}, {3.6001266665772963`*^9, 
   3.600126667657298*^9}, {3.604011860134637*^9, 3.604011902629696*^9}, {
   3.6041711476415668`*^9, 3.6041711511515713`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elastic matrix", "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}, {
  3.6927438364130945`*^9, 3.692743921475749*^9}, {3.6927441656793475`*^9, 
  3.6927441881794453`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Hmat", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "2"}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToVector", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"m1_", "m6_", "m5_"},
        {"m6dum_", "m2_", "m4_"},
        {"m5dum_", "m4dum_", "m3_"}
       }], "\[NoBreak]", ")"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5", ",", "m6"}], 
     "}"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"only", " ", "for", " ", "symmetric", " ", "M", " ", "though"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "m5_", ",", "m6_"}], 
     "}"}], "]"}], ":=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m1", "m6", "m5"},
      {"m6", "m2", "m4"},
      {"m5", "m4", "m3"}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5749038704093246`*^9, 3.5749038714389257`*^9}, 
   3.610078692301519*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToVectorIsometry", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"m1_", "m6_", "m5_"},
        {"m6dum_", "m2_", "m4_"},
        {"m5dum_", "m4dum_", "m3_"}
       }], "\[NoBreak]", ")"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "m2", ",", "m3", ",", 
      RowBox[{"m4", 
       SqrtBox["2"]}], ",", 
      RowBox[{"m5", 
       SqrtBox["2"]}], ",", 
      RowBox[{"m6", 
       SqrtBox["2"]}]}], "}"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"only", " ", "for", " ", "symmetric", " ", "M", " ", "though"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToMatrixIsometry", "[", 
    RowBox[{"{", 
     RowBox[{
     "m1_", ",", "m2_", ",", "m3_", ",", "m4_", ",", "m5_", ",", "m6_"}], 
     "}"}], "]"}], ":=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"m1", 
       RowBox[{"m6", "/", 
        SqrtBox["2"]}], 
       RowBox[{"m5", "/", 
        SqrtBox["2"]}]},
      {
       RowBox[{"m6", "/", 
        SqrtBox["2"]}], "m2", 
       RowBox[{"m4", "/", 
        SqrtBox["2"]}]},
      {
       RowBox[{"m5", "/", 
        SqrtBox["2"]}], 
       RowBox[{"m4", "/", 
        SqrtBox["2"]}], "m3"}
     }], "\[NoBreak]", ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.610312396180094*^9, 3.610312443580159*^9}, {
  3.610312492172227*^9, 3.6103125178922625`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["About lune probability", "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}, {
  3.6927438364130945`*^9, 3.692743921475749*^9}, {3.6927441656793475`*^9, 
  3.6927441881794453`*^9}, {3.6927442216794624`*^9, 3.6927442270545096`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProbDensityOnLune", "[", 
     RowBox[{"{", 
      RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     FractionBox["4", "\[Pi]"], 
     SuperscriptBox[
      RowBox[{"Sin", "[", "\[Beta]", "]"}], "3"], 
     RowBox[{"Cos", "[", 
      RowBox[{"3", "\[Gamma]"}], "]"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "although", " ", "the", " ", "inputs", " ", "are", " ", "\[Beta]", " ", 
      "and", " ", "\[Gamma]"}], ",", " ", 
     RowBox[{
     "this", " ", "is", " ", "prob", " ", "density", " ", "on", " ", "the", 
      " ", "LUNE"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"\[CapitalLambda]uniform", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[CapitalLambda]test", "=", "RandomDirection"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Theta", "[", "\[CapitalLambda]test", "]"}], "]"}], ">", 
        RowBox[{"\[Pi]", "/", "6"}]}], ",", 
       RowBox[{"\[CapitalLambda]test", "=", "RandomDirection"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"Transpose", "[", "uG", "]"}], ".", "\[CapitalLambda]test"}]}], 
    ")"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalLambda]withLuneDensity", ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[CapitalLambda]test", "=", "\[CapitalLambda]uniform"}], ";", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ProbDensityOnLune", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Beta]FN", "[", "\[CapitalLambda]test", "]"}], ",", 
          RowBox[{"\[Gamma]FN", "[", "\[CapitalLambda]test", "]"}]}], "}"}], 
        "]"}], "<", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          FractionBox["4", "\[Pi]"]}], "}"}], "]"}]}], ",", 
      RowBox[{"\[CapitalLambda]test", "=", "\[CapitalLambda]uniform"}]}], 
     "]"}], ";", "\[CapitalLambda]test"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.6326829648136387`*^9, 3.6326830449137487`*^9}, {
   3.6333004417102604`*^9, 3.6333004758203077`*^9}, 3.6333019327623177`*^9, {
   3.633302685645358*^9, 3.633302699335377*^9}, {3.633302780255489*^9, 
   3.633302822177548*^9}, {3.633302868777612*^9, 3.6333028699676137`*^9}, {
   3.633303142059991*^9, 3.63330315602001*^9}, {3.6333098909860888`*^9, 
   3.6333099004061017`*^9}, {3.6333100134182587`*^9, 
   3.6333100374382925`*^9}, {3.63331007228834*^9, 3.6333100840983562`*^9}, {
   3.6333101337704268`*^9, 3.633310140030435*^9}, {3.633310181710492*^9, 
   3.633310203010522*^9}, {3.6333102405105734`*^9, 3.6333103458107185`*^9}, 
   3.63415061142879*^9, {3.642032741879628*^9, 3.642032744172832*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Level surfaces of \[Omega].  This can all probably be done more easily in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10."
}], "Subsection",
 CellChangeTimes->{{3.692743754897293*^9, 3.6927437736317616`*^9}, {
   3.6927438364130945`*^9, 3.692743921475749*^9}, {3.6927441656793475`*^9, 
   3.6927441881794453`*^9}, {3.6927442347889132`*^9, 3.69274424169512*^9}, {
   3.692744293742161*^9, 3.6927442985702877`*^9}, 3.6927444711331253`*^9, {
   3.6927445068831477`*^9, 3.6927445302113667`*^9}, {3.692744626258415*^9, 
   3.6927446271959305`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Omega", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"AngleMatrix", "[", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", "\[CapitalLambda]", "]"}], ",", 
     RowBox[{"LamSubU", "[", 
      RowBox[{"\[CapitalLambda]", ",", 
       RowBox[{"ROT", "[", "v", "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6476473132709694`*^9, 3.6476473696410475`*^9}, {
   3.647647442911148*^9, 3.647647444881151*^9}, {3.6476474990312257`*^9, 
   3.647647526761264*^9}, 3.647651901117301*^9, {3.647746491869151*^9, 
   3.6477465428092213`*^9}, {3.6477465829092765`*^9, 
   3.6477465953392935`*^9}, {3.647746638079353*^9, 3.647746661259385*^9}, {
   3.647749172862851*^9, 3.6477491763028555`*^9}, 3.6477810336231833`*^9, {
   3.647781681214077*^9, 3.6477816822840786`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]Scaled", "[", 
     RowBox[{"contour_", ",", "\[CapitalLambda]_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "180"}], "+", 
      RowBox[{"2", 
       RowBox[{"angle", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "+", "contour"}], 
     RowBox[{
      RowBox[{"-", "170"}], "+", 
      RowBox[{"2", 
       RowBox[{"angle", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}]]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"contour", " ", "is", " ", "in", " ", "degrees"}], ",", " ", 
     "decreasing"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6477815428538866`*^9, 3.6477815577639065`*^9}, {
  3.6477816949040956`*^9, 3.647781706914113*^9}, {3.6477818209942703`*^9, 
  3.6477818304042835`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]Scaled", "[", 
     RowBox[{"contour_", ",", "\[CapitalLambda]_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{"10", "-", "contour"}], 
     RowBox[{
      RowBox[{"-", "170"}], "+", 
      RowBox[{"2", 
       RowBox[{"angle", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}]]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"contour", " ", "is", " ", "in", " ", "degrees"}], ",", " ", 
     "increasing"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6477813392536054`*^9, 3.647781356633629*^9}, {
  3.6477814241137223`*^9, 3.6477814352537374`*^9}, {3.647781709704117*^9, 
  3.64778171211412*^9}, {3.6477818118742576`*^9, 3.647781812864259*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "OmegaLevelSurfaceInRodrigues", "]"}], ";", "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"one", " ", "octant", " ", "only"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
  RowBox[{
   RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contour_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "=", 
    RowBox[{"ContourPlot3D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", 
       RowBox[{"{", "contour", "}"}]}], ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Hue", "[", 
         RowBox[{".15", ",", ".5", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OmegaLevelSurface", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contour_"}], "]"}], ":=", "    ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"used", " ", "to", " ", "be", " ", "CP3Dcontour"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{"FromRodrigues", "/@", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.647708983923522*^9, 3.6477089945635366`*^9}, 
   3.6477096467544365`*^9, {3.6477098117546644`*^9, 3.6477098140846677`*^9}, {
   3.6477117415791035`*^9, 3.6477117438891068`*^9}, {3.6477127558005033`*^9, 
   3.647712756950505*^9}, {3.6478022139719667`*^9, 3.6478022156319685`*^9}, 
   3.6478024669260607`*^9, 3.6479050669269595`*^9, 3.6479052016643944`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "OmegaLevelSurfaceInRodrigues", "]"}], ";", "   ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"one", " ", "octant", " ", "only"}], ",", " ", 
      RowBox[{"and", " ", "in", " ", "Bw"}], ",", " ", 
      RowBox[{"contours", " ", "are", " ", "in", " ", "DEGREES"}]}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{
    RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
     RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
      RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
     RowBox[{"ContourPlot3D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Omega", "[", 
         RowBox[{"\[CapitalLambda]", ",", 
          RowBox[{"FromRodrigues", "[", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], "/", 
        "Degree"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ContourStyle", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
            RowBox[{"\[Omega]Scaled", "[", 
             RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], "/@",
           "contours"}], ")"}]}]}], "]"}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"opacity", " ", "used", " ", "to", " ", "be", " ", "0.6"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OmegaLevelSurface", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", "    ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"used", " ", "to", " ", "be", " ", "CP3Dcontour"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{"FromRodrigues", "/@", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"OmegaLevelSurfaceInRodrigues", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6476469364704494`*^9, 3.6476469399304543`*^9}, 
   3.647647057880617*^9, {3.6476471190907016`*^9, 3.647647145400738*^9}, 
   3.6476473904410763`*^9, {3.647647544041288*^9, 3.6476475672013197`*^9}, {
   3.6476482719022923`*^9, 3.647648286602313*^9}, {3.647659467852913*^9, 
   3.647659480762931*^9}, 3.647659716253256*^9, {3.6477444851263337`*^9, 
   3.6477444902863407`*^9}, {3.647744602266495*^9, 3.6477446029564962`*^9}, {
   3.647744890456899*^9, 3.647744950606982*^9}, {3.6477453038074694`*^9, 
   3.6477453151774855`*^9}, {3.6477469639898024`*^9, 
   3.6477469695898104`*^9}, {3.647749200232888*^9, 3.6477492054628954`*^9}, 
   3.6477810068931465`*^9, {3.6477820747846203`*^9, 3.6477820841946335`*^9}, 
   3.6477821688947506`*^9, {3.6477823142549505`*^9, 3.647782315694953*^9}, {
   3.6477824186350946`*^9, 3.647782419405096*^9}, {3.6477825697653036`*^9, 
   3.647782570495304*^9}, 3.647782687825466*^9, 3.6477971116438694`*^9, {
   3.647797443704328*^9, 3.6477974447543297`*^9}, {3.6477985688001266`*^9, 
   3.6477985693401346`*^9}, {3.6477986509113846`*^9, 3.6477986588790064`*^9}, 
   3.647798718962427*^9, 3.647800748912834*^9, 3.647804087573517*^9, {
   3.647804709947677*^9, 3.647804710637678*^9}, 3.647806811968055*^9, {
   3.6478224059172025`*^9, 3.6478224169558334`*^9}, {3.648052411981386*^9, 
   3.6480524485314364`*^9}, {3.6480526942317753`*^9, 3.6480526969917793`*^9}, 
   3.648052889012044*^9, {3.648053315492633*^9, 3.648053338082664*^9}, {
   3.648053391172737*^9, 3.6480533937027407`*^9}, {3.6480534654628396`*^9, 
   3.648053473352851*^9}, 3.6480537041831694`*^9, {3.64805383498335*^9, 
   3.648053838073354*^9}, {3.6480538842134175`*^9, 3.648053886473421*^9}, {
   3.648054003353582*^9, 3.6480540329036226`*^9}, 3.648054152003787*^9, {
   3.648088144586731*^9, 3.64808815085674*^9}, {3.6480881985018063`*^9, 
   3.648088204971815*^9}, {3.648088408049596*^9, 3.648088414932106*^9}, {
   3.6480887017575026`*^9, 3.648088713570019*^9}, {3.648088745952564*^9, 
   3.648088751292571*^9}, {3.6480888063151474`*^9, 3.6480888268151755`*^9}, {
   3.648088877067745*^9, 3.648088901700279*^9}, {3.6480891149805746`*^9, 
   3.6480891317255983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OmegaLevelSurfaceAllBw", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"OmegaLevelSurface", "[", 
      RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"GraphicsComplex", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"xref", ".", "#"}], "&"}], "/@", 
          RowBox[{
           RowBox[{"OmegaLevelSurface", "[", 
            RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"OmegaLevelSurface", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"yref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurface", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurface", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurface", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurface", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xref", ".", "yref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurface", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurface", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xref", ".", "zref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurface", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurface", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"yref", ".", "zref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurface", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurface", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", "                      ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurface", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurface", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.647565332562626*^9, 3.64756542976276*^9}, {
  3.6475655251128917`*^9, 3.6475655598729396`*^9}, {3.647565606583004*^9, 
  3.6475656104830093`*^9}, {3.6475658301033125`*^9, 3.6475659392734632`*^9}, {
  3.6475659808535204`*^9, 3.6475659851535263`*^9}, {3.6476470281805763`*^9, 
  3.6476470400305924`*^9}, {3.6480524534114428`*^9, 3.6480524978515043`*^9}, {
  3.6480529495221276`*^9, 3.6480529537621336`*^9}, {3.6480530341022444`*^9, 
  3.648053037252249*^9}}],

Cell["In one octant of unit ball, not Bw", "Text",
 CellChangeTimes->{{3.6478251757436275`*^9, 3.6478251896774244`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "OmegaLevelSurfaceInSphericalCoords", "]"}], ";"}], 
  "        "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OmegaLevelSurfaceInSphericalCoords", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contour_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OmegaLevelSurfaceInSphericalCoords", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "=", 
    RowBox[{"ContourPlot3D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Rho]", " ", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}], 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
           RowBox[{"\[Rho]", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
           RowBox[{"\[Rho]", " ", 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "}"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", ".0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Phi]", ",", "0", ",", 
        RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", 
       RowBox[{"{", "contour", "}"}]}], ",", 
      RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Orange", ",", 
         RowBox[{"Opacity", "[", "1.0", "]"}], ",", 
         RowBox[{"Specularity", "[", 
          RowBox[{"White", ",", "30"}], "]"}]}], "]"}]}]}], "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contour_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], 
            RowBox[{"Sin", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "}"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInSphericalCoords", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"OmegaLevelSurfaceInSphericalCoords", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6004807798726606`*^9, 3.6004809291888714`*^9}, 
   3.600484073458226*^9, {3.6007110369669724`*^9, 3.6007110527169943`*^9}, 
   3.600711203199203*^9, {3.6007112484952717`*^9, 3.600711274285307*^9}, {
   3.6007113167853656`*^9, 3.6007113297953835`*^9}, {3.6007137126686945`*^9, 
   3.600713713398696*^9}, {3.6007137645607677`*^9, 3.6007137674327726`*^9}, 
   3.6009682606020036`*^9, {3.600997735400221*^9, 3.6009977389202256`*^9}, {
   3.600997800122311*^9, 3.6009978371823626`*^9}, 3.6013483400003777`*^9, 
   3.601672226787383*^9, 3.6019465743231945`*^9, {3.6019473503191924`*^9, 
   3.6019473517591944`*^9}, {3.6478232280152235`*^9, 3.647823260753096*^9}, {
   3.6478233693223057`*^9, 3.6478234444106007`*^9}, {3.6478246827824316`*^9, 
   3.647824684083506*^9}, {3.647825159211682*^9, 3.6478251606387634`*^9}}],

Cell["In entire unit ball, not Bw", "Text",
 CellChangeTimes->{{3.6478251757436275`*^9, 3.6478251896774244`*^9}, {
  3.6478252242504015`*^9, 3.6478252266985416`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"OmegaLevelSurfaceInWholeBall", "[", 
   RowBox[{"\[CapitalLambda]_", ",", "contour_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"yref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xref", ".", "yref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"xref", ".", "zref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"yref", ".", "zref", ".", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"GraphicsComplex", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "#"}], "&"}], "/@", 
         RowBox[{
          RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
           RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"OmegaLevelSurfaceInBallOctant", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contour"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6478242367659206`*^9, 3.647824244483362*^9}, {
  3.647824297999423*^9, 3.647824309035054*^9}}],

Cell["Contours of \[Omega] on the faces of Bw and on the cube faces :", "Text",
 CellChangeTimes->{{3.64765228466783*^9, 3.647652372807952*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
    RowBox[{"\[Omega]Scaled", "[", 
     RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], "/@", 
  "contours"}]], "Input",
 CellChangeTimes->{{3.6480937092780523`*^9, 3.648093717118063*^9}, 
   3.648093770318136*^9}],

Cell[BoxData["contours"], "Output",
 CellChangeTimes->{3.671384368909198*^9, 3.6718108851571455`*^9, 
  3.6788241797663126`*^9, 3.685648731514084*^9, 3.690833501122504*^9, 
  3.6954834778790846`*^9, 3.6979930813327475`*^9, 3.6987677883058877`*^9, 
  3.698792307137844*^9, 3.7111239972611465`*^9, 3.71112872596494*^9, 
  3.711286626962881*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "RodriguesXminus1", ",", "RodriguesYminus1", ",", "RodriguesZminus1"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesXminus1", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesXminus1", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], 
       "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "1.01"}], ",", "1.01"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "1.01"}], ",", "1.01"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
           RowBox[{"\[Omega]Scaled", "[", 
            RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], "/@",
          "contours"}], ")"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesYminus1", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesYminus1", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "1"}], ",", "z"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1.01"}], ",", "1.01"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "1.01"}], ",", "1.01"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesZminus1", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesZminus1", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", 
            RowBox[{"-", "1"}]}], "}"}], "]"}]}], "]"}], "/", "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1.01"}], ",", "1.01"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "1.01"}], ",", "1.01"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.647560522975989*^9, 3.647560527145994*^9}, {
   3.647561020226675*^9, 3.6475610246666813`*^9}, {3.64756400231079*^9, 
   3.6475640048607936`*^9}, {3.6475661064536943`*^9, 3.647566109033697*^9}, {
   3.6475673888354635`*^9, 3.647567431675523*^9}, {3.647568065126397*^9, 
   3.647568071726406*^9}, {3.6475692351980247`*^9, 3.6475692545705514`*^9}, {
   3.647569316710637*^9, 3.6475693680582085`*^9}, {3.647573479161646*^9, 
   3.6475734880816584`*^9}, 3.6476474676311827`*^9, 3.647648382322445*^9, 
   3.647648571442706*^9, {3.6476486086027575`*^9, 3.6476486455728083`*^9}, {
   3.6476512292963734`*^9, 3.6476512364063835`*^9}, {3.64765193654735*^9, 
   3.6476519370273504`*^9}, {3.6476520966875706`*^9, 3.647652100767576*^9}, {
   3.6480928125368147`*^9, 3.648092924746969*^9}, {3.6480929884970574`*^9, 
   3.648092992017062*^9}, {3.648093103897217*^9, 3.6480931044272175`*^9}, {
   3.6480931532772846`*^9, 3.648093154237286*^9}, {3.6480932560274267`*^9, 
   3.6480932640774374`*^9}, 3.648093333667534*^9, {3.6480933872476077`*^9, 
   3.648093391257613*^9}, {3.6480934682577195`*^9, 3.648093499837763*^9}, {
   3.648093633427947*^9, 3.648093640337957*^9}, {3.648093721588069*^9, 
   3.6480937262580757`*^9}, {3.6480938401482325`*^9, 3.648093843138237*^9}, {
   3.6480940338885*^9, 3.648094060058536*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BwXminus1", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{".01", ",", "0", ",", "0"}], "}"}], "+", 
          RowBox[{"FromRodrigues", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"RodriguesXminus1", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesXminus1", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BwYminus1", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", ".01", ",", "0"}], "}"}], "+", 
          RowBox[{"FromRodrigues", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"RodriguesYminus1", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesYminus1", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BwZminus1", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", ".01"}], "}"}], "+", 
          RowBox[{"FromRodrigues", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], "]"}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"RodriguesZminus1", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesZminus1", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.648092838876851*^9, 3.6480928423668556`*^9}, {
  3.6480929125469522`*^9, 3.6480929125669527`*^9}, {3.648092955027011*^9, 
  3.6480929636170235`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesXminus1inSpace", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{".01", ",", "0", ",", "0"}], "}"}], "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"RodriguesXminus1", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesXminus1", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesYminus1inSpace", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", ".01", ",", "0"}], "}"}], "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"RodriguesYminus1", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesYminus1", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesZminus1inSpace", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", ".01"}], "}"}], "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "&"}], "/@", 
        RowBox[{
         RowBox[{"RodriguesZminus1", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesZminus1", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.647625849952173*^9, 3.6476258734122057`*^9}, {
  3.6476259243222756`*^9, 3.647625988402364*^9}, {3.6476260305924225`*^9, 
  3.6476260370224314`*^9}, {3.648092846136861*^9, 3.648092848876865*^9}, {
  3.648092912576953*^9, 3.648092912596953*^9}, {3.6480929689270306`*^9, 
  3.6480929762570405`*^9}}],

Cell["Contours of \[Omega] on the coordinate planes, one octant only :", \
"Text",
 CellChangeTimes->{{3.64765228466783*^9, 3.647652372807952*^9}, {
  3.6477083698926744`*^9, 3.6477083782026863`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ColorFunction", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Hue", "[", 
     RowBox[{"\[Omega]Scaled", "[", 
      RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ColorFunction", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Hue", "[", 
     RowBox[{"\[Omega]Scaled", "[", 
      RowBox[{"#1", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
   "}"}]}]], "Output",
 CellChangeTimes->{3.6529377664730887`*^9, 3.657167507317253*^9, 
  3.671384369211215*^9, 3.6718108854171457`*^9, 3.678824179876317*^9, 
  3.6856487318734617`*^9, 3.6908335014856267`*^9, 3.695483478279483*^9, 
  3.6979930815197687`*^9, 3.6987677884749002`*^9, 3.6987923072578545`*^9, 
  3.711123997562154*^9, 3.7111287260699377`*^9, 3.711286627172161*^9}]
}, Open  ]],

Cell["\<\
Contours of \[Omega] on the coordinate planes in one octant of Bw: :\
\>", "Text",
 CellChangeTimes->{{3.64765228466783*^9, 3.647652372807952*^9}, {
  3.6477083698926744`*^9, 3.6477083782026863`*^9}, {3.647890660317263*^9, 
  3.6478906715197787`*^9}, {3.648054772274643*^9, 3.648054790864669*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"RodriguesXY", ",", "RodriguesXZ", ",", "RodriguesYZ"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesXY", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesXY", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "0"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesXZ", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesXZ", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "z"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesYZ", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesYZ", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.647743299894698*^9, 3.647743304354704*^9}, {
   3.647743602175115*^9, 3.647743609705126*^9}, 3.64774385201546*^9, {
   3.6477439909556513`*^9, 3.647743991305652*^9}, 3.647744022025695*^9, {
   3.6477442605560236`*^9, 3.6477442667460327`*^9}, {3.6477443725461783`*^9, 
   3.647744384006194*^9}, {3.6477469899498386`*^9, 3.647746997569849*^9}, {
   3.647749239382942*^9, 3.647749251342959*^9}, {3.647781008173148*^9, 
   3.6477810107031517`*^9}, 3.6477819033243837`*^9, {3.6477827215655127`*^9, 
   3.647782724095516*^9}, {3.6477828134856396`*^9, 3.647782827225659*^9}, {
   3.648054411544145*^9, 3.648054474874233*^9}, {3.648054527494305*^9, 
   3.6480545404443235`*^9}}],

Cell["\<\
Contours of \[Omega] on the coordinate planes, all of Bw not just octant :\
\>", "Text",
 CellChangeTimes->{{3.64765228466783*^9, 3.647652372807952*^9}, {
  3.6477083698926744`*^9, 3.6477083782026863`*^9}, {3.647890660317263*^9, 
  3.6478906715197787`*^9}},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"RodriguesXY", ",", "RodriguesXZ", ",", "RodriguesYZ"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesXY", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesXY", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "0"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesXZ", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesXZ", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "z"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RodriguesYZ", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"RodriguesYZ", "[", 
     RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "=", 
    RowBox[{"ContourPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Omega", "[", 
        RowBox[{"\[CapitalLambda]", ",", 
         RowBox[{"FromRodrigues", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "y", ",", "z"}], "}"}], "]"}]}], "]"}], "/", 
       "Degree"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
          RowBox[{"\[Omega]Scaled", "[", 
           RowBox[{"#", ",", "\[CapitalLambda]"}], "]"}], "]"}], "&"}], 
        "}"}]}], ",", 
      RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.647743299894698*^9, 3.647743304354704*^9}, {
   3.647743602175115*^9, 3.647743609705126*^9}, 3.64774385201546*^9, {
   3.6477439909556513`*^9, 3.647743991305652*^9}, 3.647744022025695*^9, {
   3.6477442605560236`*^9, 3.6477442667460327`*^9}, {3.6477443725461783`*^9, 
   3.647744384006194*^9}, {3.6477469899498386`*^9, 3.647746997569849*^9}, {
   3.647749239382942*^9, 3.647749251342959*^9}, {3.647781008173148*^9, 
   3.6477810107031517`*^9}, 3.6477819033243837`*^9, {3.6477827215655127`*^9, 
   3.647782724095516*^9}, {3.6477828134856396`*^9, 3.647782827225659*^9}, {
   3.6478906909423056`*^9, 3.6478907268723555`*^9}, {3.648054478204237*^9, 
   3.648054484144245*^9}, {3.6480545670243597`*^9, 3.6480545777943745`*^9}, {
   3.648230965314988*^9, 3.6482309739049997`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CPxy", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{"FromRodrigues", "/@", 
        RowBox[{
         RowBox[{"RodriguesXY", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesXY", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CPxz", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{"FromRodrigues", "/@", 
        RowBox[{
         RowBox[{"RodriguesXZ", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesXZ", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CPyz", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{"FromRodrigues", "/@", 
        RowBox[{
         RowBox[{"RodriguesYZ", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"RodriguesYZ", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CPxy3D", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"CPxy", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"CPxy", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CPyz3D", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"CPyz", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"CPyz", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CPxz3D", "[", 
    RowBox[{"\[CapitalLambda]_", ",", "contours_"}], "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"GraphicsComplex", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{
         RowBox[{"CPxz", "[", 
          RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"CPxz", "[", 
         RowBox[{"\[CapitalLambda]", ",", "contours"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.600542801154188*^9, 3.600542932597184*^9}, {
   3.6005430044669576`*^9, 3.600543029424553*^9}, {3.6005436222500334`*^9, 
   3.6005436412600594`*^9}, {3.600544543517312*^9, 3.600544604567396*^9}, {
   3.600544668607485*^9, 3.6005448181496935`*^9}, {3.6005450649300346`*^9, 
   3.6005450733925467`*^9}, {3.600546879601553*^9, 3.6005468806615543`*^9}, 
   3.6009682605820036`*^9, {3.6009706192452707`*^9, 3.600970619255271*^9}, {
   3.6009706637353325`*^9, 3.6009706637453327`*^9}, {3.601348326380359*^9, 
   3.601348327670361*^9}, {3.6016722130673647`*^9, 3.601672214837367*^9}, 
   3.6025170476735687`*^9, 3.602517112045661*^9, {3.6025175919283247`*^9, 
   3.6025175930983257`*^9}, {3.602517626318372*^9, 3.6025176310003796`*^9}, {
   3.602521300393494*^9, 3.602521302343497*^9}, 3.602521539243824*^9, {
   3.602522476688635*^9, 3.602522488148651*^9}, 3.602522551298738*^9, {
   3.6025577833872433`*^9, 3.602557814377286*^9}, {3.6025578450973287`*^9, 
   3.6025578515473375`*^9}, {3.602558033646363*^9, 3.602558043096376*^9}, {
   3.60261153490283*^9, 3.602611542492841*^9}, {3.602611711955076*^9, 
   3.602611723415092*^9}, {3.602611806729212*^9, 3.6026118355612526`*^9}, {
   3.602611866491295*^9, 3.6026118893213267`*^9}, {3.602614653757162*^9, 
   3.6026146763371935`*^9}, {3.602614723827259*^9, 3.60261472461726*^9}, {
   3.6476584683815336`*^9, 3.6476585165616*^9}, {3.647658547641643*^9, 
   3.6476585480916433`*^9}, {3.647696402703332*^9, 3.647696412633345*^9}, {
   3.647696445653391*^9, 3.647696447333393*^9}, {3.647696926914055*^9, 
   3.6476969404240737`*^9}, {3.647697193924474*^9, 3.6476971951444755`*^9}, {
   3.6476972343245296`*^9, 3.6476973059946284`*^9}, 3.647697355044696*^9, {
   3.6476989898019524`*^9, 3.647699001651969*^9}, {3.6477013635553665`*^9, 
   3.647701390310403*^9}, {3.6477085734029555`*^9, 3.6477086319330363`*^9}, {
   3.647712027489498*^9, 3.64771203603951*^9}, {3.647712720300454*^9, 
   3.647712731200469*^9}, 3.64771325357119*^9, {3.6477357078065767`*^9, 
   3.647735715296587*^9}, {3.6477358712468023`*^9, 3.6477358751468077`*^9}, {
   3.647735909166855*^9, 3.6477359394368963`*^9}, 3.647736045637043*^9, {
   3.6477362277672944`*^9, 3.6477362424573145`*^9}, {3.647736460667616*^9, 
   3.6477364658376226`*^9}, {3.647743252134632*^9, 3.6477432577846403`*^9}, {
   3.6480544965042624`*^9, 3.6480545102042813`*^9}, {3.648054613414424*^9, 
   3.6480546524144773`*^9}, {3.6480546843245215`*^9, 3.648054714934564*^9}, {
   3.648087816101277*^9, 3.648087824981289*^9}, 3.648087857346334*^9}],

Cell[CellGroupData[{

Cell[TextData[{
 "Critical values for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Omega]", "\[CapitalLambda]"], " ", "when", " ", 
     "\[Beta]"}], " ", "=", " ", 
    RowBox[{"\[Pi]", "/", "2."}]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsubsection",
 CellChangeTimes->{{3.6684825730607142`*^9, 3.668482597690748*^9}, {
   3.6692168321601753`*^9, 3.6692168488401985`*^9}, {3.6692169364503193`*^9, 
   3.669216939450324*^9}, {3.6695111893185234`*^9, 3.6695112351921473`*^9}, {
   3.6695113022319813`*^9, 3.669511304408106*^9}, {3.66951135413395*^9, 
   3.669511363112464*^9}, {3.6696437981862493`*^9, 3.6696438020562544`*^9}, 
   3.671288154067546*^9, {3.6717308592187347`*^9, 3.671730872008753*^9}, {
   3.67173230118073*^9, 3.67173230118073*^9}, {3.6717330415917535`*^9, 
   3.6717330590617776`*^9}, {3.685656203302766*^9, 3.6856562282246475`*^9}, {
   3.692744661570943*^9, 3.6927447036179037`*^9}},
 FontFamily->"Arial"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]1", "[", "\[Gamma]_", "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "3"}], "-", 
     RowBox[{"2", 
      RowBox[{"Abs", "[", "\[Gamma]", "]"}]}]}]}], ";"}], "       ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"only", " ", "for", " ", "deviatoric"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]2", "[", "\[Gamma]_", "]"}], ":=", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "3"}], "+", 
     RowBox[{"2", 
      RowBox[{"Abs", "[", "\[Gamma]", "]"}]}]}]}], ";"}], 
  "     "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]3", "[", "\[Gamma]_", "]"}], ":=", 
    RowBox[{"2", 
     RowBox[{"\[Pi]", "/", "3"}]}]}], ";"}], "    "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]4", "[", "\[Gamma]_", "]"}], ":=", 
    RowBox[{"\[Pi]", "-", 
     RowBox[{"2", 
      RowBox[{"Abs", "[", "\[Gamma]", "]"}]}]}]}], ";"}], 
  "       "}]}], "Input",
 CellChangeTimes->{{3.6690627245689917`*^9, 3.6690627274489956`*^9}, {
  3.6699087981305113`*^9, 3.6699088127553473`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "This section is the code for getting the left segment of the \[Omega] \
distribution.  So the relevant critical point is the origin, not (0, 1/",
 Cell[BoxData[
  FormBox[
   SqrtBox["2"], TraditionalForm]], "None"],
 ", 0). ",
 "Examples and derivations are in the file OmegaDerivingHistogramCurves."
}], "Subsection",
 CellChangeTimes->{{3.639882679779216*^9, 3.6398827108829947`*^9}, {
   3.639882969425782*^9, 3.639882975408125*^9}, {3.639937894220966*^9, 
   3.639937927724882*^9}, {3.6399390927855186`*^9, 3.639939096677741*^9}, {
   3.64001631541529*^9, 3.640016335821457*^9}, {3.6401004165430393`*^9, 
   3.640100428557727*^9}, 3.640100560320263*^9, 3.6927450029934883`*^9},
 FontColor->RGBColor[1, 0, 1]],

Cell["\[Beta] = \[Pi]/2 up until the last command  dVd\[Omega]Left[\[Omega], \
{\[Beta], \[Gamma]}]", "Text",
 CellChangeTimes->{{3.6398805647082405`*^9, 3.6398806053855667`*^9}, {
   3.6398806461799*^9, 3.6398806744575176`*^9}, {3.6398821590184298`*^9, 
   3.6398821787355576`*^9}, {3.6398822480805235`*^9, 3.639882248991576*^9}, {
   3.64009890735072*^9, 3.640098936613394*^9}, 3.6444262686823993`*^9, 
   3.6444263423025007`*^9, 3.644426568422813*^9, 3.645980329772415*^9},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cos\[Omega]", "[", 
    RowBox[{"\[Rho]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], "]"}],
    ":=", "               ", 
   RowBox[{"(*", 
    RowBox[{" ", 
     StyleBox[
      RowBox[{
       RowBox[{
       "for", " ", "the", " ", "critical", " ", "point", " ", "at", " ", 
        "the", " ", 
        RowBox[{"origin", ".", " ", "No"}], " ", "Rodrigues", " ", "coords"}],
        ",", " ", 
       RowBox[{
       "Pole", " ", "of", " ", "spherical", " ", "coords", " ", "at", " ", 
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}]}]}]}],
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox["}",
      FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], 
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"8", "-", 
         RowBox[{"40", " ", 
          SuperscriptBox["\[Rho]", "2"]}], "+", 
         RowBox[{"35", " ", 
          SuperscriptBox["\[Rho]", "4"]}], "+", 
         RowBox[{
          SuperscriptBox["\[Rho]", "4"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "\[Theta]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"4", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["\[Rho]", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "6"}], "+", 
            RowBox[{"7", " ", 
             SuperscriptBox["\[Rho]", "2"]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["\[Rho]", "4"], " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}], "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "\[Phi]"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Gamma]", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["\[Rho]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            SuperscriptBox["\[Rho]", "2"], "-", 
            RowBox[{
             SuperscriptBox["\[Rho]", "2"], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Gamma]", "]"}], "2"]}], "-", 
         RowBox[{
          SqrtBox["3"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["\[Rho]", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["\[Rho]", "2"], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "\[Gamma]"}], "]"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}]}], ")"}]}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Dcos\[Omega]D\[Rho]", "[", 
     RowBox[{"\[Rho]_", ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], 
     "]"}], ":=", " ", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", "\[Rho]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"], "+", 
             RowBox[{
              SuperscriptBox["\[Rho]", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Gamma]", "]"}], "2"]}], "-", 
          RowBox[{
           SqrtBox["3"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Rho]", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["\[Rho]", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2", " ", "\[Gamma]"}], "]"}]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
       RowBox[{"\[Rho]", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "\[Gamma]", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"5", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", 
             RowBox[{"7", " ", 
              SuperscriptBox["\[Rho]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", 
             RowBox[{"7", " ", 
              SuperscriptBox["\[Rho]", "2"]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[Rho]", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"4", " ", "\[Phi]"}], "]"}], "+", 
             RowBox[{"8", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"4", " ", "\[Theta]"}], "]"}], " ", 
              SuperscriptBox[
               RowBox[{"Sin", "[", "\[Phi]", "]"}], "4"]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}], " ", ";", 
   RowBox[{
    RowBox[{"\[Rho]of\[Omega]", "[", 
     RowBox[{"\[Omega]_", ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], 
     "]"}], ":=", 
    RowBox[{"\[Rho]", "/.", 
     RowBox[{"FindRoot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"cos\[Omega]", "[", 
         RowBox[{"\[Rho]", ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
         "]"}], "\[Equal]", 
        RowBox[{"Cos", "[", "\[Omega]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", ".3"}], "}"}]}], "]"}]}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D\[Rho]D\[Omega]", "[", 
     RowBox[{"\[Omega]_", ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Omega]", "]"}]}], 
     FractionBox["1", 
      RowBox[{"Dcos\[Omega]D\[Rho]", "[", 
       RowBox[{
        RowBox[{"\[Rho]of\[Omega]", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
       "]"}]]}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dVd\[Omega]Left", "[", 
    RowBox[{"\[Omega]_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"dVd\[Omega]Left", "[", 
     RowBox[{"\[Omega]", ",", "\[Gamma]"}], "]"}], "=", 
    RowBox[{"8", 
     FractionBox["4", 
      SuperscriptBox["\[Pi]", "2"]], 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D\[Rho]D\[Omega]", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
         "]"}], 
        FractionBox["1", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"\[Rho]of\[Omega]", "[", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{"{", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
             "]"}], "2"]}]]], 
        SuperscriptBox[
         RowBox[{"\[Rho]of\[Omega]", "[", 
          RowBox[{"\[Omega]", ",", 
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
          "]"}], "2"], 
        RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Phi]", ",", "0", ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dVd\[Omega]Left", "[", 
    RowBox[{"\[Omega]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "}"}]}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      FractionBox["\[Omega]", "2"], "]"}], " ", 
     RowBox[{"dVd\[Omega]Left", "[", 
      RowBox[{
       RowBox[{"\[Omega]DEV", "[", 
        RowBox[{"\[Omega]", ",", "\[Beta]"}], "]"}], ",", "\[Gamma]"}], 
      "]"}]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Beta]", "]"}], "2"], "-", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["\[Omega]", "2"], "]"}], "2"]}]]]}], 
  "                        ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"argument", " ", "is", " ", 
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "\[Gamma]"}], "}"}], " ", "instead", " ", "of", 
     " ", "\[Gamma]"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6398807387401943`*^9, 3.63988073970325*^9}, {
   3.6398810695551157`*^9, 3.6398810950405736`*^9}, {3.63988178627011*^9, 
   3.6398817900703273`*^9}, {3.6399294673894844`*^9, 3.639929483786422*^9}, {
   3.639937942798744*^9, 3.639937980242886*^9}, 3.6399635596085443`*^9, {
   3.6399671136418233`*^9, 3.6399671339069824`*^9}, {3.640016491461359*^9, 
   3.6400164982757487`*^9}, {3.640016645387163*^9, 3.640016655885763*^9}, {
   3.6400966810083804`*^9, 3.6400966851936197`*^9}, {3.640097495431963*^9, 
   3.6400975163621597`*^9}, {3.6400977494334908`*^9, 3.6400977504255476`*^9}, 
   3.640105391888111*^9, 3.640222853418931*^9, {3.644426270652402*^9, 
   3.644426276922411*^9}, {3.6444263462825065`*^9, 3.644426362872529*^9}, {
   3.6444265710528164`*^9, 3.6444265773228254`*^9}, 3.6452291010862074`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]DEV", "[", 
     RowBox[{"\[Omega]_", ",", "\[Beta]_"}], "]"}], ":=", 
    RowBox[{"2", " ", 
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"Csc", "[", "\[Beta]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Omega]", "2"], "]"}]}], "]"}]}]}], ";"}], "    ", 
  RowBox[{"(*", "  ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "\[Omega]DEV", " ", "and", " ", "\[Omega]\[Beta]", " ", "are", " ", 
      "functions", " ", "of", " ", "each", " ", "other"}], ",", " ", 
     RowBox[{"and", " ", "of", " ", "\[Beta]"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Omega]\[Beta]", "[", 
     RowBox[{"\[Omega]_", ",", "\[Beta]_"}], "]"}], ":=", 
    RowBox[{"2", 
     RowBox[{"ArcSin", "[", 
      RowBox[{
       RowBox[{"Sin", "[", 
        FractionBox["\[Omega]", "2"], "]"}], 
       RowBox[{"Sin", "[", "\[Beta]", "]"}]}], "]"}]}]}], ";"}], 
  "   "}]}], "Input",
 CellChangeTimes->{{3.6445400153719697`*^9, 3.6445401095620995`*^9}, {
  3.644542971546049*^9, 3.64454297211605*^9}, {3.6453751966232166`*^9, 
  3.6453752458089705`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "This section is the code for getting the right-hand segment of the \[Omega] \
distribution.  So the relevant critical point is  B =  (0, 1/",
 Cell[BoxData[
  FormBox[
   SqrtBox["2"], TraditionalForm]], "None"],
 ", 0), not  (0,0,0). ",
 "Examples and derivations are in the file OmegaDerivingHistogramCurves."
}], "Subsection",
 CellChangeTimes->{{3.639882679779216*^9, 3.6398827108829947`*^9}, {
   3.639882969425782*^9, 3.639882975408125*^9}, {3.639937894220966*^9, 
   3.639937927724882*^9}, {3.6399390927855186`*^9, 3.639939096677741*^9}, {
   3.6399626702436757`*^9, 3.6399626993183384`*^9}, {3.639967514045725*^9, 
   3.6399675160128374`*^9}, {3.6399676503005185`*^9, 3.639967653037675*^9}, {
   3.640016375883748*^9, 3.640016387372405*^9}, {3.6400263322890186`*^9, 
   3.640026335580207*^9}, {3.6400994274894695`*^9, 3.6400994307216544`*^9}, {
   3.6401013302623005`*^9, 3.6401013311903543`*^9}, {3.6401020772730274`*^9, 
   3.6401020908128023`*^9}, 3.6571675399369097`*^9},
 FontColor->RGBColor[1, 0, 1]],

Cell["\[Beta] = \[Pi]/2 up until the last command  dVd\[Omega]Right[\[Omega], \
{\[Beta], \[Gamma]}]", "Text",
 CellChangeTimes->{{3.6398805647082405`*^9, 3.6398806053855667`*^9}, {
   3.6398806461799*^9, 3.6398806744575176`*^9}, {3.6398821590184298`*^9, 
   3.6398821787355576`*^9}, {3.6398822480805235`*^9, 3.639882248991576*^9}, {
   3.64009890735072*^9, 3.640098936613394*^9}, 3.644426289912429*^9, {
   3.6444265841228347`*^9, 3.644426588792841*^9}, 3.645280189977951*^9},
 FontSize->14,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cos\[Omega]ForB", "[", 
    RowBox[{"\[Rho]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], "]"}],
    ":=", " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"8", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SuperscriptBox["\[Rho]", "2"], "-", 
         RowBox[{"2", " ", "\[Rho]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"16", "+", 
         SuperscriptBox["\[Rho]", "4"], "-", 
         RowBox[{"4", " ", "\[Rho]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"8", "+", 
               SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
            RowBox[{"8", " ", "\[Rho]", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["\[Rho]", "2"], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"3", " ", "\[Phi]"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[Rho]", "4"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"4", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Gamma]", "]"}], "2"]}], "+", 
      RowBox[{"16", " ", 
       SqrtBox["3"], " ", 
       SuperscriptBox["\[Rho]", "3"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"\[Rho]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Gamma]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "32"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["\[Rho]", "4"]}], "+", 
         RowBox[{"8", " ", "\[Rho]", " ", 
          RowBox[{"(", 
           RowBox[{"8", "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["\[Rho]", "2"]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Rho]", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"3", " ", "\[Phi]"}], "]"}]}], "+", 
            RowBox[{"\[Rho]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "+", 
               RowBox[{"Cos", "[", 
                RowBox[{"4", " ", "\[Phi]"}], "]"}], "+", 
               RowBox[{"8", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"4", " ", "\[Theta]"}], "]"}], " ", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Phi]", "]"}], "4"]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dcos\[Omega]D\[Rho]ForB", "[", 
    RowBox[{"\[Rho]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], "]"}],
    ":=", "           ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"from", " ", 
       RowBox[{"(", 
        RowBox[{"0", ",", 
         RowBox[{"1", "/", 
          SqrtBox["2"]}], ",", "0"}], ")"}]}], ",", " ", "Rodrigues"}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{
    FractionBox["1", 
     RowBox[{"8", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "+", 
         SuperscriptBox["\[Rho]", "2"], "-", 
         RowBox[{"2", " ", "\[Rho]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], "3"]}]], "\[Rho]", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"36", " ", 
       SuperscriptBox["\[Rho]", "2"]}], "+", 
      RowBox[{"12", " ", 
       RowBox[{"(", 
        RowBox[{"16", "+", 
         SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Gamma]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "\[Rho]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "48"}], "+", 
         SuperscriptBox["\[Rho]", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "120"}], "+", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Gamma]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
      RowBox[{"16", " ", 
       RowBox[{"(", 
        RowBox[{"8", "-", 
         SuperscriptBox["\[Rho]", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "4"}], "+", 
            RowBox[{"5", " ", 
             SuperscriptBox["\[Rho]", "2"]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Gamma]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Phi]"}], "]"}]}], "+", 
      RowBox[{"\[Rho]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "96"}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["\[Rho]", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"48", "-", 
            RowBox[{"7", " ", 
             SuperscriptBox["\[Rho]", "2"]}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Gamma]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"3", " ", "\[Phi]"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[Rho]", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"11", "-", 
         RowBox[{"7", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Gamma]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "\[Phi]"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[Rho]", "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "7"}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Gamma]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"5", " ", "\[Phi]"}], "]"}]}], "-", 
      RowBox[{"32", " ", 
       SqrtBox["3"], " ", "\[Rho]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Theta]"}], "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"6", "-", 
         RowBox[{"6", " ", "\[Rho]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[Rho]", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Phi]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"2", " ", "\[Gamma]"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"]}], "-", 
      RowBox[{"32", " ", 
       SuperscriptBox["\[Rho]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "\[Gamma]", "]"}], "2"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"4", " ", "\[Theta]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"\[Rho]", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Phi]", "]"}], "4"]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]of\[Omega]ForB", "[", 
    RowBox[{"\[Omega]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], "]"}],
    ":=", 
   RowBox[{"\[Rho]", "/.", 
    RowBox[{"FindRoot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cos\[Omega]ForB", "[", 
        RowBox[{"\[Rho]", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
        "]"}], "\[Equal]", 
       RowBox[{"Cos", "[", "\[Omega]", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Rho]", ",", ".3"}], "}"}]}], "]"}]}]}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", 
         SqrtBox["2"]}], ",", "0"}], ")"}]}], ",", " ", "Rodrigues"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D\[Rho]D\[Omega]ForB", "[", 
    RowBox[{"\[Omega]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], ",", "\[Gamma]_"}], "]"}],
    ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Sin", "[", "\[Omega]", "]"}]}], 
    FractionBox["1", 
     RowBox[{"Dcos\[Omega]D\[Rho]ForB", "[", 
      RowBox[{
       RowBox[{"\[Rho]of\[Omega]ForB", "[", 
        RowBox[{"\[Omega]", ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
      "]"}]]}]}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"from", " ", 
      RowBox[{"(", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", 
         SqrtBox["2"]}], ",", "0"}], ")"}]}], ",", " ", "Rodrigues"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dVd\[Omega]Right", "[", 
    RowBox[{"\[Omega]_", ",", "\[Gamma]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"dVd\[Omega]Right", "[", 
     RowBox[{"\[Omega]", ",", "\[Gamma]"}], "]"}], "=", "         ", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{
      "clear", " ", "dVd\[Omega]Right", " ", "if", " ", "make", " ", 
       "changes"}],
      FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Omega]", "==", 
       RowBox[{"\[Pi]", "-", 
        RowBox[{"2.", 
         RowBox[{"Abs", "[", "\[Gamma]", "]"}]}]}]}], ",", "0", ",", 
      RowBox[{
       RowBox[{"-", "8"}], 
       FractionBox[
        RowBox[{"4", " "}], 
        SuperscriptBox["\[Pi]", "2"]], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"D\[Rho]D\[Omega]ForB", "[", 
           RowBox[{"\[Omega]", ",", 
            RowBox[{"{", 
             RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
           "]"}], 
          FractionBox["1", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"length", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Rho]of\[Omega]ForB", "[", 
                   RowBox[{"\[Omega]", ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", 
                    "\[Gamma]"}], "]"}], 
                  RowBox[{
                   RowBox[{"ZRot", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ".", 
                   StyleBox["rot111",
                    FontColor->RGBColor[1, 0, 0]], 
                   StyleBox[".",
                    FontColor->RGBColor[1, 0, 0]], 
                   RowBox[{"xyzTP", "[", 
                    RowBox[{"{", 
                    RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}]}]}], 
                 "+", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "2"]}], 
             ")"}], "2"]], 
          SuperscriptBox[
           RowBox[{"\[Rho]of\[Omega]ForB", "[", 
            RowBox[{"\[Omega]", ",", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], ",", "\[Gamma]"}], 
            "]"}], "2"], 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Theta]", ",", "0", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Phi]", ",", "0", ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dVd\[Omega]Right", "[", 
    RowBox[{"\[Omega]_", ",", 
     RowBox[{"{", 
      RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"\[Omega]", "==", 
      RowBox[{"\[Pi]", "-", 
       RowBox[{"2", 
        RowBox[{"Angle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"\[CapitalLambda]of\[Beta]\[Gamma]", "[", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "\[Gamma]"}], "}"}], "]"}]}], "]"}]}]}]}],
      ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox["\[Omega]", "2"], "]"}], " ", 
       RowBox[{"dVd\[Omega]Right", "[", 
        RowBox[{
         RowBox[{"2.", 
          RowBox[{"ArcSin", "[", 
           RowBox[{
            RowBox[{"Csc", "[", "\[Beta]", "]"}], " ", 
            RowBox[{"Sin", "[", 
             FractionBox["\[Omega]", "2"], "]"}]}], "]"}]}], ",", 
         "\[Gamma]"}], "]"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "\[Beta]", "]"}], "2"], "-", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          FractionBox["\[Omega]", "2"], "]"}], "2"]}]]]}], "]"}]}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"argument", " ", "is", " ", 
     RowBox[{"{", 
      RowBox[{"\[Beta]", ",", "\[Gamma]"}], "}"}], " ", "instead", " ", "of", 
     " ", "\[Gamma]"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6399628005701294`*^9, 3.639962805763427*^9}, {
   3.63996287820357*^9, 3.6399628815637627`*^9}, {3.639965065425672*^9, 
   3.639965068721861*^9}, {3.6400164132978883`*^9, 3.6400164144149523`*^9}, {
   3.640016448134881*^9, 3.640016457794433*^9}, {3.6400165859407625`*^9, 
   3.640016620978767*^9}, {3.640016663787215*^9, 3.640016664774272*^9}, {
   3.640096689417862*^9, 3.6400966932310796`*^9}, {3.6400971665241504`*^9, 
   3.640097224716479*^9}, {3.640101631438527*^9, 3.6401016358547797`*^9}, {
   3.6401017791559763`*^9, 3.640101805341474*^9}, {3.6401018731503525`*^9, 
   3.640101876067519*^9}, {3.640101933583809*^9, 3.6401019395591507`*^9}, {
   3.644018352472784*^9, 3.6440183703228083`*^9}, {3.6440184419429073`*^9, 
   3.64401844368291*^9}, {3.6440187213232927`*^9, 3.6440187602533464`*^9}, 
   3.6440188412334585`*^9, {3.6440189362435894`*^9, 3.6440189367835903`*^9}, {
   3.644019191543942*^9, 3.6440192601540365`*^9}, 3.6440192975940886`*^9, {
   3.644426223072336*^9, 3.644426231372348*^9}, {3.6452802015981293`*^9, 
   3.6452802091007442`*^9}, {3.645376095196983*^9, 3.6453761289349995`*^9}, 
   3.671999361734575*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mesa top.  Takes a while the first time.", "Subsection",
 CellChangeTimes->{{3.639882679779216*^9, 3.6398827108829947`*^9}, {
   3.639882969425782*^9, 3.639882975408125*^9}, {3.639937894220966*^9, 
   3.639937927724882*^9}, {3.6399390927855186`*^9, 3.639939096677741*^9}, {
   3.6399626702436757`*^9, 3.6399626993183384`*^9}, {3.639967514045725*^9, 
   3.6399675160128374`*^9}, {3.6399676503005185`*^9, 3.639967653037675*^9}, {
   3.640016375883748*^9, 3.640016387372405*^9}, {3.6400165428702993`*^9, 
   3.640016545732463*^9}, {3.640037764658033*^9, 3.640037791777584*^9}, {
   3.6401010393516617`*^9, 3.6401010619419537`*^9}, 3.6401020509345207`*^9, {
   3.64598038998852*^9, 3.645980398740135*^9}},
 FontColor->RGBColor[1, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{"VhatByApprox", "[", "\[Omega]_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Vhat0", "[", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "3"}], ",", "0"}], "]"}], "+", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"MesaTop", "[", "\[Omega]dum", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]dum", ",", 
       RowBox[{"\[Pi]", "/", "3"}], " ", ",", "\[Omega]"}], "}"}]}], "]"}], 
   "       ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"\[Pi]", "/", "3"}], " ", "\[LessEqual]", " ", "\[Omega]", " ", 
      "\[LessEqual]", " ", 
      RowBox[{"2", 
       RowBox[{"\[Pi]", "/", "3"}]}]}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.689476085594258*^9, 3.689476249340156*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[Omega]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MesaTop", "[", 
     RowBox[{"\[Omega]_", ",", "yvertex_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"dVd\[Omega]Left", "[", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "3"}], ",", "0"}], "]"}], "-", "yvertex"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Pi]", "/", "6"}], ")"}], "2"]], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Omega]", "-", 
         RowBox[{"\[Pi]", "/", "2"}]}], ")"}], "2"]}], "+", "yvertex"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     StyleBox["preliminary",
      FontColor->RGBColor[1, 0, 0]], " ", 
     StyleBox["parabola",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox["to",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox["fit",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox["mesa",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 0]], 
     StyleBox["top",
      FontColor->RGBColor[1, 0, 0]]}], 
    StyleBox[";",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 0]], 
    StyleBox[
     RowBox[{"it", " ", "goes", " ", "through", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Pi]", "/", "3"}], ",", " ", 
        RowBox[{"dVd\[Omega]Left", "[", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "3"}], ",", "0"}], "]"}]}], ")"}]}],
     FontColor->RGBColor[1, 0, 0]]}], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"yvertex", "=", 
     RowBox[{"yv", "/.", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"MesaTop", "[", 
             RowBox[{"\[Omega]", ",", "yv"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Omega]", ",", 
              RowBox[{"\[Pi]", "/", "3"}], ",", 
              RowBox[{"2", 
               RowBox[{"\[Pi]", "/", "3"}]}]}], "}"}]}], "]"}], "\[Equal]", 
          RowBox[{"1", "-", 
           RowBox[{"2", 
            RowBox[{"Vhat0", "[", 
             RowBox[{
              RowBox[{"\[Pi]", "/", "3"}], ",", "0"}], "]"}]}]}]}], ",", 
         "yv"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "*)"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Make", " ", "active", " ", "if", " ", "want", " ", "MesaTop"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MesaTop", "[", "\[Omega]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"dVd\[Omega]Left", "[", 
        RowBox[{
         RowBox[{"\[Pi]", "/", "3"}], ",", "0"}], "]"}], "-", "yvertex"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Pi]", "/", "6"}], ")"}], "2"]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Omega]", "-", 
        RowBox[{"\[Pi]", "/", "2"}]}], ")"}], "2"]}], "+", "yvertex"}]}], 
  "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"parabola", " ", "to", " ", "fit", " ", "mesa", " ", "top"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MesaTopFor\[Beta]", "[", 
    RowBox[{"\[Omega]_", ",", "\[Beta]_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"Cos", "[", 
      FractionBox["\[Omega]", "2"], "]"}], " ", 
     RowBox[{"MesaTop", "[", 
      RowBox[{"\[Omega]DEV", "[", 
       RowBox[{"\[Omega]", ",", "\[Beta]"}], "]"}], "]"}]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Beta]", "]"}], "2"], "-", " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", 
        FractionBox["\[Omega]", "2"], "]"}], "2"]}]]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Vertex of the parabola is \>\"", ",", "yvertex"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"False", ",", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<MesaTop(\[Omega]) = \>\"", ",", 
       RowBox[{"MesaTop", "[", "\[Omega]", "]"}]}], "]"}]}], "]"}], ";"}], 
  "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Make", " ", "active", " ", "if", " ", "want", " ", "MesaTop"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.642959046427842*^9, 3.6429590487678456`*^9}, {
   3.644121939866205*^9, 3.644121982826265*^9}, 3.6444254364312506`*^9, 
   3.644426259082386*^9, 3.644426324242476*^9, {3.6444265301527605`*^9, 
   3.6444265576127977`*^9}, {3.645230159737426*^9, 3.6452301638924894`*^9}, 
   3.645230214080758*^9, 3.645980297683159*^9, {3.6459803581176643`*^9, 
   3.6459803640456753`*^9}, {3.646454645532797*^9, 3.646454706192881*^9}, {
   3.646454740785429*^9, 3.646454768732968*^9}, 3.646454840150567*^9, 
   3.646488522205331*^9, {3.646489685966937*^9, 3.6464896899269423`*^9}, {
   3.646489913487251*^9, 3.646489919247259*^9}, {3.646489976697338*^9, 
   3.6464899942173624`*^9}, {3.6464900545474453`*^9, 3.646490055597447*^9}, {
   3.6464918740999565`*^9, 3.646491874869958*^9}, {3.6464980334175053`*^9, 
   3.6464980587475405`*^9}, {3.646498312817895*^9, 3.646498349425446*^9}, {
   3.646498456240594*^9, 3.6464984777706237`*^9}, 3.646498572520755*^9, {
   3.6464986385658464`*^9, 3.6464986558258705`*^9}, {3.646498711980948*^9, 
   3.64649877120353*^9}, {3.649002685957435*^9, 3.649002693937446*^9}, {
   3.685501836836397*^9, 3.685501838199706*^9}, {3.6855024578878546`*^9, 
   3.6855024588852034`*^9}, 3.6855026367985163`*^9, {3.6855067868274965`*^9, 
   3.6855068339111004`*^9}, {3.6887849094735208`*^9, 3.688784978342477*^9}, {
   3.6908333968547006`*^9, 3.690833454461633*^9}, {3.6908335495220146`*^9, 
   3.6908335639714327`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Vertex of the parabola is \"\>", "\[InvisibleSpace]", 
   "yvertex"}],
  SequenceForm["Vertex of the parabola is ", $CellContext`yvertex],
  Editable->False]], "Print",
 CellChangeTimes->{3.6855068606988273`*^9, 3.685648737822263*^9, 
  3.690833502087278*^9, 3.6908335708715134`*^9, 3.69548347854256*^9, 
  3.697993082058792*^9, 3.6987677888039055`*^9, 3.6987923075848694`*^9, 
  3.711123998128183*^9, 3.71112872631595*^9, 3.711286627758521*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Log", "[", "2.", "]"}]], "Input",
 CellChangeTimes->{{3.6713844975765567`*^9, 3.67138450042772*^9}}],

Cell[BoxData["0.6931471805599453`"], "Output",
 CellChangeTimes->{3.6713845013847747`*^9, 3.6718109855822845`*^9, 
  3.678824185653227*^9, 3.685648738056661*^9, 3.6908335076000905`*^9, 
  3.6954834785581975`*^9, 3.6979930822617874`*^9, 3.698767788816914*^9, 
  3.698792307603879*^9, 3.711123998163185*^9, 3.711128726332964*^9, 
  3.7112866279964933`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Uniform sphere and circle coordinates  \[Theta], \[Sigma], ",
 StyleBox["z",
  FontSlant->"Italic"],
 "."
}], "Subsection",
 CellChangeTimes->{{3.691349153095139*^9, 3.69134917393433*^9}, {
   3.6913868385928826`*^9, 3.6913868657666025`*^9}, {3.6913871128303947`*^9, 
   3.6913871242062817`*^9}, {3.691439894076238*^9, 3.69143989752937*^9}, 
   3.696094460622557*^9, 3.6960952783897576`*^9, {3.6960953202341743`*^9, 
   3.69609532093388*^9}, 3.6961909025873337`*^9, {3.700533168030202*^9, 
   3.7005331686222243`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UsHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
     RowBox[{
      StyleBox["YRot",
       FontColor->RGBColor[1, 0, 0]], "[", "\[Phi]", "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Sigma]", "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "not", " ", "the", " ", "same", " ", "as", " ", "in", " ", "Section", " ",
      "S4", " ", "of", " ", "Supp", " ", "Info", " ", "for", " ", "TapeTape", 
     " ", "2015"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Us", "[", 
   RowBox[{"{", 
    RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "z_"}], "}"}], "]"}], ":=", 
  RowBox[{"UsHat", "[", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "\[Sigma]", ",", 
     RowBox[{"ArcCos", "[", "z", "]"}]}], "}"}], "]"}]}]}], "Input"]
}, Open  ]]
},
WindowSize->{1305, 1020},
WindowMargins->{{Automatic, 345}, {Automatic, -25}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 331, 7, 33, "Text"],
Cell[879, 29, 303, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[1207, 38, 198, 4, 32, "Input"],
Cell[1408, 44, 1411, 21, 32, "Output"]
}, Open  ]],
Cell[2834, 68, 346, 7, 33, "Text"],
Cell[3183, 77, 81, 2, 32, "Input"],
Cell[3267, 81, 82, 2, 32, "Input"],
Cell[3352, 85, 530, 15, 121, "Input"],
Cell[3885, 102, 418, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[4328, 116, 211, 3, 45, "Subsection"],
Cell[4542, 121, 323, 9, 28, "SmallText",
 Evaluatable->False],
Cell[4868, 132, 1768, 49, 122, "Input"],
Cell[6639, 183, 1595, 40, 110, "Input"]
}, Open  ]],
Cell[8249, 226, 159, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[8433, 232, 418, 7, 30, "Subsection"],
Cell[8854, 241, 5084, 131, 231, "Input"],
Cell[CellGroupData[{
Cell[13963, 376, 1026, 24, 55, "Input"],
Cell[14992, 402, 10912, 187, 173, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25953, 595, 325, 5, 38, "Subsection"],
Cell[26281, 602, 3798, 90, 99, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30116, 697, 158, 2, 45, "Subsection"],
Cell[30277, 701, 7762, 217, 407, "Input"],
Cell[38042, 920, 356, 7, 51, "Text"],
Cell[38401, 929, 12856, 307, 481, "Input"],
Cell[51260, 1238, 5214, 141, 233, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56511, 1384, 135, 1, 45, "Subsection"],
Cell[56649, 1387, 2321, 62, 155, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59007, 1454, 191, 2, 45, "Subsection"],
Cell[59201, 1458, 3359, 99, 228, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62597, 1562, 303, 6, 45, "Subsection"],
Cell[62903, 1570, 2852, 81, 216, "Input"],
Cell[CellGroupData[{
Cell[65780, 1655, 160, 3, 32, "Input"],
Cell[65943, 1660, 606, 10, 54, "Output"]
}, Open  ]],
Cell[66564, 1673, 623, 19, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67224, 1697, 408, 8, 48, "Subsection"],
Cell[67635, 1707, 2646, 72, 132, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70318, 1784, 308, 4, 45, "Subsection"],
Cell[70629, 1790, 3465, 99, 222, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74131, 1894, 388, 7, 45, "Subsection"],
Cell[74522, 1903, 10463, 263, 409, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85022, 2171, 408, 7, 45, "Subsection"],
Cell[85433, 2180, 23591, 502, 787, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109061, 2687, 336, 4, 45, "Subsection"],
Cell[109400, 2693, 569, 19, 66, "Input"]
}, Open  ]],
Cell[109984, 2715, 428, 5, 43, "Subsection"],
Cell[110415, 2722, 542, 7, 35, "Subsection"],
Cell[CellGroupData[{
Cell[110982, 2733, 481, 10, 30, "Subsection"],
Cell[111466, 2745, 6188, 175, 498, "Input"],
Cell[117657, 2922, 8089, 202, 275, "Input"],
Cell[125749, 3126, 2303, 61, 133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128089, 3192, 457, 7, 45, "Subsection"],
Cell[128549, 3201, 2153, 54, 145, "Input"],
Cell[130705, 3257, 20996, 500, 1001, "Input"],
Cell[151704, 3759, 1699, 46, 90, "Input"],
Cell[153406, 3807, 389, 11, 32, "Input"],
Cell[153798, 3820, 1872, 51, 121, "Input"],
Cell[155673, 3873, 2127, 58, 106, "Input"],
Cell[157803, 3933, 8376, 176, 275, "Input"],
Cell[166182, 4111, 703, 15, 53, "Text"],
Cell[166888, 4128, 2253, 62, 99, "Input"],
Cell[169144, 4192, 756, 16, 34, "Text"],
Cell[169903, 4210, 2139, 49, 99, "Input"],
Cell[172045, 4261, 1489, 38, 99, "Input"],
Cell[173537, 4301, 586, 11, 33, "Text"],
Cell[174126, 4314, 2640, 51, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176803, 4370, 586, 10, 38, "Subsection"],
Cell[177392, 4382, 9384, 233, 297, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186813, 4620, 332, 6, 71, "Subsection"],
Cell[187148, 4628, 2690, 74, 125, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189875, 4707, 120, 1, 45, "Subsection"],
Cell[189998, 4710, 14494, 319, 451, "Input"],
Cell[204495, 5031, 472, 10, 33, "Text"],
Cell[204970, 5043, 6092, 136, 363, "Input"],
Cell[211065, 5181, 1881, 45, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212983, 5231, 256, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[213264, 5240, 2562, 65, 143, "Input"],
Cell[215829, 5307, 3245, 78, 80, "Output"]
}, Open  ]],
Cell[219089, 5388, 7440, 194, 224, "Input"],
Cell[CellGroupData[{
Cell[226554, 5586, 2898, 82, 121, "Input"],
Cell[229455, 5670, 310, 4, 32, "Output"],
Cell[229768, 5676, 310, 4, 32, "Output"],
Cell[230081, 5682, 309, 4, 32, "Output"]
}, Open  ]],
Cell[230405, 5689, 937, 20, 31, "Text"],
Cell[231345, 5711, 2640, 74, 111, "Input"],
Cell[233988, 5787, 858, 14, 31, "Text"],
Cell[234849, 5803, 2800, 71, 99, "Input"],
Cell[237652, 5876, 2037, 36, 149, "Text"],
Cell[239692, 5914, 7672, 174, 187, "Input"],
Cell[247367, 6090, 958, 14, 31, "Text"],
Cell[248328, 6106, 4827, 122, 209, "Input"],
Cell[253158, 6230, 940, 15, 31, "Text"],
Cell[254101, 6247, 3739, 91, 189, "Input"],
Cell[CellGroupData[{
Cell[257865, 6342, 6429, 151, 297, "Input"],
Cell[CellGroupData[{
Cell[264319, 6497, 401, 7, 23, "Print"],
Cell[264723, 6506, 403, 7, 23, "Print"],
Cell[265129, 6515, 400, 7, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265590, 6529, 210, 4, 45, "Subsection"],
Cell[265803, 6535, 5541, 155, 280, "Input"],
Cell[271347, 6692, 288, 7, 31, "Text"],
Cell[271638, 6701, 897, 23, 55, "Input"],
Cell[272538, 6726, 284, 9, 31, "Text"],
Cell[272825, 6737, 1451, 46, 243, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274313, 6788, 203, 3, 45, "Subsection"],
Cell[274519, 6793, 3086, 86, 188, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277642, 6884, 208, 3, 45, "Subsection"],
Cell[277853, 6889, 1232, 36, 145, "Input"],
Cell[279088, 6927, 1447, 47, 168, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280572, 6979, 266, 3, 45, "Subsection"],
Cell[280841, 6984, 2778, 66, 129, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283656, 7055, 572, 11, 45, "Subsection"],
Cell[284231, 7068, 854, 17, 32, "Input"],
Cell[285088, 7087, 1088, 31, 58, "Input"],
Cell[286179, 7120, 897, 24, 58, "Input"],
Cell[287079, 7146, 2719, 65, 165, "Input"],
Cell[289801, 7213, 5003, 100, 187, "Input"],
Cell[294807, 7315, 5693, 143, 187, "Input"],
Cell[300503, 7460, 166, 3, 31, "Text"],
Cell[300672, 7465, 4328, 101, 187, "Input"],
Cell[305003, 7568, 212, 4, 31, "Text"],
Cell[305218, 7574, 5413, 136, 341, "Input"],
Cell[310634, 7712, 190, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[310849, 7719, 344, 9, 32, "Input"],
Cell[311196, 7730, 342, 5, 32, "Output"]
}, Open  ]],
Cell[311553, 7738, 5272, 122, 231, "Input"],
Cell[316828, 7862, 3653, 99, 209, "Input"],
Cell[320484, 7963, 3678, 98, 209, "Input"],
Cell[324165, 8063, 246, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[324436, 8072, 231, 7, 32, "Input"],
Cell[324670, 8081, 589, 12, 32, "Output"]
}, Open  ]],
Cell[325274, 8096, 353, 7, 32, "Text"],
Cell[325630, 8105, 4300, 107, 231, "Input"],
Cell[329933, 8214, 313, 7, 32, "Text"],
Cell[330249, 8223, 4548, 114, 231, "Input"],
Cell[334800, 8339, 7607, 177, 275, "Input"],
Cell[CellGroupData[{
Cell[342432, 8520, 977, 20, 37, "Subsubsection"],
Cell[343412, 8542, 1197, 37, 99, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[344658, 8585, 731, 14, 74, "Subsection"],
Cell[345392, 8601, 522, 8, 32, "Text"],
Cell[345917, 8611, 10705, 294, 471, "Input"],
Cell[356625, 8907, 1215, 34, 98, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[357877, 8946, 1032, 18, 74, "Subsection"],
Cell[358912, 8966, 523, 8, 32, "Text"],
Cell[359438, 8976, 15340, 417, 705, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374815, 9398, 738, 10, 45, "Subsection"],
Cell[375556, 9410, 783, 22, 32, "Input"],
Cell[CellGroupData[{
Cell[376364, 9436, 6155, 165, 349, "Input"],
Cell[382522, 9603, 494, 9, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[383053, 9617, 124, 2, 32, "Input"],
Cell[383180, 9621, 354, 5, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[383583, 9632, 536, 11, 45, "Subsection"],
Cell[384122, 9645, 995, 27, 55, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
