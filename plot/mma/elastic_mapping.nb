(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61106,       1489]
NotebookOptionsPosition[     59024,       1424]
NotebookOutlinePosition[     59392,       1440]
CellTagsIndexPosition[     59349,       1437]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Supporting software for W. Tape and C. Tape,
\[OpenCurlyDoubleQuote]Elastic symmetry with beachball pictures\
\[CloseCurlyDoubleQuote] (2021 GJI).
Equation/section/figure numbers are from the paper. 

Evaluate common_funs.nb and then common_MTfuns.nb before running this notebook.
\
\>", "Subsubsection",
 CellChangeTimes->{{3.823395561256716*^9, 3.823395597101345*^9}, 
   3.8233986511201973`*^9, {3.829239841508174*^9, 3.829239887023471*^9}, {
   3.8292401146810503`*^9, 3.829240120992628*^9}}],

Cell[CellGroupData[{

Cell["\<\
The initial elastic mapping example in Section 2.2.2 of the paper\
\>", "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, {3.7860464312100005`*^9, 3.78604646673001*^9}, {
   3.7867559416570377`*^9, 3.786755947977048*^9}, {3.7867622442813787`*^9, 
   3.7867622447933755`*^9}, {3.7875042934553957`*^9, 
   3.7875043187264433`*^9}, {3.8094017037826767`*^9, 3.8094017291427574`*^9}, 
   3.82284475685247*^9, {3.823014467466748*^9, 3.8230144692648273`*^9}, {
   3.8230145172388773`*^9, 3.8230145382989864`*^9}, {3.823395639305503*^9, 
   3.8233956406158333`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmat", "=", 
   RowBox[{
    FractionBox["1", "5"], "\[InvisibleSpace]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"5", "0", "0", 
         RowBox[{"-", "2"}], "0", "0"},
        {"0", "6", "0", "0", 
         RowBox[{"-", "2"}], "0"},
        {"0", "0", "5", "0", "0", "0"},
        {
         RowBox[{"-", "2"}], "0", "0", "5", "0", "0"},
        {"0", 
         RowBox[{"-", "2"}], "0", "0", "6", "0"},
        {"0", "0", "0", "0", "0", "6"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8230142368022685`*^9, 3.823014252527461*^9}, 
   3.82301431802474*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"denominator", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Emat", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0", "0"},
       {"0", "1", "0"},
       {"0", "0", "4"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Eq", " ", 
      RowBox[{
       RowBox[{"(", "22", ")"}], ".", " ", "Or"}], " ", "try", " ", "E"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"BB", "[", "3", "]"}], " ", "or", " ", "try", " ", "your", " ", 
      "own", " ", "E"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<[T\!\(\*SubscriptBox[\(]\), \(\[Placeholder]\)]\) = \>\"", ",", 
     RowBox[{
      FractionBox["1", "denominator"], 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"denominator", " ", "Tmat"}], "]"}], "]"}]}], ",", " ", 
     "\"\<      (Eq (23) in paper)\>\""}], "]"}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<E = \>\"", ",", 
     RowBox[{"MatrixForm", "[", "Emat", "]"}]}], "]"}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<[E\!\(\*SubscriptBox[\"]\", 
StyleBox[\"B\",
FontFamily->\"Courier New\",
FontSize->14]]\) = \>\"", ",", 
    RowBox[{"Simplify", "[", 
     RowBox[{"BBcoords", "[", "Emat", "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<[T(E)\!\(\*SubscriptBox[\"]\", 
StyleBox[\"B\",
FontFamily->\"Courier New\",
FontSize->14]]\) = [T\!\(\*SubscriptBox[\"]\", 
StyleBox[\"BB\",
FontFamily->\"Courier New\",
FontSize->14]]\) [E\!\(\*SubscriptBox[\"]\", 
StyleBox[\"B\",
FontFamily->\"Courier New\",
FontSize->14]]\) = \>\"", ",", 
    FractionBox["1", "denominator"], ",", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      StyleBox["denominator",
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 0]], 
      RowBox[{"Tmat", ".", 
       RowBox[{"BBcoords", "[", "Emat", "]"}]}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<T(E) = \>\"", ",", 
   FractionBox["1", "denominator"], ",", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      StyleBox["denominator",
       FontColor->RGBColor[1, 0, 0]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 0]], 
      RowBox[{"MatrixFromBBcoords", "[", 
       RowBox[{"Tmat", ".", 
        RowBox[{"BBcoords", "[", "Emat", "]"}]}], "]"}]}], "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.784485753063143*^9, 3.784485840109955*^9}, {
   3.784486154112197*^9, 3.7844862106623316`*^9}, {3.7844898567201667`*^9, 
   3.7844898853498583`*^9}, {3.7844902337576303`*^9, 
   3.7844902508229747`*^9}, {3.784492031696679*^9, 3.7844920335560665`*^9}, {
   3.7844922201547365`*^9, 3.7844922258585567`*^9}, {3.7845142014360285`*^9, 
   3.784514202357899*^9}, {3.784568280444154*^9, 3.784568365318034*^9}, {
   3.7845684284506493`*^9, 3.7845685219399557`*^9}, {3.7845685606959763`*^9, 
   3.7845686700376143`*^9}, {3.7845687466302557`*^9, 
   3.7845687991412582`*^9}, {3.784568884734619*^9, 3.7845688889221272`*^9}, 
   3.784568921898036*^9, {3.784569075797982*^9, 3.7845690923645415`*^9}, 
   3.7845691522724695`*^9, {3.784569342992133*^9, 3.7845693497433243`*^9}, {
   3.7845693812319803`*^9, 3.784569497037727*^9}, {3.784569543467268*^9, 
   3.7845695790223246`*^9}, 3.7845696261583643`*^9, {3.7845734464952717`*^9, 
   3.784573462246401*^9}, {3.784573614532589*^9, 3.784573638457378*^9}, {
   3.784573673680604*^9, 3.784573798768009*^9}, {3.7851037041809506`*^9, 
   3.7851037067747154`*^9}, {3.785205149562662*^9, 3.7852051585789146`*^9}, {
   3.786046622301008*^9, 3.7860466300770087`*^9}, {3.7860468646390095`*^9, 
   3.786046869020006*^9}, {3.7867339922297544`*^9, 3.7867339970752096`*^9}, {
   3.786756681449721*^9, 3.786756684056719*^9}, {3.7867584050843906`*^9, 
   3.786758433964387*^9}, {3.78675846548339*^9, 3.78675850330639*^9}, {
   3.78675857645839*^9, 3.7867586252923927`*^9}, {3.7867586718563905`*^9, 
   3.7867586798853893`*^9}, {3.7867587252923746`*^9, 
   3.7867587259163895`*^9}, {3.78675879036539*^9, 3.786758790844387*^9}, {
   3.7867607621453776`*^9, 3.7867607789883785`*^9}, {3.7878668786792374`*^9, 
   3.787866895459239*^9}, {3.7878669845812407`*^9, 3.7878670064672365`*^9}, {
   3.7878670485542374`*^9, 3.787867117461237*^9}, {3.787867191336239*^9, 
   3.787867214886237*^9}, {3.7878672602932425`*^9, 3.787867285957239*^9}, {
   3.7878673266472363`*^9, 3.787867338520237*^9}, {3.7878678027912483`*^9, 
   3.787867886805236*^9}, {3.7878679295872498`*^9, 3.7878679401662416`*^9}, {
   3.7878680027902403`*^9, 3.7878680032372274`*^9}, 3.7890873062299805`*^9, 
   3.7890887743041267`*^9, {3.7920842457092595`*^9, 3.7920842495482607`*^9}, 
   3.795878309394946*^9, {3.7958815851406565`*^9, 3.795881663288494*^9}, 
   3.7967328894879985`*^9, {3.7967331196942024`*^9, 3.7967332645115747`*^9}, {
   3.796733321614849*^9, 3.796733331508827*^9}, {3.796733463703419*^9, 
   3.796733506809387*^9}, {3.796733546338855*^9, 3.7967335481855645`*^9}, {
   3.7967411315295377`*^9, 3.796741152018135*^9}, {3.7967413100390043`*^9, 
   3.7967413236069326`*^9}, {3.7967414675679135`*^9, 3.796741570896435*^9}, {
   3.796741748383411*^9, 3.7967418014435377`*^9}, {3.7967425233962517`*^9, 
   3.7967425544673176`*^9}, {3.796744059510317*^9, 3.7967440889703355`*^9}, {
   3.79674417835292*^9, 3.7967441809329453`*^9}, {3.7967442263185005`*^9, 
   3.796744266423231*^9}, {3.7967443080433235`*^9, 3.796744313878334*^9}, 
   3.796748683349861*^9, {3.7998946390433345`*^9, 3.7998946803173485`*^9}, {
   3.7998953163854017`*^9, 3.7998953193169804`*^9}, {3.7998953833739214`*^9, 
   3.7998953937623262`*^9}, {3.799899003664321*^9, 3.799899006478409*^9}, {
   3.7998990383011265`*^9, 3.7998991446112413`*^9}, 3.7998991869805713`*^9, 
   3.799941901189232*^9, {3.8095329002004156`*^9, 3.8095329306798177`*^9}, {
   3.8095329915357213`*^9, 3.8095330251283274`*^9}, {3.809533061611264*^9, 
   3.809533080521224*^9}, 3.80953319921325*^9, {3.8180958666135044`*^9, 
   3.818095894595036*^9}, {3.818095933388815*^9, 3.8180959347086906`*^9}, {
   3.818096017526526*^9, 3.8180960469387846`*^9}, {3.822843302086482*^9, 
   3.822843351256476*^9}, {3.8228434800874686`*^9, 3.8228435324864855`*^9}, {
   3.8228437891104712`*^9, 3.822843842724476*^9}, {3.822844310886476*^9, 
   3.822844373141479*^9}, {3.822844451190479*^9, 3.8228444778294687`*^9}, {
   3.8228445219744887`*^9, 3.822844587477478*^9}, {3.823014323040011*^9, 
   3.823014329767253*^9}, {3.8230144121705246`*^9, 3.8230144281450987`*^9}, {
   3.829234040415694*^9, 3.829234059604354*^9}, {3.8292341181163692`*^9, 
   3.829234120146386*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "About ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["U", "_"], TraditionalForm]]],
 ".   See Section 3.1.2 of the paper."
}], "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, {3.7860464312100005`*^9, 3.78604646673001*^9}, {
   3.7867559416570377`*^9, 3.786755947977048*^9}, {3.7867622442813787`*^9, 
   3.7867622447933755`*^9}, {3.7875042934553957`*^9, 
   3.7875043187264433`*^9}, {3.8094017037826767`*^9, 3.8094017291427574`*^9}, 
   3.82284475685247*^9, {3.823014467466748*^9, 3.8230144692648273`*^9}, {
   3.8230145172388773`*^9, 3.8230145382989864`*^9}, {3.823014892479615*^9, 
   3.8230149187939796`*^9}, {3.823015050549432*^9, 3.8230150601405535`*^9}, 
   3.82301511153782*^9, {3.8233956522657757`*^9, 3.823395654030527*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[Xi]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"ZRot", "[", "\[Xi]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], "]"}], ",", 
    "\"\<   (This is Eq (60) )\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.823014926786584*^9, 3.8230149956345963`*^9}, {
  3.829234249039051*^9, 3.82923425380811*^9}, {3.829234287968212*^9, 
  3.8292343335214615`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[Xi]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"XRot", "[", "\[Xi]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"MatrixUbar", "[", "U", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{3.8230150923966227`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
The \[CapitalDelta] test (Eqs 70). This example is from Section 3.3.1 of the \
paper.\
\>", "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, {3.7860464312100005`*^9, 3.78604646673001*^9}, {
   3.7867559416570377`*^9, 3.786755947977048*^9}, {3.7867622442813787`*^9, 
   3.7867622447933755`*^9}, {3.7875042934553957`*^9, 
   3.7875043187264433`*^9}, {3.8094017037826767`*^9, 3.8094017291427574`*^9}, 
   3.82284475685247*^9, {3.822844787380469*^9, 3.822844794563491*^9}, {
   3.8228450171084843`*^9, 3.8228450531234703`*^9}, {3.8228450944994974`*^9, 
   3.8228451039394865`*^9}, {3.8233948966480465`*^9, 3.823394898313395*^9}, {
   3.8233950350061164`*^9, 3.823395041419774*^9}, {3.8292343981992855`*^9, 
   3.8292344055372133`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateSequence", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "l", ",", "m", ",", "n", ",", "o", ",",
     "p", ",", "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tmat6x6", "=", 
   TagBox["TmatBlankSlate",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{"ZRot", "[", "\[Pi]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"denominator", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PrintForSymmetryTest", "[", 
  RowBox[{"Tmat6x6", ",", "V", ",", "denominator"}], "]"}]}], "Input",
 CellChangeTimes->{{3.794496336052377*^9, 3.794496337130516*^9}, {
   3.794496495473708*^9, 3.7944964957705827`*^9}, {3.794685539009474*^9, 
   3.794685606795473*^9}, 3.795970032747416*^9}],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Tmat6x6", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"h", "\[Rule]", "0"}], ",", 
     RowBox[{"m", "\[Rule]", "0"}], ",", 
     RowBox[{"n", "\[Rule]", "0"}], ",", 
     RowBox[{"q", "\[Rule]", "0"}], ",", 
     RowBox[{"r", "\[Rule]", "0"}], ",", 
     RowBox[{"t", "\[Rule]", "0"}], ",", 
     RowBox[{"u", "\[Rule]", "0"}], ",", 
     RowBox[{"v", "\[Rule]", "0"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "\[Equal]", "TmatFor180"}]}], "Input",
 CellChangeTimes->{{3.794496446748575*^9, 3.7944964486235247`*^9}, 
   3.7944965063497715`*^9, 3.7946856336454735`*^9, 3.795369932514472*^9, {
   3.795970058313076*^9, 3.7959700650480337`*^9}, 3.7959792140328116`*^9, {
   3.7966662736732845`*^9, 3.7966662944654074`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
T with prescribed eigensystem.  The eigenvectors should be orthonormal. See \
Section 2.8 of the paper.\
\>", "Subsubsection",
 CellChangeTimes->{{3.784485966855825*^9, 3.7844860394164658`*^9}, {
   3.784486274471085*^9, 3.7844862754085846`*^9}, {3.7844900486130314`*^9, 
   3.784490053691377*^9}, {3.784490156711029*^9, 3.7844901920340133`*^9}, 
   3.784490283004094*^9, {3.7860464312100005`*^9, 3.78604646673001*^9}, {
   3.7867559416570377`*^9, 3.786755947977048*^9}, {3.7867622442813787`*^9, 
   3.7867622447933755`*^9}, {3.7875042934553957`*^9, 
   3.7875043187264433`*^9}, {3.8094017037826767`*^9, 3.8094017291427574`*^9}, 
   3.82284475685247*^9, {3.822844787380469*^9, 3.822844794563491*^9}, {
   3.8228461638285213`*^9, 3.8228461758905115`*^9}, {3.822846211524518*^9, 
   3.822846252483514*^9}, {3.823394965022081*^9, 3.823394976428315*^9}, {
   3.8233950499651346`*^9, 3.823395053223665*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basis", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BB", "[", "1", "]"}], ",", 
     RowBox[{"BB", "[", "2", "]"}], ",", 
     RowBox[{"BB", "[", "3", "]"}], ",", 
     RowBox[{"BB", "[", "4", "]"}], ",", 
     RowBox[{"B56", "[", "t", "]"}], ",", 
     RowBox[{"B56", "[", 
      RowBox[{"t", "+", 
       RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.822846256683519*^9, 3.8228463341485066`*^9}, {
  3.8228464257155156`*^9, 3.8228464266435146`*^9}, {3.822846632228514*^9, 
  3.822846654676524*^9}}],

Cell["Check the basis is orthonormal", "Text",
 CellChangeTimes->{{3.8228463392855377`*^9, 3.822846354996504*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"InnerProductMatrix", "[", 
      RowBox[{
       RowBox[{"basis", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"basis", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.822846359557508*^9, 3.822846415044502*^9}, {
  3.8228464471575108`*^9, 3.8228464528845143`*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "/@", 
  RowBox[{"Simplify", "[", "basis", "]"}]}]], "Input",
 CellChangeTimes->{{3.8228470525065203`*^9, 3.8228470595565157`*^9}, {
  3.8228470959885154`*^9, 3.8228471015095043`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[Lambda]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", "1", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", "2", "]"}], "=", "3"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", "3", "]"}], "=", "5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", "4", "]"}], "=", "2"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", "5", "]"}], "=", "4"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", "6", "]"}], "=", "6"}], ";"}]}], "Input",
 CellChangeTimes->{{3.823013308163568*^9, 3.823013354928096*^9}, {
   3.8230134095325813`*^9, 3.823013431138136*^9}, {3.823013515169823*^9, 
   3.8230136179362917`*^9}, {3.8230137287214847`*^9, 3.8230137387805943`*^9}, 
   3.8233956847858653`*^9, 3.829234515009821*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "1", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "2", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "3", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "4", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "5", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "6", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.8230137476407347`*^9, 3.823013780867922*^9}}],

Cell["\<\
The command for TmatFromEigensystem is in the file AAcommonMomentTensorFns.  \
It is Eq (49) of the paper.\
\>", "Text",
 CellChangeTimes->{{3.8292346041714334`*^9, 3.8292346225105963`*^9}, {
  3.829234812657359*^9, 3.829234822091813*^9}, {3.829234853521439*^9, 
  3.8292348683758945`*^9}, {3.829235306796377*^9, 3.8292353141723366`*^9}},
 FontColor->GrayLevel[0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tmat", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"TmatFromEigensystem", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", "1", "]"}], ",", 
        RowBox[{"\[Lambda]", "[", "2", "]"}], ",", 
        RowBox[{"\[Lambda]", "[", "3", "]"}], ",", 
        RowBox[{"\[Lambda]", "[", "4", "]"}], ",", 
        RowBox[{"\[Lambda]", "[", "5", "]"}], ",", 
        RowBox[{"\[Lambda]", "[", "6", "]"}]}], "}"}], ",", "basis"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Tmat", "]"}]}], "Input",
 CellChangeTimes->{{3.822846471232504*^9, 3.822846473347515*^9}, {
   3.8228465073965254`*^9, 3.822846558692506*^9}, {3.822846594981526*^9, 
   3.82284661280352*^9}, {3.823013369169202*^9, 3.823013390656735*^9}, {
   3.8230136399337244`*^9, 3.8230136417931337`*^9}, 3.82301368535804*^9, 
   3.8230137941149178`*^9}],

Cell["Check the eigensystem", "Text",
 CellChangeTimes->{{3.823013123775267*^9, 3.8230131442817554`*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"Tmat", ".", 
      RowBox[{"BBcoords", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "\[Equal]", 
     RowBox[{
      RowBox[{"\[Lambda]", "[", "i", "]"}], " ", 
      RowBox[{"BBcoords", "[", 
       RowBox[{"basis", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.823013161169394*^9, 3.8230132417726574`*^9}, {
  3.8230136564898615`*^9, 3.8230136592947097`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Related to Section 15.2, but not the same T\[CloseCurlyQuote].   
This illustrates the best situation: all eigenvalues of T\[CloseCurlyQuote] \
are simple.\
\>", "Subsubsection",
 CellChangeTimes->{{3.8073040598693795`*^9, 3.8073040783263817`*^9}, {
  3.8074582942787724`*^9, 3.8074583087338605`*^9}, {3.8076345900081215`*^9, 
  3.8076345929680567`*^9}, {3.8083201202076893`*^9, 3.8083201211666584`*^9}, {
  3.822961142968864*^9, 3.822961164953*^9}, {3.8230074006439915`*^9, 
  3.8230074253969574`*^9}, {3.823011254323928*^9, 3.823011284465339*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Brick", "=", 
   RowBox[{
    FractionBox["1", "3"], 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "2"}], ",", "0"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "2"}], ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", "3"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}]}], "}"}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"Polygon", "/@", "Brick"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "75"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.810067997885927*^9, 3.8100679993177547`*^9}, {
  3.8100680572112947`*^9, 3.810068151770524*^9}, {3.8100681872078514`*^9, 
  3.8100682353231993`*^9}, {3.8100682743726597`*^9, 3.810068425278842*^9}, {
  3.8100687139798713`*^9, 3.8100687211328897`*^9}, {3.8229628079934835`*^9, 
  3.8229628090520535`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateSequence", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tprime", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"10", " ", "21", " ", "8", 
      SqrtBox["6"]}]], "\[InvisibleSpace]", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{
           RowBox[{"-", "240"}], " ", 
           SqrtBox["2"]}], "+", 
          RowBox[{"6202", " ", 
           SqrtBox["6"]}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "240"}], " ", 
           SqrtBox["2"]}], "+", 
          RowBox[{"2842", " ", 
           SqrtBox["6"]}]}], 
         RowBox[{"240", "+", 
          RowBox[{"954", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{
          RowBox[{"-", "1680"}], " ", 
          SqrtBox["3"]}], 
         RowBox[{
          RowBox[{"-", "954"}], "-", 
          RowBox[{"80", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{"960", "-", 
          RowBox[{"416", " ", 
           SqrtBox["3"]}]}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"-", "240"}], " ", 
           SqrtBox["2"]}], "+", 
          RowBox[{"2842", " ", 
           SqrtBox["6"]}]}], 
         RowBox[{
          RowBox[{
           RowBox[{"-", "240"}], " ", 
           SqrtBox["2"]}], "+", 
          RowBox[{"6202", " ", 
           SqrtBox["6"]}]}], 
         RowBox[{"240", "+", 
          RowBox[{"954", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{"1680", " ", 
          SqrtBox["3"]}], 
         RowBox[{
          RowBox[{"-", "954"}], "-", 
          RowBox[{"80", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{"960", "-", 
          RowBox[{"416", " ", 
           SqrtBox["3"]}]}]},
        {
         RowBox[{"240", "+", 
          RowBox[{"954", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{"240", "+", 
          RowBox[{"954", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{"9", " ", 
          SqrtBox["2"], " ", 
          RowBox[{"(", 
           RowBox[{"40", "+", 
            RowBox[{"741", " ", 
             SqrtBox["3"]}]}], ")"}]}], "0", 
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          SqrtBox["2"], " ", 
          RowBox[{"(", 
           RowBox[{"1103", "+", 
            RowBox[{"40", " ", 
             SqrtBox["3"]}]}], ")"}]}], 
         RowBox[{"48", " ", 
          SqrtBox["2"], " ", 
          RowBox[{"(", 
           RowBox[{"10", "+", 
            RowBox[{"13", " ", 
             SqrtBox["3"]}]}], ")"}]}]},
        {
         RowBox[{
          RowBox[{"-", "1680"}], " ", 
          SqrtBox["3"]}], 
         RowBox[{"1680", " ", 
          SqrtBox["3"]}], "0", 
         RowBox[{"3360", " ", 
          SqrtBox["6"]}], "0", "0"},
        {
         RowBox[{
          RowBox[{"-", "954"}], "-", 
          RowBox[{"80", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{
          RowBox[{"-", "954"}], "-", 
          RowBox[{"80", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          SqrtBox["2"], " ", 
          RowBox[{"(", 
           RowBox[{"1103", "+", 
            RowBox[{"40", " ", 
             SqrtBox["3"]}]}], ")"}]}], "0", 
         RowBox[{
          SqrtBox["6"], " ", 
          RowBox[{"(", 
           RowBox[{"4463", "+", 
            RowBox[{"40", " ", 
             SqrtBox["3"]}]}], ")"}]}], 
         RowBox[{
          RowBox[{"-", "16"}], " ", 
          SqrtBox["6"], " ", 
          RowBox[{"(", 
           RowBox[{"10", "+", 
            RowBox[{"13", " ", 
             SqrtBox["3"]}]}], ")"}]}]},
        {
         RowBox[{"960", "-", 
          RowBox[{"416", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{"960", "-", 
          RowBox[{"416", " ", 
           SqrtBox["3"]}]}], 
         RowBox[{"48", " ", 
          SqrtBox["2"], " ", 
          RowBox[{"(", 
           RowBox[{"10", "+", 
            RowBox[{"13", " ", 
             SqrtBox["3"]}]}], ")"}]}], "0", 
         RowBox[{
          RowBox[{"-", "16"}], " ", 
          SqrtBox["6"], " ", 
          RowBox[{"(", 
           RowBox[{"10", "+", 
            RowBox[{"13", " ", 
             SqrtBox["3"]}]}], ")"}]}], 
         RowBox[{"8384", " ", 
          SqrtBox["6"]}]}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.807294627364176*^9, 3.807294659685252*^9}, {
   3.8072946935891914`*^9, 3.8072947125645723`*^9}, {3.807294888980212*^9, 
   3.8072949431242156`*^9}, {3.8072949807102246`*^9, 
   3.8072950153812375`*^9}, {3.80729522527026*^9, 3.8072952275742536`*^9}, {
   3.807295522933383*^9, 3.80729557061348*^9}, {3.807295606309292*^9, 
   3.8072957664207563`*^9}, {3.8072958434293346`*^9, 
   3.8072958674133396`*^9}, {3.8072965950934277`*^9, 
   3.8072966258284297`*^9}, {3.8073028929812393`*^9, 3.807302906069646*^9}, {
   3.807303309701493*^9, 3.8073033102292814`*^9}, {3.8073166757629285`*^9, 
   3.8073167508349752`*^9}, 3.807316906899001*^9, 3.8073169588506436`*^9, {
   3.8074586555989037`*^9, 3.807458657549905*^9}, 3.8074608015201783`*^9, 
   3.807474151374172*^9, {3.807474200782173*^9, 3.807474204509717*^9}, {
   3.8074746017422295`*^9, 3.80747466530933*^9}, {3.8074891549305115`*^9, 
   3.807489191138516*^9}, {3.807489265585533*^9, 3.807489292738545*^9}, {
   3.807489455090559*^9, 3.8074894653475504`*^9}, {3.8074953961463118`*^9, 
   3.807495436146309*^9}, 3.8074955023893213`*^9, {3.8075784322453647`*^9, 
   3.8075784335394025`*^9}, {3.807578554259433*^9, 3.8075785555634303`*^9}, 
   3.8076315716247635`*^9, {3.8076316219607553`*^9, 3.807631638824798*^9}, {
   3.807981850455555*^9, 3.807981904168573*^9}, {3.8080729934204173`*^9, 
   3.8080730251337337`*^9}, 3.808073081183818*^9, {3.808074164348347*^9, 
   3.8080741838720555`*^9}, 3.808074324401079*^9, {3.808079755652086*^9, 
   3.80807975905783*^9}, {3.8080814211211996`*^9, 3.808081430868058*^9}, {
   3.8194909103026648`*^9, 3.819490911351345*^9}, {3.822958221120061*^9, 
   3.822958235977527*^9}, {3.8229583393734236`*^9, 3.822958340618572*^9}, 
   3.8229584283587265`*^9, 3.8229585007022457`*^9, {3.822961229888426*^9, 
   3.8229612530184956`*^9}, {3.8229612883326287`*^9, 3.822961289066498*^9}, 
   3.823007585085351*^9, {3.8230076263696766`*^9, 3.8230076415712795`*^9}, 
   3.823007746360772*^9}],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Eigensystem", "[", "Tprime", "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Eigenvectors", "[", "Tprime", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", 
      RowBox[{
       RowBox[{"Eigenvectors", "[", "Tprime", "]"}], "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.822961300547866*^9, 3.8229613437282515`*^9}, {
   3.8229615250731087`*^9, 3.822961600557742*^9}, {3.8229618121891155`*^9, 
   3.822961884678092*^9}, {3.823007890334978*^9, 3.8230078917249875`*^9}, {
   3.823007967132121*^9, 3.823007994051975*^9}, {3.8230109791469245`*^9, 
   3.823010980585225*^9}, 3.823011211786265*^9}],

Cell["\<\
So the eigenvectors are mutually orthogonal, as guaranteed by the simplicity \
of the eigenvalues, but they are not unit vectors. So next we normalize them.\
\>", "Text",
 CellChangeTimes->{{3.823011313104916*^9, 3.8230113906961527`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"basisR6", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Unit", "/@", 
     RowBox[{"Eigenvectors", "[", "Tprime", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"basisR6", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", 
      RowBox[{"basisR6", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "6"}], "}"}]}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8229619494525595`*^9, 3.8229621617410746`*^9}, {
   3.8229621963950872`*^9, 3.822962261455655*^9}, {3.822962361451762*^9, 
   3.8229624148270125`*^9}, 3.8230081280953646`*^9, {3.8230081617811832`*^9, 
   3.823008193775448*^9}, {3.823008234958743*^9, 3.8230082653574133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"basisG", "=", 
    RowBox[{"Reverse", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"MatrixFromBBcoords", "/@", "basisR6"}], "]"}], "]"}]}], ";"}], 
  "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Reverse", " ", "to", " ", "more", " ", "closely", " ", "resemble", " ", 
     "the", " ", "basis", " ", "in", " ", "the", " ", "paper"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.822962575644108*^9, 3.8229626100084825`*^9}, {
  3.8229657222669616`*^9, 3.8229657630046663`*^9}, {3.8230082501880956`*^9, 
  3.823008256352086*^9}, {3.8230100933407063`*^9, 3.8230100946889777`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\[Lambda]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Eigenvalues", "[", "Tprime", "]"}], ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"7", "-", "i"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "[", "1", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "2", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "3", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "4", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "5", "]"}], ",", 
   RowBox[{"\[Lambda]", "[", "6", "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.823008348666588*^9, 3.8230084161742425`*^9}, {
  3.823008473302416*^9, 3.823008507185335*^9}}],

Cell["Make sure we still have an  eigensystem for Tprime :", "Text",
 CellChangeTimes->{{3.823009967025115*^9, 3.823010016929533*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"(", 
    RowBox[{"Tprime", "-", 
     RowBox[{"TmatFromEigensystem", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Lambda]", "[", "1", "]"}], ",", 
         RowBox[{"\[Lambda]", "[", "2", "]"}], ",", 
         RowBox[{"\[Lambda]", "[", "3", "]"}], ",", 
         RowBox[{"\[Lambda]", "[", "4", "]"}], ",", 
         RowBox[{"\[Lambda]", "[", "5", "]"}], ",", 
         RowBox[{"\[Lambda]", "[", "6", "]"}]}], "}"}], ",", "basisG"}], 
      "]"}]}], ")"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.823009873248485*^9, 3.8230098826256504`*^9}, {
  3.8230099168043766`*^9, 3.8230099183215528`*^9}}],

Cell[BoxData[
 RowBox[{"ColumnForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{"1.", 
    RowBox[{"Eigenvalues", "/@", "basisG"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8229647480187416`*^9, 3.822964800748062*^9}, {
  3.822964902171858*^9, 3.822964908606139*^9}, {3.823010767485213*^9, 
  3.823010767850778*^9}}],

Cell["So the last three basisG members are generic. :", "Text",
 CellChangeTimes->{{3.823009967025115*^9, 3.823010016929533*^9}, {
  3.823011466609136*^9, 3.8230114995845547`*^9}}],

Cell["Uraw[E] is an eigenframe for E. :", "Text",
 CellChangeTimes->{{3.823009967025115*^9, 3.823010016929533*^9}, {
  3.823011528688262*^9, 3.823011549857715*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Uraw", "[", 
      RowBox[{"basisG", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Pi]", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<U = \!\(\*FractionBox[\(\(\\\ \)\(1\)\), \(2\)]\)\>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{
      StyleBox["2",
       FontColor->RGBColor[1, 0, 0]], "U"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.822964997673439*^9, 3.822965061466833*^9}, {
   3.8229651223948917`*^9, 3.822965140408601*^9}, 3.822965180319008*^9, {
   3.822965223625512*^9, 3.822965224926464*^9}, 3.8229652654650793`*^9, {
   3.8229653019666348`*^9, 3.822965346352335*^9}, 3.822965792320917*^9, {
   3.8230069812570815`*^9, 3.8230070076612835`*^9}, {3.8230100562248244`*^9, 
   3.823010061023743*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateSequence", "[", 
    RowBox[{
     RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tkns", "=", ".0045"}], ";", 
  RowBox[{"BBrad", "=", ".32"}], ";", 
  RowBox[{"BBrad", "=", ".37"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrowScale", "=", ".12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eye", "=", 
    RowBox[{"30", 
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{"25", ",", "65"}], "}"}], "]"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"xyztp", "[", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}], "]"}], " ", "is", " ", 
     "point", " ", "on", " ", "unit", " ", "sphere", " ", "with", " ", 
     "spherical", " ", "coordinates", " ", "\[Theta]", " ", "and", " ", 
     RowBox[{"(", "colatitude", ")"}], " ", "\[Phi]"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\[Epsilon]In", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]In", "[", "dum_", "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]In", "  ", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
    ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strain", "=", 
   RowBox[{"1.", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PerturbMatrix", "[", 
       RowBox[{
        RowBox[{
         StyleBox["basisG",
          FontColor->RGBColor[1, 0, 0]], "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"\[Epsilon]In", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "6"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PrintEye", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<BBrad = \>\"", ",", "BBrad"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Epsilon]In", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0."}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<strain \>\"", ",", "i", ",", "\"\< is \!\(\*
StyleBox[\"perturbed\",
FontColor->RGBColor[1, 0, 0]]\),   \[CapitalLambda] + \[Epsilon](1,1,1) = \
\>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"PaddedForm", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "3"}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[CapitalLambda]ofMnotNormalized", "[", 
             RowBox[{
              StyleBox["basisG",
               FontColor->RGBColor[1, 0, 0]], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"\[Epsilon]In", "[", 
              RowBox[{"[", "i", "]"}], "]"}], 
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]}], ")"}]}], ",", 
         "\"\<,   \[Epsilon]In  = \>\"", ",", 
         RowBox[{"\[Epsilon]In", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"GrayLevel", "[", ".9", "]"}], ",", 
       RowBox[{"EdgeForm", "[", 
        RowBox[{"Thickness", "[", 
         RowBox[{".4", "tkns"}], "]"}], "]"}], ",", "  ", 
       RowBox[{"(*", " ", 
        StyleBox["brick",
         FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Polygon", "/@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "4.7", ",", 
              RowBox[{"3.", "BBrad"}]}], "}"}], "+", 
            RowBox[{"1.2", "BBrad", " ", 
             RowBox[{"U", ".", "#"}]}]}], " ", "&"}], ",", "Brick", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Paxes", "[", 
        RowBox[{"True", ",", "True", ",", "True", ",", "U", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "#", ",", "0"}], "}"}], ",", 
         RowBox[{"1.75", "BBrad"}], ",", "BBrad", ",", "ArrowScale", ",", 
         RowBox[{".7", "tkns"}], ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
        "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Paxes", "[", 
      RowBox[{"True", ",", "True", ",", "True", ",", "id", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", ".4"}], "BBrad"}], ",", "0"}], "}"}], ",", 
       RowBox[{"1.3", "BBrad"}], ",", "0", ",", "ArrowScale", ",", 
       RowBox[{".8", "tkns"}], ",", "\"\<Gray\>\"", ",", "ArrowColor"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"BeachballForM", "[", 
        RowBox[{
         RowBox[{"1.", 
          RowBox[{"strain", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "#", ",", "0"}], " ", "}"}], ",", "BBrad"}], 
        "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", "6", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"True", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"RowBox", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Lambda]\>\"", ",", "#", ",", "\"\<=\>\"", ",", 
                 RowBox[{"\[Lambda]", "[", "#", "]"}]}], "}"}], "]"}], "//", 
              "DisplayForm"}], ",", "14"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "#", ",", 
             RowBox[{"-", ".8"}]}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", "6", "]"}]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "750"}], ",", 
   RowBox[{"ViewPoint", "\[Rule]", "eye"}], ",", 
   RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7969274333805156`*^9, 3.7969274562265167`*^9}, {
   3.796927554947516*^9, 3.796927586531513*^9}, {3.796927634531516*^9, 
   3.7969276352025166`*^9}, {3.7969276733315163`*^9, 
   3.7969276744375167`*^9}, {3.796927839283513*^9, 3.7969278689635167`*^9}, {
   3.796927905797516*^9, 3.796927907058516*^9}, {3.796927937139516*^9, 
   3.7969279380685167`*^9}, {3.7969281954915133`*^9, 
   3.7969282752035165`*^9}, {3.796929334882516*^9, 3.796929648130517*^9}, 
   3.7969296905465207`*^9, {3.7969297650895157`*^9, 3.7969297687055163`*^9}, {
   3.7969298371575165`*^9, 3.7969298447235146`*^9}, {3.7969298900365157`*^9, 
   3.7969298941155167`*^9}, {3.796930077922512*^9, 3.7969301476195135`*^9}, {
   3.7969302244195166`*^9, 3.796930225907516*^9}, {3.7969302595055165`*^9, 
   3.796930270914513*^9}, {3.7969305518925123`*^9, 3.796930577746503*^9}, {
   3.796930630082515*^9, 3.796930635074515*^9}, {3.7969307215165176`*^9, 
   3.796930730498513*^9}, {3.7969307879545135`*^9, 3.796930802610513*^9}, {
   3.796930901667513*^9, 3.7969309118275137`*^9}, 3.796930955828515*^9, {
   3.7969310021635156`*^9, 3.7969310274895134`*^9}, {3.796931085092515*^9, 
   3.796931130835518*^9}, {3.7969311684025016`*^9, 3.796931211123516*^9}, {
   3.7969312528205166`*^9, 3.796931278979517*^9}, {3.796931359446516*^9, 
   3.7969314035855165`*^9}, {3.796931438322513*^9, 3.7969314758105135`*^9}, {
   3.796931505842513*^9, 3.796931521058514*^9}, {3.796931586082526*^9, 
   3.7969316728345156`*^9}, 3.7969317426435165`*^9, {3.7969318017615137`*^9, 
   3.796931819203512*^9}, {3.796931858450514*^9, 3.796931867969513*^9}, 
   3.796931921154513*^9, {3.796931958498516*^9, 3.7969319794755154`*^9}, {
   3.7969324348827324`*^9, 3.796932480994732*^9}, {3.7969325157157326`*^9, 
   3.7969325169307323`*^9}, {3.7969325644987307`*^9, 
   3.7969325655057316`*^9}, {3.7969464152379255`*^9, 
   3.7969464425789285`*^9}, {3.796946532608921*^9, 3.796946536611924*^9}, {
   3.7969466863399286`*^9, 3.796946687378925*^9}, {3.796946720532928*^9, 
   3.796946772003928*^9}, 3.796946825476929*^9, {3.797435168766218*^9, 
   3.7974351824292183`*^9}, {3.797435213757218*^9, 3.7974352150362186`*^9}, 
   3.7988973410163975`*^9, {3.79928856890521*^9, 3.7992885754482117`*^9}, {
   3.79928877961421*^9, 3.799288792651216*^9}, {3.799338334817196*^9, 
   3.799338360480103*^9}, {3.7993450671857667`*^9, 3.7993450696514482`*^9}, {
   3.799345102420951*^9, 3.799345105875202*^9}, {3.79935597889826*^9, 
   3.7993559796805515`*^9}, 3.800024267663624*^9, 3.8000243426902676`*^9, 
   3.800024392687096*^9, {3.8000244487807546`*^9, 3.8000244503431644`*^9}, {
   3.800024495470907*^9, 3.800024497662554*^9}, {3.807112054076541*^9, 
   3.8071120597071*^9}, {3.8071121146092744`*^9, 3.8071121179628825`*^9}, {
   3.8071121539462805`*^9, 3.8071121949702826`*^9}, {3.807112246314292*^9, 
   3.807112250842292*^9}, 3.807112298074297*^9, {3.8071126298526497`*^9, 
   3.807112632218341*^9}, {3.807112683070348*^9, 3.807112731819351*^9}, 
   3.8071128239003654`*^9, {3.8071129111953745`*^9, 3.807112914555373*^9}, {
   3.807112948555382*^9, 3.8071130110033884`*^9}, {3.8071130998513966`*^9, 
   3.80711313025139*^9}, {3.807113214907354*^9, 3.8071132426354055`*^9}, {
   3.8071167973738346`*^9, 3.807116922811885*^9}, {3.8071169751168914`*^9, 
   3.8071169771151543`*^9}, {3.807117019658895*^9, 3.807117024874857*^9}, {
   3.8071171334039125`*^9, 3.8071171382669134`*^9}, {3.8071172042679234`*^9, 
   3.8071173071969337`*^9}, {3.807117358363945*^9, 3.807117372652853*^9}, 
   3.807117537964364*^9, {3.807117797627757*^9, 3.807117804346994*^9}, {
   3.807117867804006*^9, 3.807117948237008*^9}, {3.8071180350680275`*^9, 
   3.8071182069080496`*^9}, {3.8071183586230764`*^9, 3.80711837993307*^9}, {
   3.807118440590076*^9, 3.8071184427960796`*^9}, {3.807118473468082*^9, 
   3.80711847460509*^9}, {3.807118507175051*^9, 3.8071185116120405`*^9}, {
   3.8071185437244244`*^9, 3.8071185446200914`*^9}, {3.8071187052601633`*^9, 
   3.8071187381722927`*^9}, {3.8071187944931183`*^9, 3.807118883437133*^9}, {
   3.8071189351801414`*^9, 3.807119097565923*^9}, {3.8071191446591277`*^9, 
   3.8071191466691637`*^9}, {3.807119235279179*^9, 3.8071192875631866`*^9}, {
   3.8071193261561856`*^9, 3.80711935681219*^9}, {3.807119426606067*^9, 
   3.807119427228035*^9}, 3.8071195223512154`*^9, {3.8071195588432093`*^9, 
   3.807119580460888*^9}, {3.8072836125206056`*^9, 3.807283616646721*^9}, {
   3.807285587286028*^9, 3.8072856044280205`*^9}, {3.8072873974462643`*^9, 
   3.807287474260274*^9}, 3.8072877956843147`*^9, {3.807295940549728*^9, 
   3.8072959549989257`*^9}, {3.8072961752713614`*^9, 
   3.8072961834453735`*^9}, {3.807296837558463*^9, 3.8072968387417884`*^9}, {
   3.8072968979574704`*^9, 3.807296901270471*^9}, 3.8072969883741817`*^9, {
   3.807297093862445*^9, 3.807297155382552*^9}, {3.8072973552564983`*^9, 
   3.807297360712685*^9}, 3.807297429958456*^9, {3.8073019571259003`*^9, 
   3.8073020319591217`*^9}, {3.807302070121122*^9, 3.807302141511119*^9}, 
   3.8073021795111327`*^9, {3.8073022242640967`*^9, 3.8073022473501434`*^9}, {
   3.8073024429351683`*^9, 3.8073024761671786`*^9}, {3.8073025092378073`*^9, 
   3.8073025169827023`*^9}, 3.807302560423189*^9, {3.807302621926191*^9, 
   3.807302653046245*^9}, {3.807302688359212*^9, 3.8073027171432123`*^9}, {
   3.807303050265252*^9, 3.807303056952253*^9}, {3.8073031504892535`*^9, 
   3.807303151863219*^9}, 3.807303631143907*^9, {3.807303685591569*^9, 
   3.807303686039333*^9}, {3.80745896697795*^9, 3.8074589687687826`*^9}, {
   3.8074590174080195`*^9, 3.8074590181429057`*^9}, 3.807459088495959*^9, {
   3.8074592265609293`*^9, 3.807459238094984*^9}, {3.807459445890008*^9, 
   3.807459455055092*^9}, {3.8074595153600163`*^9, 3.8074595176797647`*^9}, 
   3.8074598648323865`*^9, {3.807460478351138*^9, 3.807460525776148*^9}, {
   3.807460557121152*^9, 3.807460599872151*^9}, 3.8074733639530725`*^9, {
   3.80747434756719*^9, 3.8074743877898426`*^9}, 3.807474425055153*^9, {
   3.8074744848472157`*^9, 3.807474487950198*^9}, {3.8074745422882223`*^9, 
   3.807474545758216*^9}, {3.807489794356428*^9, 3.807489805682601*^9}, {
   3.807489943092615*^9, 3.807489949923619*^9}, {3.807490374643673*^9, 
   3.80749037552367*^9}, 3.8074956049503155`*^9, {3.8074961728990726`*^9, 
   3.807496216563851*^9}, 3.8076317830657654`*^9, 3.8076318134177237`*^9, {
   3.8080737606426997`*^9, 3.808073761567956*^9}, {3.8080738047997866`*^9, 
   3.8080738098070197`*^9}, {3.8080739090570097`*^9, 3.808073950721032*^9}, {
   3.8080741418730426`*^9, 3.808074142400058*^9}, 3.808079770067853*^9, {
   3.8100684850886316`*^9, 3.810068494484562*^9}, {3.8100685568612986`*^9, 
   3.8100685589089932`*^9}, 3.8100686737650633`*^9, {3.810068801319958*^9, 
   3.810068815421748*^9}, {3.8100688500456567`*^9, 3.810068861916179*^9}, 
   3.8100689372942176`*^9, {3.821724134866809*^9, 3.8217241926532297`*^9}, 
   3.8217243563656254`*^9, {3.822958454776561*^9, 3.8229584572445116`*^9}, {
   3.8229605927938457`*^9, 3.822960610032318*^9}, {3.8229606533903956`*^9, 
   3.822960657504648*^9}, 3.8229607133269515`*^9, {3.822962691123048*^9, 
   3.822962723361151*^9}, 3.8229628575630913`*^9, {3.823007019515934*^9, 
   3.823007021198948*^9}, {3.8230102464173603`*^9, 3.8230104109931917`*^9}, 
   3.8230104446054316`*^9, {3.823010485612785*^9, 3.8230104893618374`*^9}, {
   3.8230105426004744`*^9, 3.8230105961755347`*^9}, {3.823010627120715*^9, 
   3.8230106422566233`*^9}, {3.823010688038495*^9, 3.8230106961002293`*^9}, {
   3.8230128767070484`*^9, 3.8230128984201007`*^9}}],

Cell["\<\
Compare the above diagram with Fig 20 in the paper. The only difference is in \
the last two beachballs. Note \[Lambda]5 is different in the two figures, but \
the other \[Lambda]s are the same. The above diagram could have been used for \
Fig 20. :\
\>", "Text",
 CellChangeTimes->{{3.823009967025115*^9, 3.823010016929533*^9}, {
  3.823011466609136*^9, 3.8230114995845547`*^9}, {3.8230117199663897`*^9, 
  3.823011879761632*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"To", " ", "go", " ", "back", " ", "and", " ", "forth", " ", 
  SubscriptBox[
   RowBox[{
    RowBox[{"between", "  ", "[", "T", " ", "]"}], " "}], 
   "\[DoubleStruckCapitalB]\[DoubleStruckCapitalB]"], " ", "and", " ", "the", 
  " ", "Voigt", " ", "matrix", " ", 
  RowBox[{"C", ".", "  ", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
    "Eqs", " ", "S28", " ", "and", " ", "S29", " ", "in", " ", "the", " ", 
     "Supporting", " ", "Information"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatForISO", " ", "is", " ", 
   SubscriptBox["T", "ISO"], " ", "from", " ", "our", " ", "Table", " ", "4.",
    " ", "Try", " ", "also", " ", "TmatForXISO"}], ",", " ", "TmatForCUBE", 
  ",", " ", 
  RowBox[{
   RowBox[{"etc", ".", " ", "from"}], " ", "the", " ", 
   RowBox[{"table", "."}]}]}]}], "Subsubsection",
 CellChangeTimes->{{3.823727703556188*^9, 3.823727822451173*^9}, 
   3.8237278871401834`*^9, {3.8237279893641787`*^9, 3.823727993108195*^9}, {
   3.8237281387401867`*^9, 3.823728234324175*^9}, {3.8237285018121767`*^9, 
   3.823728540388178*^9}, {3.8237286189321747`*^9, 3.8237286473961763`*^9}},
 FontFamily->"Arial"],

Cell[BoxData[
 RowBox[{"TmatForCUBE", ";", "TmatForTRIG", ";"}]], "Input",
 CellChangeTimes->{{3.82372791091518*^9, 3.8237279377801743`*^9}, 
   3.8237279804041996`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", ",", "g", ",", "h", 
    ",", "i", ",", "j", ",", "k", ",", "m", ",", "n", ",", "o", ",", "p", ",",
     "q", ",", "r", ",", "s", ",", "t", ",", "u", ",", "v"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TmatInput", "=", "TmatForISO"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<A given matrix [T\!\(\*SubscriptBox[\"]\", 
StyleBox[\"\[DoubleStruckCapitalB]\[DoubleStruckCapitalB]\",
FontSize->12]]\) is \>\"", ",", 
     RowBox[{"MatrixForm", "[", "TmatInput", "]"}]}], " ", "]"}], ";"}], 
  "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"TmatForISO", " ", "is", " ", 
     SubscriptBox["T", "ISO"], " ", "from", " ", "our", " ", "Table", " ", 
     "4"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<The Voigt matrix for the same T is \>\"", ",", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"CmatOfTmat", "[", "TmatInput", "]"}], "]"}], "]"}]}], "]"}], 
   ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"the", " ", "corresponding", " ", "Voigt", " ", "matrix"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"TmatOfCmat", "[", 
    RowBox[{"CmatOfTmat", "[", "TmatInput", "]"}], "]"}], "==", "TmatInput"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CmatInput", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"C11", "C12", "C12", "0", "0", "0"},
       {"C12", "C11", "C12", "0", "0", "0"},
       {"C12", "C12", "C11", "0", "0", "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"C11", "-", "C12"}], "2"], "0", "0"},
       {"0", "0", "0", "0", 
        FractionBox[
         RowBox[{"C11", "-", "C12"}], "2"], "0"},
       {"0", "0", "0", "0", "0", 
        FractionBox[
         RowBox[{"C11", "-", "C12"}], "2"]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";"}], 
  "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cmat", " ", "for", " ", "ISO"}], ",", " ", 
    RowBox[{"from", " ", "Nye"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<A given Voigt matrix is \>\"", ",", 
    RowBox[{"MatrixForm", "[", "CmatInput", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<The corresponding [T\!\(\*SubscriptBox[\"]\", 
StyleBox[\"\[DoubleStruckCapitalB]\[DoubleStruckCapitalB]\",
FontSize->12]]\) is \>\"", ",", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"TmatOfCmat", "[", "CmatInput", "]"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"CmatOfTmat", "[", 
     RowBox[{"TmatOfCmat", "[", "CmatInput", "]"}], "]"}], "==", 
    "CmatInput"}], "]"}], "    "}]}], "Input",
 CellChangeTimes->{{3.823726961331175*^9, 3.823727005043182*^9}, {
   3.823727049140192*^9, 3.823727084868194*^9}, {3.823727272180188*^9, 
   3.8237272867881975`*^9}, 3.823727344980175*^9, {3.823727410492194*^9, 
   3.8237274698121853`*^9}, {3.8237275073961773`*^9, 3.823727570164183*^9}, {
   3.8237276062761855`*^9, 3.823727649972178*^9}, {3.823727680837183*^9, 
   3.823727682342183*^9}, {3.823728003461176*^9, 3.823728115477178*^9}, {
   3.823733645717176*^9, 3.823733646855175*^9}, {3.829235697570421*^9, 
   3.82923581361923*^9}, 3.829235856014263*^9, 3.8292358939691544`*^9, {
   3.8292359342397585`*^9, 3.8292359780545015`*^9}, {3.82923621314151*^9, 
   3.829236242560804*^9}, {3.8292363062614326`*^9, 3.8292363999527845`*^9}, 
   3.82923644753543*^9, {3.829236487569416*^9, 3.829236489343206*^9}, 
   3.82923653349363*^9, {3.829236597329005*^9, 3.8292367074016542`*^9}, {
   3.829236743092601*^9, 3.829236778848982*^9}, {3.8292369869798627`*^9, 
   3.8292369874365797`*^9}}]
}, Open  ]]
},
WindowSize->{977, 808},
WindowMargins->{{Automatic, 835}, {Automatic, -3}},
Magnification:>1.25 Inherited,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 506, 11, 227, "Subsubsection"],
Cell[CellGroupData[{
Cell[1089, 35, 780, 12, 35, "Subsubsection"],
Cell[1872, 49, 1134, 31, 145, "Input"],
Cell[3009, 82, 7361, 152, 466, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10407, 239, 963, 17, 44, "Subsubsection"],
Cell[11373, 258, 605, 15, 89, "Input"],
Cell[11981, 275, 367, 9, 89, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12385, 289, 954, 15, 75, "Subsubsection"],
Cell[13342, 306, 1156, 28, 164, "Input"],
Cell[14501, 336, 798, 17, 64, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15336, 358, 912, 14, 75, "Subsubsection"],
Cell[16251, 374, 681, 18, 64, "Input"],
Cell[16935, 394, 114, 1, 38, "Text"],
Cell[17052, 397, 598, 16, 64, "Input"],
Cell[17653, 415, 221, 4, 38, "Input"],
Cell[17877, 421, 1001, 29, 189, "Input"],
Cell[18881, 452, 402, 9, 38, "Input"],
Cell[19286, 463, 374, 7, 63, "Text"],
Cell[19663, 472, 921, 20, 89, "Input"],
Cell[20587, 494, 105, 1, 38, "Text"],
Cell[20695, 497, 618, 17, 64, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21350, 519, 559, 9, 75, "Subsubsection"],
Cell[21912, 530, 3602, 105, 242, "Input"],
Cell[25517, 637, 6896, 191, 265, "Input"],
Cell[32416, 830, 1012, 24, 114, "Input"],
Cell[33431, 856, 248, 4, 63, "Text"],
Cell[33682, 862, 919, 23, 64, "Input"],
Cell[34604, 887, 687, 16, 64, "Input"],
Cell[35294, 905, 796, 20, 89, "Input"],
Cell[36093, 927, 134, 1, 38, "Text"],
Cell[36230, 930, 720, 17, 114, "Input"],
Cell[36953, 949, 325, 7, 38, "Input"],
Cell[37281, 958, 180, 2, 38, "Text"],
Cell[37464, 962, 164, 2, 38, "Text"],
Cell[37631, 966, 935, 22, 90, "Input"],
Cell[38569, 990, 14152, 279, 739, "Input"],
Cell[52724, 1271, 441, 8, 91, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53202, 1284, 1175, 24, 149, "Subsubsection"],
Cell[54380, 1310, 169, 3, 38, "Input"],
Cell[54552, 1315, 4456, 106, 546, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
