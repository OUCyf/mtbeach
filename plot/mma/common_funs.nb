(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    165091,       4375]
NotebookOptionsPosition[    162043,       4276]
NotebookOutlinePosition[    163234,       4319]
CellTagsIndexPosition[    163191,       4316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Changed for Mathematica 7     07 - 27 - 2010\nApparently needed no changes \
for ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 10  11-21-2015"
}], "Text",
 CellChangeTimes->{{3.4892616449648027`*^9, 3.4892616872876763`*^9}, {
  3.4892635901517944`*^9, 3.4892635921953983`*^9}, {3.6571673188845243`*^9, 
  3.6571673455605707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DateSequence", "[", 
    RowBox[{"date_", ",", "WantTime_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"WantTime", "\[Equal]", "\"\<yes\>\""}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        "\"\< \>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
        "\"\<:\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}], ",", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "date", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
        "\"\<-\>\"", ",", 
        RowBox[{
        "date", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       "}"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"DateSequence", "[", 
  RowBox[{
   RowBox[{"DateList", "[", "]"}], ",", "\"\<no\>\""}], "]"}]}], "Input"],

Cell[BoxData[
 TemplateBox[{"3","\"-\"","5","\"-\"","2017"},
  "RowDefault"]], "Output",
 CellChangeTimes->CompressedData["
1:eJwBpQFa/iFib1JlAQAAADMAAAA5NcvhPP/pQfAeIwQ9/+lBBt1kKWL/6UHs
NMKL7wnqQfzaw/m3D+pBDFjj7YAT6kGUxlJutRTqQYeOQnT7FOpBHADRPAwV
6kHC5NKejhXqQb4csW75FepBEEWFmFUa6kHee4jPfxrqQXwA7pCcHepBpnOF
DOAe6kFSAqOz2x/qQaqAXbp2IupB9jCTU5km6kGkpIgYvSjqQbhD5kyOKupB
VqkdibAs6kHM5ON5Dy7qQf75DdKLMepByLUXwcBD6kEcKjnNP0fqQSy2JEg2
SOpBxHaGsgtJ6kES2pOexFLqQVRmCvh2U+pBJHHds4hd6kHknaI/W2bqQZId
P3/kdupB1LbG8w+D6kGgpNwmDITqQVRBiZZGnepBxPEbm6+h6kF4GKmz9KHq
QVNowdsCuOpBoQdD/W7I6kEskmr888jqQZKuM1/Z4upBuke2XlPw6kG4Y+Rn
jPfqQbrYSt/+DetBhA7UN2Qk60EweeXvuCjrQYz6yKIsLutBHIJDNH4/60FO
F/bazGjrQX5G7uLAgOtBeuXZb+WM60H+Dtes
  "]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sind", "[", "t_", "]"}], ":=", 
   RowBox[{"Sin", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cosd", "[", "t_", "]"}], ":=", 
   RowBox[{"Cos", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tand", "[", "t_", "]"}], ":=", 
   RowBox[{"Tan", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cotd", "[", "t_", "]"}], ":=", 
   RowBox[{"Cot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"secd", "[", "t_", "]"}], ":=", 
   RowBox[{"Sec", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cscd", "[", "t_", "]"}], ":=", 
   RowBox[{"Csc", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arccosd", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcCos", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arcsind", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcSin", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arctand", "[", "t_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ArcTan", "[", "t", "]"}], "/", "Degree"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"length", "[", "v_", "]"}], ":=", 
   RowBox[{"\[Sqrt]", 
    RowBox[{"(", 
     RowBox[{"v", ".", "v"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], "                "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Unit", "[", "v_", "]"}], ":=", 
    RowBox[{"v", "/", 
     RowBox[{"length", "[", "v", "]"}]}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"u_", ",", "v_"}], "]"}], "       ", ":=", 
   RowBox[{"N", "[", 
    RowBox[{"arccosd", "[", 
     RowBox[{
      RowBox[{"u", ".", "v"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"length", "[", "u", "]"}], " ", 
        RowBox[{"length", "[", "v", "]"}]}], ")"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", 
    RowBox[{"Apt_", ",", "Bpt_", ",", "Cpt_"}], "]"}], ":=", 
   RowBox[{"angle", "[", 
    RowBox[{
     RowBox[{"Apt", "-", "Bpt"}], ",", 
     RowBox[{"Cpt", "-", "Bpt"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Angle", "[", 
     RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"u", ".", "v"}], 
      RowBox[{
       RowBox[{"length", "[", "u", "]"}], " ", 
       RowBox[{"length", "[", "v", "]"}]}]], "]"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "used", " ", "to", " ", "be", " ", "AngleRad"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "   "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UU", "[", 
     RowBox[{"A_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"A", ",", 
       RowBox[{"Cross", "[", 
        RowBox[{"N", ",", "A"}], "]"}], ",", "N"}], "}"}], "]"}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"A", " ", "and", " ", "N", " ", "must", " ", "be", " ", 
     RowBox[{"orthonormal", ".", " ", "The"}], " ", "first", " ", "and", " ", 
     "third", " ", "columns", " ", "of", " ", "UU", " ", "are", " ", "A", " ",
      "and", " ", 
     RowBox[{"N", "."}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SignedAngle", "[", 
   RowBox[{"A_", ",", "B_", ",", "N_"}], "]"}], ":=", " ", 
  RowBox[{"Theta", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"UU", "[", 
      RowBox[{"A", ",", "N"}], "]"}], "]"}], ".", "B"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "A", " ", "and", " ", "B", " ", "must", " ", "be", " ", "orthogonal", 
      " ", "to", " ", "N"}], ",", " ", 
     RowBox[{
     "and", " ", "N", " ", "must", " ", "be", " ", "a", " ", "unit", " ", 
      "vector"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.734628431840602*^9, 3.734628477450066*^9}, {
  3.734628913185296*^9, 3.734628918091556*^9}, {3.7346317198290963`*^9, 
  3.734631725641618*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AA", "=", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BB", "=", 
   RowBox[{"{", 
    RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", 
   RowBox[{"{", 
    RowBox[{"n1", ",", "n2", ",", "n3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"SignedAngle", "[", 
    RowBox[{"AA", ",", "BB", ",", "NN"}], "]"}], "\[Equal]", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"AA", ".", "BB"}], ",", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{"NN", ",", "AA"}], "]"}], ".", "BB"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SignedAngle", "[", 
     RowBox[{"AA", ",", "BB", ",", "NN"}], "]"}], "==", 
    RowBox[{"SignedAngle", "[", 
     RowBox[{"AA", ",", 
      RowBox[{"t", " ", "BB"}], ",", "NN"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"t", ">", "0"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.734628542028308*^9, 3.7346285794502687`*^9}, {
  3.7346286135128355`*^9, 3.7346286463097715`*^9}, {3.7346286764035807`*^9, 
  3.7346287799350357`*^9}, {3.7346288171382337`*^9, 3.7346288952165117`*^9}, {
  3.734628930294702*^9, 3.734628945950986*^9}, {3.7346313030001593`*^9, 
  3.7346314218285146`*^9}, {3.7346314919536543`*^9, 3.7346315158755755`*^9}, {
  3.734631620750781*^9, 3.734631707610323*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7346288964196324`*^9, 3.7346289600760107`*^9, {3.734631325265831*^9, 
   3.734631334328349*^9}, {3.7346313727346754`*^9, 3.7346314227191277`*^9}, {
   3.7346314930161543`*^9, 3.734631517203706*^9}, {3.7346316523602047`*^9, 
   3.7346317085322*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7346288964196324`*^9, 3.7346289600760107`*^9, {3.734631325265831*^9, 
   3.734631334328349*^9}, {3.7346313727346754`*^9, 3.7346314227191277`*^9}, {
   3.7346314930161543`*^9, 3.734631517203706*^9}, {3.7346316523602047`*^9, 
   3.7346317085322*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SignedAngle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "6"}], "]"}], ",", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "6"}], "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.734651160060381*^9, 3.7346512273573875`*^9}, {
  3.73465373134128*^9, 3.7346537359194264`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["\[Pi]", "6"]}]], "Output",
 CellChangeTimes->{{3.7346512134979343`*^9, 3.7346512284198475`*^9}, {
  3.7346537330131164`*^9, 3.734653736700636*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"AA", ",", "BB", ",", "NN"}], "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"area", "[", "rect_", "]"}], ":=", 
    RowBox[{"length", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"rect", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"rect", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "-", 
        RowBox[{"rect", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", ".", "b"}], "/", 
    RowBox[{"length", "[", "b", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VectorProj", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"a", ".", "b"}], 
     RowBox[{"b", ".", "b"}]], "b"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlaneProj", "[", 
    RowBox[{"a_", ",", "normal_"}], "]"}], ":=", 
   RowBox[{"a", "-", 
    RowBox[{"VectorProj", "[", 
     RowBox[{"a", ",", "normal"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RightAngle", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"a", "-", "b"}], "]"}]}]}], ",", 
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"a", "-", "b"}], "]"}]}], "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"c", "-", "b"}], "]"}]}]}], ",", 
     RowBox[{"b", "+", 
      RowBox[{"scale", "*", 
       RowBox[{"unit", "[", 
        RowBox[{"c", "-", "b"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {"1", "0", "0"},
      {"0", 
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {"0", 
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"YRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"   ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0", 
       RowBox[{"Sin", "[", "t", "]"}]},
      {"0", "1", "0"},
      {
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0", 
       RowBox[{"Cos", "[", "t", "]"}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ZRot", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}], "0"},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "0"},
      {"0", "0", "1"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xrot", "[", "t_", "]"}], ":=", 
   RowBox[{"XRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"yrot", "[", "t_", "]"}], ":=", 
   RowBox[{"YRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zrot", "[", "t_", "]"}], ":=", 
   RowBox[{"ZRot", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rot111", "=", 
   RowBox[{"(", GridBox[{
      {"0", "0", "1"},
      {"1", "0", "0"},
      {"0", "1", "0"}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{"w_", ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         SuperscriptBox["w", "2"], "+", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "-", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "+", 
           RowBox[{"w", " ", "y"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "y"}], "+", 
           RowBox[{"w", " ", "z"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "-", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "-", 
           RowBox[{"w", " ", "x"}]}], ")"}]}]},
       {
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x", " ", "z"}], "-", 
           RowBox[{"w", " ", "y"}]}], ")"}]}], 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y", " ", "z"}], "+", 
           RowBox[{"w", " ", "x"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["w", "2"], "-", 
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}]}
      }], "\[NoBreak]", ")"}]}], " ", ";"}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Used", " ", "to", " ", "be", " ", 
     RowBox[{"RotMatrix2", ".", "  ", 
      StyleBox[
       RowBox[{"Q", 
        StyleBox["u",
         FontColor->RGBColor[1, 0, 0]]}]]}], "aternion", " ", 
     RowBox[{"{", 
      RowBox[{"w", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "}"}], " ", "must", " ", 
     "have", " ", "length", " ", "one"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rot", "[", 
    RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"RotMatrixQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cosd", "[", 
       RowBox[{"\[Xi]", "/", "2"}], "]"}], ",", 
      RowBox[{
       RowBox[{"sind", "[", 
        RowBox[{"\[Xi]", "/", "2"}], "]"}], 
       RowBox[{"unit", "[", "v", "]"}]}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROT", "[", "v_", "]"}], ":=", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         RowBox[{"v", ".", "v"}]}]], ",", "v"}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"This", " ", "is", " ", 
     SubscriptBox["U", "B"], " ", "in", " ", "some", " ", "of", " ", "the", 
     " ", "tex", " ", "files"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ROT", "[", 
     RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"RotMatrixQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"\[Xi]", "/", "2"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Xi]", "/", "2"}], "]"}], 
        FractionBox["v", 
         SqrtBox[
          RowBox[{"v", ".", "v"}]]]}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"rot", "[", 
       RowBox[{"\[Xi]_", ",", "v_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", "v", "]"}], "]"}], ".", 
       RowBox[{"zrot", "[", "\[Xi]", "]"}], ".", 
       RowBox[{"vertical", "[", "v", "]"}]}]}], ";", "  ", "old"}], ",", " ", 
    RowBox[{
    "but", " ", "the", " ", "two", " ", "rots", " ", "are", " ", 
     "equivalent"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rot2D", "[", "t_", "]"}], ":=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"Cos", "[", "t", "]"}], 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "t", "]"}]}]},
      {
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"  ", 
        RowBox[{"Cos", "[", "t", "]"}]}]}
     }], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rot2d", "[", "t_", "]"}], ":=", 
   RowBox[{"Rot2D", "[", 
    RowBox[{"t", " ", "Degree"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ROTe3e1toOrthonormalv3v1", "[", 
    RowBox[{"v3_", ",", "v1_"}], "]"}], ":=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"v1", ",", 
      RowBox[{"Cross", "[", 
       RowBox[{"v3", ",", "v1"}], "]"}], ",", "v3"}], "}"}], "]"}]}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "v3", " ", "and", " ", "v1", " ", "must", " ", "be", " ", "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UsHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ZRot", "[", "\[Theta]", "]"}], ".", 
     RowBox[{
      StyleBox["YRot",
       FontColor->RGBColor[1, 0, 0]], "[", "\[Phi]", "]"}], ".", 
     RowBox[{"ZRot", "[", "\[Sigma]", "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "not", " ", "the", " ", "same", " ", "as", " ", "in", " ", "Section", " ",
      "S4", " ", "of", " ", "Supp", " ", "Info", " ", "for", " ", "TapeTape", 
     " ", "2015"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Us", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Sigma]_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"UsHat", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "\[Sigma]", ",", 
      RowBox[{"ArcCos", "[", "z", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UgHat", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]\[Phi]", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "\[Phi]"}], "}"}], "]"}], 
     ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"G", " ", "for", " ", 
      RowBox[{"geology", ".", " ", "Used"}], " ", "to", " ", "be", " ", 
      RowBox[{"U\[Kappa]\[Sigma]\[Phi]", ".", " ", "Inputs"}], " ", "in", " ",
       "radians"}], ";", " ", 
     RowBox[{
      RowBox[{"basis", " ", "should", " ", "be", " ", "north"}], "-", "west", 
      "-", 
      RowBox[{
      "up", " ", "for", " ", "coords", " ", "to", " ", "have", " ", "meaning",
        " ", "strike"}], "-", "rake", "-", "dip"}], ";", " ", 
     RowBox[{"Eq", " ", 
      RowBox[{"(", "26", ")"}], " ", "of", " ", 
      RowBox[{"TapeTape2012beach", "."}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Ug", "[", 
     RowBox[{"{", 
      RowBox[{"\[Kappa]_", ",", "\[Sigma]_", ",", "h_"}], "}"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"V\[Kappa]\[Sigma]h", "[", 
      RowBox[{"{", 
       RowBox[{"\[Kappa]", ",", "\[Sigma]", ",", "h"}], "}"}], "]"}], ".", 
     RowBox[{"YRot", "[", 
      RowBox[{
       RowBox[{"-", "\[Pi]"}], "/", "4"}], "]"}]}]}], ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"G", " ", "for", " ", 
       RowBox[{"geology", ".", " ", "Basis"}], " ", "should", " ", "be", " ", 
       "north"}], "-", "west", "-", 
      RowBox[{
      "up", " ", "for", " ", "coords", " ", "to", " ", "have", " ", "meaning",
        " ", "strike"}], "-", "rake", "-", 
      RowBox[{"cos", 
       RowBox[{"(", "dip", ")"}]}]}], ";"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"yref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"zref", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefWithUnitNormal", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["u", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "w"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["v", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "v", " ", "w"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "w"}], 
        RowBox[{
         RowBox[{"-", "2"}], "v", " ", "w"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["w", "2"]}]}]}
      }], ")"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"changed", " ", "'"}], 
     RowBox[{"Reflection", "'"}], " ", 
     RowBox[{"to", " ", "'"}], 
     RowBox[{"Ref", "'"}], " ", "April", " ", "2012"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RefWithUnitNormal", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["u", "2"]}]}], 
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}]},
       {
        RowBox[{
         RowBox[{"-", "2"}], "u", " ", "v"}], 
        RowBox[{"1", "-", 
         RowBox[{"2", 
          SuperscriptBox["v", "2"]}]}]}
      }], ")"}]}], ";"}], "              ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"changed", " ", "'"}], 
      RowBox[{"Reflection", "'"}], " ", 
      RowBox[{"to", " ", "'"}], 
      RowBox[{"Ref", "'"}], " ", "April", " ", "2012"}], ";", " ", 
     RowBox[{"added", " ", "2", "D", " ", "March", " ", "2016"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"id", "=", 
    RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sign", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "<", "0"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xyztp", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"cosd", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"sind", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"sind", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"sind", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"cosd", "[", "\[Phi]", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{"\[Theta]_", ",", "\[Phi]_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"arccosd", "[", 
    FractionBox["z", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"], "+", 
       SuperscriptBox["z", "2"]}]]], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Phi", "[", "v_", "]"}], ":=", 
   RowBox[{"Angle", "[", 
    RowBox[{"v", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}]], "==", "0"}], ",", "0", ",", 
      "               ", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
        RowBox[{"arcsind", "[", 
         FractionBox["y", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]]], "]"}], ",", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", ">=", "0"}], ",", 
          RowBox[{"180", "-", 
           RowBox[{"arcsind", "[", 
            FractionBox["y", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"]}]]], "]"}]}], ",", "\n", 
          "\t\t\t\t           ", 
          RowBox[{
           RowBox[{"-", "180"}], "-", 
           RowBox[{"arcsind", "[", 
            FractionBox["y", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["x", "2"], "+", 
               SuperscriptBox["y", "2"]}]]], "]"}]}]}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "changed", " ", "Feb", " ", "2009", " ", "also", " ", "eliminated", " ", 
     "carets"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Theta", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}]], "==", "0"}], ",", "0", ",", 
       "               ", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"y", "\[GreaterEqual]", "0"}], ",", 
         RowBox[{"ArcCos", "[", 
          FractionBox["x", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["x", "2"], "+", 
             SuperscriptBox["y", "2"]}]]], "]"}], ",", 
         RowBox[{"-", 
          RowBox[{"ArcCos", "[", 
           FractionBox["x", 
            SqrtBox[
             RowBox[{
              SuperscriptBox["x", "2"], "+", 
              SuperscriptBox["y", "2"]}]]], "]"}]}]}], "]"}]}], "]"}]}], 
    ";"}], "*)"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"used", " ", "for", " ", "lune", " ", "coordinates"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Theta", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]", " ", 
       StyleBox[
        RowBox[{"i", 
         StyleBox["n",
          FontColor->RGBColor[1, 0, 0]]}]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 0]], 
       StyleBox["rad",
        FontColor->RGBColor[1, 0, 0]]}], "ians"}], ",", " ", 
     RowBox[{
      RowBox[{"from", " ", "-", 
       RowBox[{"\[Pi]", " ", "to", " ", "\[Pi]"}]}], ";", " ", 
      RowBox[{"changed", " ", "April", " ", "2018"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"theta2d", "[", "v_", "]"}], ":=", 
  RowBox[{"theta", "[", 
   RowBox[{"Append", "[", 
    RowBox[{"v", ",", "0"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"phitheta", "[", "v_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phi", "[", "v", "]"}], ",", 
     RowBox[{"theta", "[", "v", "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vertical", "[", "p_", "]"}], ":=", 
    RowBox[{
     RowBox[{"zrot", "[", 
      RowBox[{"theta", "[", "p", "]"}], "]"}], ".", 
     RowBox[{"yrot", "[", 
      RowBox[{"-", 
       RowBox[{"phi", "[", "p", "]"}]}], "]"}], ".", 
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", "p", "]"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Changed", " ", "Aug", " ", "2002"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vertical", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", 
        RowBox[{
         RowBox[{"vertical", "[", "a", "]"}], ".", "b"}], "]"}]}], "]"}], ".", 
     RowBox[{"vertical", "[", "a", "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "makes", " ", "a", " ", "vertical", " ", "and", " ", "gives", " ", "b", 
    " ", "a", " ", "theta", " ", "coordinate", " ", "of", " ", "zero"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"verticalViaXAxis", "[", "p_", "]"}], ":=", 
    RowBox[{
     RowBox[{"yrot", "[", 
      RowBox[{"-", 
       RowBox[{"phi", "[", "p", "]"}]}], "]"}], ".", 
     RowBox[{"zrot", "[", 
      RowBox[{"-", 
       RowBox[{"theta", "[", "p", "]"}]}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Changed", " ", "Aug", " ", "2002"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"range", "[", 
    RowBox[{"domain_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"f", "/@", "domain"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListComplement", "[", 
     RowBox[{"universe_", ",", "set_"}], "]"}], ":=", 
    RowBox[{"Select", "[", 
     RowBox[{"universe", ",", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"set", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "Mathematica", " ", "Complement", " ", "no", " ", "good", " ", "for", " ", 
    "lists"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"partition", "[", 
    RowBox[{"set_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"part", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"remaining", "=", "set"}], ";", "\n", "     ", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"remaining", "!=", 
        RowBox[{"{", "}"}]}], ",", "\n", "\t   ", 
       RowBox[{
        RowBox[{"EqCl", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"remaining", ",", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{
              RowBox[{"First", "[", "remaining", "]"}], ",", "#"}], "]"}], 
            " ", "&"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"part", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"part", ",", 
           RowBox[{"{", "EqCl", "}"}]}], "]"}]}], ";", "\n", "\t\t", 
        RowBox[{"remaining", "=", 
         RowBox[{"ListComplement", "[", 
          RowBox[{"remaining", ",", "EqCl"}], "]"}]}]}]}], "]"}], ";", 
     "part"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"QuotientTopology", "[", 
    RowBox[{"domain_", ",", "f_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Rangef", "=", 
      RowBox[{"range", "[", 
       RowBox[{"domain", ",", "f"}], "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"Clear", "[", "EqCl", "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{"EqCl", "[", "RangeValue_", "]"}], ":=", 
      RowBox[{"{", "}"}]}], ";", "\n", "\t\t", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"EqCl", "[", 
         RowBox[{"f", "[", 
          RowBox[{"domain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"EqCl", "[", 
           RowBox[{"f", "[", 
            RowBox[{"domain", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"domain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "domain", "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "     ", 
     RowBox[{"EqCl", "/@", "Rangef"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MyFlatten", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "y"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnsortedUnion", "[", "list_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Union", "[", "list", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "#1"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "#2"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CartesianProduct", "[", "ListOfSets_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "ListOfSets", "]"}], "==", "2"}], ",", "\t\t", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ListOfSets", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
            RowBox[{"ListOfSets", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"ListOfSets", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "1"}], "]"}], "]"}], ",", "\n", 
     RowBox[{"MyFlatten", "/@", 
      RowBox[{"CartesianProduct", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"ListOfSets", ",", "1"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"CartesianProduct", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"ListOfSets", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ForSomeMine", "[", 
    RowBox[{"domain_", ",", "predicate_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"predicate", "/@", "domain"}], ",", "True"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ForAllMine", "[", 
    RowBox[{"domain_", ",", "predicate_"}], "]"}], ":=", 
   RowBox[{"!", 
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"predicate", "/@", "domain"}], ",", "False"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ListIsComplex", "[", "v_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"Head", "/@", "v"}], ",", "Complex"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EqualNumbers", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{"x", "-", "y"}], "]"}], "<", ".00001"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EqualVectors", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"length", "[", 
     RowBox[{"x", "-", "y"}], "]"}], "<", ".00001"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SegmentList", "[", "PointList_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointList", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"#", "+", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"EquatorList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"zrot", "[", "#", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "181"}], ",", "179", ",", "2"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MapEyeward", "[", 
     RowBox[{"x_", ",", "distance_", ",", "eye_"}], "]"}], ":=", 
    RowBox[{"x", "+", 
     RowBox[{"distance", "*", 
      RowBox[{"unit", "[", "eye", "]"}]}]}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"usually", " ", "distance"}], " ", "=", " ", 
    RowBox[{".01", " ", "is", " ", "enough"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MapListEyeward", "[", 
    RowBox[{"list_", ",", "distance_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"MapEyeward", "[", 
      RowBox[{"#", ",", "distance", ",", "eye"}], "]"}], "&"}], "/@", 
    "list"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeReal", "[", "z_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "z", "]"}], "==", "0"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"Im", "[", "z", "]"}], "]"}], "<", ".00001"}], ",", 
       RowBox[{"Re", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"MakeReal", "/@", "z"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPoly", "[", 
    RowBox[{"i_", ",", "j_", ",", "RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", " ", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}], ",", "\n", 
     "\t\t                                                                    \
 ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RangeX", "[", 
        RowBox[{"[", "i", "       ", "]"}], "]"}], ",", 
       RowBox[{"RangeY", "[", 
        RowBox[{"[", 
         RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "}"}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RangeX", "[", 
         RowBox[{"[", "i", "      ", "]"}], "]"}], ",", 
        RowBox[{"RangeY", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "*)"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicPolys", "[", 
    RowBox[{"RangeX_", ",", "RangeY_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"BasicPoly", "[", 
        RowBox[{"i", ",", "j", ",", "RangeX", ",", "RangeY"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeX", "]"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"Length", "[", "RangeY", "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"myRange", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "Nsubintervals_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x2", "<=", "x1"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"x1", ",", "x2", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "/", "Nsubintervals"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"myRangeNoSign", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "Nsubintervals_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Im", "[", "x1", "]"}], "!=", "0"}], "||", 
      RowBox[{
       RowBox[{"Im", "[", "x2", "]"}], "!=", "0"}]}], ",", 
     RowBox[{"myRange", "[", 
      RowBox[{"x1", ",", "x2", ",", "Nsubintervals"}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x1", "<=", "x2"}], ",", 
       RowBox[{"myRange", "[", 
        RowBox[{"x1", ",", "x2", ",", "Nsubintervals"}], "]"}], ",", 
       RowBox[{"myRange", "[", 
        RowBox[{"x2", ",", "x1", ",", "Nsubintervals"}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BothSigns", "[", "list_", "]"}], ":=", 
   RowBox[{"Union", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"list", ",", 
      RowBox[{"-", "list"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inject", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LineList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "nPts_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"i", "/", "nPts"}]}], ")"}], "p1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"i", "/", "nPts"}], ")"}], "p2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "nPts"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintEye", ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<eye = \>\"", ",", 
     RowBox[{"Round", "[", 
      RowBox[{"eye", ",", ".01"}], "]"}], ",", 
     "\"\<;  (\[Theta], \[Phi]\!\(\*SubscriptBox[\()\), \(eye\)]\) = \>\"", 
     ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "[", "eye", "]"}], ",", 
        RowBox[{"phi", "[", "eye", "]"}]}], "}"}], "]"}], ",", 
     "\"\<, \!\(\*SubscriptBox[\(\[Rho]\), \(eye\)]\) = \>\"", ",", 
     RowBox[{"Simplify", "[", 
      RowBox[{"length", "[", "eye", "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CubeVertices", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CubeEdges", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "  ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xCubeFace", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"xrot", "[", "#", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"90", ",", "360", ",", "90"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CubeFacePolys", "=", 
    RowBox[{"Union", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"MatrixPower", "[", 
             RowBox[{"rot111", ",", "i"}], "]"}], ".", "#"}], "&"}], "/@", 
          "xCubeFace"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"MatrixPower", "[", 
              RowBox[{"rot111", ",", "i"}], "]"}], ".", "#"}]}], "&"}], "/@", 
          "xCubeFace"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}], "]"}]}],
    ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"added", " ", "Union", " ", "Dec", " ", "2016"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomDirection", ":=", 
   RowBox[{"xyzTP", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], "]"}], ",", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomRotation", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"tt", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pp", "=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ss", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"2", "\[Pi]"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RotMatrixQ", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"ss", "/", "2"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"ss", "/", "2"}], "]"}], 
          RowBox[{
           RowBox[{"ZRot", "[", "tt", "]"}], ".", 
           RowBox[{"YRot", "[", "pp", "]"}], ".", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "}"}], "]"}], ".", 
      RowBox[{"ZRot", "[", "tt", "]"}], ".", 
      RowBox[{"YRot", "[", "pp", "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomUnitMT", ":=", 
    RowBox[{"MatrixFromONcoords", "[", 
     RowBox[{"unit", "[", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", "6"}], "]"}], "]"}], "]"}]}], 
   ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"random", " ", "unit", " ", "moment", " ", "tensor"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uG", "=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["2"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "2", ",", 
         RowBox[{"-", "1"}]}], "}"}], 
       SqrtBox["6"]], ",", 
      FractionBox[
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], 
       SqrtBox["3"]]}], "}"}]}], ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"arc", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"RotMatrixQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"#", "/", "2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"#", "/", "2"}], "]"}], 
           RowBox[{"unit", "[", 
            RowBox[{"Cross", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "]"}]}]}], "}"}], "]"}], ".", 
       "a"}], "&"}], "/@", 
     RowBox[{"myRange", "[", 
      RowBox[{
       RowBox[{"0", "+", 
        RowBox[{"1", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", 
       RowBox[{
        RowBox[{"Angle", "[", 
         RowBox[{"a", ",", "b"}], "]"}], "-", 
        RowBox[{"1", 
         StyleBox["Degree",
          FontColor->RGBColor[1, 0, 0]]}]}], ",", "30"}], "]"}]}]}], ";"}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Change", " ", "0", " ", "to", " ", "1", " ", "or", " ", "2", " ", "so", 
     " ", "endpoints", " ", "are", " ", "visible"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InnerProductMatrix", "[", 
    RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", "M", "]"}], ".", 
    RowBox[{"Flatten", "[", "N", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormMatrix", "[", "M_", "]"}], ":=", 
   SqrtBox[
    RowBox[{"InnerProductMatrix", "[", 
     RowBox[{"M", ",", "M"}], "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitMatrix", "[", "M_", "]"}], ":=", 
   FractionBox["M", 
    RowBox[{"NormMatrix", "[", "M", "]"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AngleMatrix", "[", 
     RowBox[{"M_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{"InnerProductMatrix", "[", 
       RowBox[{"M", ",", "N"}], "]"}], 
      RowBox[{
       RowBox[{"NormMatrix", "[", "M", "]"}], 
       RowBox[{"NormMatrix", "[", "N", "]"}]}]], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   StyleBox["radians",
    FontColor->RGBColor[1, 0, 0]], 
   StyleBox[" ",
    FontColor->RGBColor[1, 0, 0]], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MatrixAbs", "[", "V_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"Abs", ",", "V", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "     ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"MatrixAbs", "[", "V", "]"}], " ", "is", " ", 
     SubscriptBox["\[CapitalPi]", "V"]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SpherePolyList", "[", 
     RowBox[{
     "\[Rho]_", ",", "\[Theta]1_", ",", "\[Theta]2_", ",", "\[Phi]1_", ",", 
      "\[Phi]2_", ",", "\[CapitalDelta]\[Theta]_", ",", 
      "\[CapitalDelta]\[Phi]_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]", " ", 
        RowBox[{"xyztp", "[", "#", "]"}]}], "&"}], ",", " ", 
      RowBox[{"BasicPolys", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
         "\[Theta]1", ",", "\[Theta]2", ",", "\[CapitalDelta]\[Theta]"}], 
         "]"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"\[Phi]1", ",", "\[Phi]2", ",", "\[CapitalDelta]\[Phi]"}], 
         "]"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], 
  "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BarText", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
   RowBox[{"SequenceForm", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[GreaterEqual]", "0"}], ",", "x", ",", 
       OverscriptBox[
        RowBox[{"-", "x"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"y", "\[GreaterEqual]", "0"}], ",", "y", ",", 
       OverscriptBox[
        RowBox[{"-", "y"}], "_"]}], "]"}], ",", "\"\< \>\"", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"z", "\[GreaterEqual]", "0"}], ",", "z", ",", 
       OverscriptBox[
        RowBox[{"-", "z"}], "_"]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "AinRadians_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SuperscriptBox", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"AinRadians", "/", "Degree"}], ",", ".01"}], "]"}], ",", 
      "o"}], "]"}], "//", "DisplayForm"}]}], ";"}]}], "Input",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic,
 CellChangeTimes->{
  3.4892780789458637`*^9, 3.4892781537179947`*^9, 3.489278185963251*^9, {
   3.4950345922209835`*^9, 3.4950346018774004`*^9}, {3.5011818616296425`*^9, 
   3.5011818626904445`*^9}, {3.520005149614954*^9, 3.520005186743019*^9}, {
   3.5228787025265994`*^9, 3.522878716086618*^9}, {3.523572395586929*^9, 
   3.5235725065031223`*^9}, {3.5235726199309196`*^9, 
   3.5235726788522224`*^9}, {3.523573043268858*^9, 3.523573114982183*^9}, {
   3.523913723635171*^9, 3.5239137509196186`*^9}, {3.523913805878515*^9, 
   3.523913806065715*^9}, {3.52415771607572*^9, 3.5241577374165573`*^9}, {
   3.5245987606895313`*^9, 3.5245988112024193`*^9}, {3.5246041379147077`*^9, 
   3.524604143889518*^9}, {3.5275223122177277`*^9, 3.5275223131381297`*^9}, {
   3.5278961648661757`*^9, 3.5278961685761805`*^9}, {3.531153615164811*^9, 
   3.531153615984812*^9}, {3.5330552480452175`*^9, 3.533055281051276*^9}, {
   3.5359904583292646`*^9, 3.535990479217701*^9}, {3.536343561909086*^9, 
   3.5363435629386873`*^9}, {3.543292666839031*^9, 3.543292719379923*^9}, {
   3.5469924224625473`*^9, 3.5469924490318937`*^9}, {3.5519977604570932`*^9, 
   3.5519977614398947`*^9}, {3.557771274368308*^9, 3.5577712872851305`*^9}, {
   3.557771609737693*^9, 3.557771612483298*^9}, {3.55837231696457*^9, 
   3.558372325981386*^9}, {3.5583752865857487`*^9, 3.5583753000329723`*^9}, {
   3.558903374762436*^9, 3.5589033779604416`*^9}, {3.559264638214102*^9, 
   3.5592646392281036`*^9}, {3.56152558249544*^9, 3.5615255833378415`*^9}, {
   3.567712960903683*^9, 3.567712961808485*^9}, 3.57212065450091*^9, {
   3.5745725034873385`*^9, 3.5745725429211073`*^9}, {3.5745726368819714`*^9, 
   3.574572649926094*^9}, {3.5914556336639824`*^9, 3.5914556350939846`*^9}, {
   3.592708592645027*^9, 3.592708593975029*^9}, {3.5928584937596893`*^9, 
   3.592858725568514*^9}, {3.5940571577699823`*^9, 3.594057159789985*^9}, {
   3.5944926563063498`*^9, 3.5944926865583925`*^9}, {3.594492775988516*^9, 
   3.594492776368517*^9}, {3.594492837360602*^9, 3.594492837900603*^9}, {
   3.594492902030691*^9, 3.594492936992742*^9}, {3.594493034604878*^9, 
   3.594493069734926*^9}, {3.594493106114977*^9, 3.59449322455514*^9}, 
   3.59449358324364*^9, 3.594515431065692*^9, {3.5945158044122105`*^9, 
   3.594515805652213*^9}, {3.5947545896350193`*^9, 3.5947546197350607`*^9}, {
   3.594828417439077*^9, 3.594828449759122*^9}, {3.594926309197468*^9, 
   3.5949263218474855`*^9}, {3.594927514981152*^9, 3.5949275153411527`*^9}, {
   3.594929784751333*^9, 3.5949297858113346`*^9}, {3.59492992226153*^9, 
   3.594929926493537*^9}, {3.5949299683435946`*^9, 3.5949300347036858`*^9}, 
   3.5950188480312347`*^9, {3.595034990484455*^9, 3.5950349917844567`*^9}, {
   3.5956466336034193`*^9, 3.5956467549255886`*^9}, {3.5956470300339727`*^9, 
   3.5956470819260454`*^9}, {3.5956471788681808`*^9, 3.595647201638212*^9}, {
   3.595647312358365*^9, 3.5956473913904753`*^9}, {3.595715611870015*^9, 
   3.5957156407100554`*^9}, {3.5957156923101263`*^9, 3.595715708840149*^9}, 
   3.595716187234812*^9, {3.5957170337435017`*^9, 3.595717044763517*^9}, {
   3.597258178496549*^9, 3.5972581787265496`*^9}, {3.599261386127534*^9, 
   3.5992613871575356`*^9}, {3.5992772595141573`*^9, 
   3.5992772602741585`*^9}, {3.599277324544247*^9, 3.599277331914257*^9}, {
   3.603647041856326*^9, 3.603647081556381*^9}, {3.618611067270751*^9, 
   3.6186110728807583`*^9}, {3.6186111460108595`*^9, 3.618611158820877*^9}, {
   3.6186112106309485`*^9, 3.6186112148309546`*^9}, {3.6332226277838993`*^9, 
   3.6332226479739275`*^9}, {3.6332232680633373`*^9, 3.633223271203342*^9}, {
   3.6487904358208184`*^9, 3.648790525907971*^9}, {3.6684483212406683`*^9, 
   3.6684483397506933`*^9}, {3.668448371313237*^9, 3.6684483724032383`*^9}, {
   3.6833964238277674`*^9, 3.6833964249926825`*^9}, {3.6912539493321176`*^9, 
   3.6912539770821705`*^9}, 3.6921210127382526`*^9, {3.692498157175506*^9, 
   3.6924981572067585`*^9}, {3.692498188581808*^9, 3.6924982054881015`*^9}, {
   3.695618698451692*^9, 3.695618699407053*^9}, {3.6989476969098516`*^9, 
   3.6989477407249126`*^9}, {3.69894791067515*^9, 3.6989479132551003`*^9}, {
   3.698948249975572*^9, 3.6989482517006264`*^9}, 3.698948337170746*^9, 
   3.698948387285816*^9, {3.704659163921527*^9, 3.7046591660016465`*^9}, {
   3.7046603495084248`*^9, 3.704660372531743*^9}, {3.7110334365290008`*^9, 
   3.711033451294655*^9}, {3.711037659460438*^9, 3.711037663069871*^9}, {
   3.714850937910308*^9, 3.7148509695003376`*^9}, {3.7180645430460205`*^9, 
   3.718064570108611*^9}, {3.7180666054094276`*^9, 3.71806663069073*^9}, {
   3.722288161654131*^9, 3.7222881635447617`*^9}, {3.7222882068104715`*^9, 
   3.7222882083104744`*^9}, {3.722292009776352*^9, 3.7222920136513596`*^9}, {
   3.7262973003213577`*^9, 3.7262973017744856`*^9}, {3.731373845215251*^9, 
   3.7313738572602186`*^9}, {3.7323744228995304`*^9, 3.732374459087102*^9}, {
   3.734451137662434*^9, 3.7344511824145136`*^9}, {3.734451213118719*^9, 
   3.7344512199530644`*^9}, {3.7344512822894893`*^9, 3.734451306024126*^9}, {
   3.7346172811792326`*^9, 3.734617283601099*^9}, {3.7346177011331806`*^9, 
   3.7346177245082216`*^9}, {3.7346179000710773`*^9, 3.734617907211706*^9}, {
   3.7346179430399103`*^9, 3.734617955993041*^9}, {3.734628196652638*^9, 
   3.7346282214183187`*^9}, {3.734628275902807*^9, 3.734628299449718*^9}, {
   3.7346283505904465`*^9, 3.73462838573114*^9}, 3.734628420246833*^9, 
   3.7346284796375732`*^9, 3.734653704466226*^9, 3.7350941129877977`*^9},
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoordsWrtFrame", "[", 
     RowBox[{"\[CapitalLambda]_", ",", "frame_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", "frame", "]"}], ".", "\[CapitalLambda]"}]}], 
   ";"}], "      ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{
     "The", " ", "frame", " ", "vectors", " ", "are", " ", "the", " ", 
      "COLUMNS", " ", "of", " ", "the", " ", "matrix", " ", "\"\<frame.\>\"", 
      " ", "I", " ", "changed", " ", "this", " ", "Nov", " ", "26"}], ",", 
     " ", "2013."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "\[Lambda]1", ",", "\[Lambda]2", ",", 
    "\[Lambda]3"}], "]"}], ";", 
  RowBox[{"\[CapitalLambda]", "=", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "+", 
     RowBox[{"b", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "+", 
     RowBox[{"c", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}]}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"\[Lambda]1", ",", "\[Lambda]2", ",", "\[Lambda]3"}], "}"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Frame1", "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"1", "/", "2"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"Transpose", " ", "added", " ", "Nov", " ", "26"}], ",", " ", 
     "2013."}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"CoordsWrtFrame", "[", 
  RowBox[{"\[CapitalLambda]", ",", "Frame1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5938130191244907`*^9, 3.59381310452661*^9}, {
  3.593813263512833*^9, 3.5938132661028366`*^9}, {3.5938234660811977`*^9, 
  3.5938234707032056`*^9}, {3.5945191585479183`*^9, 3.5945191911104636`*^9}, {
  3.594519344284678*^9, 3.5945193458346806`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "\[Rule]", 
     RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}]}], ",", 
    RowBox[{"b", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["2", "3"]}], " ", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", "-", 
        RowBox[{"2", " ", "\[Lambda]2"}], "+", "\[Lambda]3"}], ")"}]}]}], ",", 
    RowBox[{"c", "\[Rule]", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Lambda]1"}], "-", "\[Lambda]2", "-", "\[Lambda]3"}], 
       ")"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.5945193554846935`*^9, 3.5947458342146816`*^9, 
  3.5950182114603434`*^9, 3.608595194095061*^9, 3.615660789896256*^9, 
  3.619447615447173*^9, 3.6312163785289564`*^9, 3.642958270836772*^9, 
  3.6452289273585463`*^9, 3.648087318680585*^9, 3.6571672663904333`*^9, 
  3.6788241520373306`*^9, 3.6913825517999125`*^9, 3.6977488636530123`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "\[Lambda]1"}], "3"]}], "+", 
    FractionBox[
     RowBox[{"4", " ", "\[Lambda]2"}], "3"], "-", 
    FractionBox[
     RowBox[{"2", " ", "\[Lambda]3"}], "3"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[Lambda]1", "3"]}], "-", 
    FractionBox["\[Lambda]2", "3"], "-", 
    FractionBox["\[Lambda]3", "3"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.5945193554846935`*^9, 3.5947458342146816`*^9, 
  3.5950182114603434`*^9, 3.608595194095061*^9, 3.615660789896256*^9, 
  3.619447615447173*^9, 3.6312163785289564`*^9, 3.642958270836772*^9, 
  3.6452289273585463`*^9, 3.648087318680585*^9, 3.6571672663904333`*^9, 
  3.6788241520373306`*^9, 3.6913825517999125`*^9, 3.6977488636686*^9}]
}, Open  ]],

Cell["ARROW2D IS FOR 2-DIMENSIONAL.  REDONE JUNE 2002", "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ArrowBasic2D", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], " ", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], " ", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"arrow", "[", 
    RowBox[{"tip_", ",", "scale_", ",", "theta_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"tip", "+", 
      RowBox[{"scale", "\[Times]", 
       RowBox[{
        RowBox[{"rot2d", "[", "theta", "]"}], ".", "#"}]}]}], "&"}], "/@", 
    "ArrowBasic2D"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arrow2D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", "scale_"}], "]"}], ":=", 
   RowBox[{"arrow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x2", ",", "y2"}], "}"}], ",", "scale", ",", 
     RowBox[{"theta", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", "-", "x1"}], ",", 
        RowBox[{"y2", "-", "y1"}], ",", "0"}], "}"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Arrow2DonSphere", "[", 
    RowBox[{"v3_", ",", "v1_", ",", "scale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ROTe3e1toOrthonormalv3v1", "[", 
       RowBox[{"v3", ",", "v1"}], "]"}], ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"scale", "\[Times]", "ArrowBasic2D"}], ")"}]}]}], 
  ";"}]}], "Input",
 PageBreakBelow->Automatic,
 CellChangeTimes->{{3.68338868201423*^9, 3.6833886979685235`*^9}, {
  3.683388799810652*^9, 3.683388831661496*^9}, {3.683388925031291*^9, 
  3.683388936627301*^9}, {3.683396547896555*^9, 3.6833965487526894`*^9}},
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"Line", "[", "ArrowBasic2D", "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
   RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.683388387359335*^9, 3.6833884115524797`*^9}, {
   3.6833885077237625`*^9, 3.683388533888088*^9}, {3.683388885507532*^9, 
   3.683388913453946*^9}, {3.683391790409665*^9, 3.683391797768368*^9}, 
   3.683396514650652*^9}],

Cell[BoxData[
 GraphicsBox[LineBox[{{0, 0}, {-2, 1}, {-1.2, 0}, {-2, -1}, {0, 0}}],
  AspectRatio->Automatic,
  Axes->True,
  ImageSize->{108., Automatic}]], "Output",
 CellChangeTimes->{{3.683388396729209*^9, 3.683388413084169*^9}, {
   3.6833885154973974`*^9, 3.6833885346329336`*^9}, {3.6833889020058074`*^9, 
   3.683388927879713*^9}, 3.683391799124265*^9, 3.6833965587146254`*^9, 
   3.6913825518689137`*^9, 3.697748863762389*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CirclePt", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], "+", 
     RowBox[{
      RowBox[{"xrot", "[", "i", "]"}], ".", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"1", "/", "3"}]}], "}"}]}]}]}], ";"}], "            ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Revised", " ", "July", " ", "2017"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConePoly", "[", "i_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"CirclePt", "[", "i", "]"}], ",", 
     RowBox[{"CirclePt", "[", 
      RowBox[{"i", "+", "30"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HalfDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "90"}], ",", "90", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WholeDisk", "=", 
   RowBox[{"CirclePt", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "360", ",", "30"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"UofSN", "[", 
     RowBox[{"S_", ",", "N_"}], "]"}], ":=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"unit", "[", "S", "]"}], ",", 
       RowBox[{"unit", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"N", ",", "S"}], "]"}], "]"}], ",", 
       RowBox[{"unit", "[", "N", "]"}]}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Rotation", " ", "matrix", " ", "that", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}], " ", "to", " ", "S", " ", 
     "and", " ", "takes", " ", 
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1"}], ")"}], " ", "to", " ", 
     RowBox[{"N", ".", "  ", "S"}], " ", "and", " ", "N", " ", "are", " ", 
     "orthonormal"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ShortenForArrow", "[", 
    RowBox[{"vector_", ",", "ArrowScale_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"1.02", 
       FractionBox["ArrowScale", 
        RowBox[{"length", "[", "vector", "]"}]]}]}], ")"}], "vector"}]}], 
  "  ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"NO", ",", " ", 
     RowBox[{
     "this", " ", "needs", " ", "revision", " ", "for", " ", "tip", " ", 
      "version", " ", "of", " ", "Arrow3D"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7107786899249983`*^9, 3.7107787639572253`*^9}, {
   3.7107788118280177`*^9, 3.7107788181643305`*^9}, {3.710778912245721*^9, 
   3.7107789321648617`*^9}, {3.7107789661808095`*^9, 3.7107790412041025`*^9}, 
   3.7107811120535154`*^9, {3.7107817359922495`*^9, 3.7107817406455126`*^9}, {
   3.71087483028846*^9, 3.710874838160901*^9}, {3.710874879680277*^9, 
   3.7108748932330556`*^9}, 3.7108756004805655`*^9, {3.736194997883952*^9, 
   3.7361950278057995`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", ".02", "]"}], ",", 
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "3"}]}], "}"}], "]"}]}], "}"}]}], 
       "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Polygon", "/@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "WholeDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Thickness", "[", ".02", "]"}], ",", "Green", ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Polygon", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              "+", 
              RowBox[{
               RowBox[{
                RowBox[{"zrot", "[", "#", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "/", "2"}]}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"90", ",", "360", ",", "90"}], "]"}]}], "]"}]}], "}"}]}],
        "}"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"5", 
        RowBox[{"xyztp", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "140"}], ",", "60"}], "}"}], "]"}]}]}]}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7108116645540957`*^9, 3.710811757531419*^9}, {
  3.710874044242437*^9, 3.710874146913313*^9}, {3.7108742293970375`*^9, 
  3.710874235408381*^9}, {3.7108742793288965`*^9, 3.7108743178241005`*^9}, {
  3.710874366080868*^9, 3.71087466840018*^9}, {3.7422518021341333`*^9, 
  3.7422518888995514`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     Graphics3DBox[{{
        Polygon3DBox[
         NCache[{{-1, Rational[1, 3], 0}, {-1, Rational[1, 2] 
            3^Rational[-1, 2], Rational[1, 6]}, {-1, Rational[1, 6], 
            Rational[1, 2] 3^Rational[-1, 2]}, {-1, 0, Rational[1, 3]}, {-1, 
            Rational[-1, 6], Rational[1, 2] 3^Rational[-1, 2]}, {-1, 
            Rational[-1, 2] 3^Rational[-1, 2], Rational[1, 6]}, {-1, 
            Rational[-1, 3], 0}}, {{-1, 0.3333333333333333, 0}, {-1, 
            0.2886751345948129, 0.16666666666666666`}, {-1, 
            0.16666666666666666`, 0.2886751345948129}, {-1, 0, 
            0.3333333333333333}, {-1, -0.16666666666666666`, 
            0.2886751345948129}, {-1, -0.2886751345948129, 
            0.16666666666666666`}, {-1, -0.3333333333333333, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 3], 0}, {-1, Rational[1, 2] 
            3^Rational[-1, 2], Rational[1, 6]}, {0, 0, 
           0}}, {{-1, 0.3333333333333333, 0}, {-1, 0.2886751345948129, 
            0.16666666666666666`}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 2] 3^Rational[-1, 2], Rational[1, 6]}, {-1, 
            Rational[1, 6], Rational[1, 2] 3^Rational[-1, 2]}, {0, 0, 
           0}}, {{-1, 0.2886751345948129, 0.16666666666666666`}, {-1, 
            0.16666666666666666`, 0.2886751345948129}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 6], Rational[1, 2] 3^Rational[-1, 2]}, {-1, 
            0, Rational[1, 3]}, {0, 0, 
           0}}, {{-1, 0.16666666666666666`, 0.2886751345948129}, {-1, 0, 
            0.3333333333333333}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, 0, Rational[1, 3]}, {-1, Rational[-1, 6], 
            Rational[1, 2] 3^Rational[-1, 2]}, {0, 0, 
           0}}, {{-1, 0, 0.3333333333333333}, {-1, -0.16666666666666666`, 
            0.2886751345948129}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[-1, 6], Rational[1, 2] 3^Rational[-1, 2]}, {-1,
             Rational[-1, 2] 3^Rational[-1, 2], Rational[1, 6]}, {0, 0, 
           0}}, {{-1, -0.16666666666666666`, 
            0.2886751345948129}, {-1, -0.2886751345948129, 
            0.16666666666666666`}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[-1, 2] 3^Rational[-1, 2], Rational[1, 6]}, {-1,
             Rational[-1, 3], 0}, {0, 0, 
           0}}, {{-1, -0.2886751345948129, 
            0.16666666666666666`}, {-1, -0.3333333333333333, 0}, {0, 0, 
           0}}]]}, 
       {RGBColor[1, 0, 0], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 2], 0}, {-1, Rational[-1, 2], 0}, {
           0, Rational[-1, 2], 0}, {
           0, Rational[1, 2], 0}}, {{-1, 0.5, 0}, {-1, -0.5, 0}, {
           0, -0.5, 0}, {0, 0.5, 0}}]]}, 
       {PointSize[0.02], 
        Point3DBox[
         NCache[{-1, 0, Rational[-1, 3]}, {-1, 0, -0.3333333333333333}]]}},
      ViewPoint->
       NCache[{(Rational[-5, 2] 3^Rational[1, 2]) 
         Cos[40 Degree], (Rational[-5, 2] 3^Rational[1, 2]) Sin[40 Degree], 
         Rational[5, 2]}, {-3.3170697408446914`, -2.783351996132096, 2.5}]], {192., -189.},
      ImageScaled[{0.5, 0.5}], {360., 360.},
     ContentSelectable->True], InsetBox[
     Graphics3DBox[{{
        Polygon3DBox[
         NCache[{{-1, 0, Rational[1, 3]}, {-1, Rational[-1, 6], 
            Rational[1, 2] 3^Rational[-1, 2]}, {-1, Rational[-1, 2] 
            3^Rational[-1, 2], Rational[1, 6]}, {-1, Rational[-1, 3], 0}, {-1,
             Rational[-1, 2] 3^Rational[-1, 2], Rational[-1, 6]}, {-1, 
            Rational[-1, 6], Rational[-1, 2] 3^Rational[-1, 2]}, {-1, 0, 
            Rational[-1, 3]}, {-1, Rational[1, 6], Rational[-1, 2] 
            3^Rational[-1, 2]}, {-1, Rational[1, 2] 3^Rational[-1, 2], 
            Rational[-1, 6]}, {-1, Rational[1, 3], 0}, {-1, Rational[1, 2] 
            3^Rational[-1, 2], Rational[1, 6]}, {-1, Rational[1, 6], 
            Rational[1, 2] 3^Rational[-1, 2]}, {-1, 0, Rational[1, 3]}}, {{-1,
             0, 0.3333333333333333}, {-1, -0.16666666666666666`, 
            0.2886751345948129}, {-1, -0.2886751345948129, 
            0.16666666666666666`}, {-1, -0.3333333333333333, 
            0}, {-1, -0.2886751345948129, -0.16666666666666666`}, {-1, \
-0.16666666666666666`, -0.2886751345948129}, {-1, 
            0, -0.3333333333333333}, {-1, 
            0.16666666666666666`, -0.2886751345948129}, {-1, 
            0.2886751345948129, -0.16666666666666666`}, {-1, 
            0.3333333333333333, 0}, {-1, 0.2886751345948129, 
            0.16666666666666666`}, {-1, 0.16666666666666666`, 
            0.2886751345948129}, {-1, 0, 0.3333333333333333}}]], 
        Polygon3DBox[
         NCache[{{-1, 0, Rational[1, 3]}, {-1, Rational[-1, 6], 
            Rational[1, 2] 3^Rational[-1, 2]}, {0, 0, 
           0}}, {{-1, 0, 0.3333333333333333}, {-1, -0.16666666666666666`, 
            0.2886751345948129}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[-1, 6], Rational[1, 2] 3^Rational[-1, 2]}, {-1,
             Rational[-1, 2] 3^Rational[-1, 2], Rational[1, 6]}, {0, 0, 
           0}}, {{-1, -0.16666666666666666`, 
            0.2886751345948129}, {-1, -0.2886751345948129, 
            0.16666666666666666`}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[-1, 2] 3^Rational[-1, 2], Rational[1, 6]}, {-1,
             Rational[-1, 3], 0}, {0, 0, 
           0}}, {{-1, -0.2886751345948129, 
            0.16666666666666666`}, {-1, -0.3333333333333333, 0}, {0, 0, 0}}]],
         Polygon3DBox[
         NCache[{{-1, Rational[-1, 3], 0}, {-1, Rational[-1, 2] 
            3^Rational[-1, 2], Rational[-1, 6]}, {0, 0, 
           0}}, {{-1, -0.3333333333333333, 
            0}, {-1, -0.2886751345948129, -0.16666666666666666`}, {0, 0, 
           0}}]], Polygon3DBox[
         NCache[{{-1, Rational[-1, 2] 3^Rational[-1, 2], 
            Rational[-1, 6]}, {-1, Rational[-1, 6], Rational[-1, 2] 
            3^Rational[-1, 2]}, {0, 0, 
           0}}, {{-1, -0.2886751345948129, -0.16666666666666666`}, {-1, \
-0.16666666666666666`, -0.2886751345948129}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[-1, 6], Rational[-1, 2] 
            3^Rational[-1, 2]}, {-1, 0, Rational[-1, 3]}, {0, 0, 
           0}}, {{-1, -0.16666666666666666`, -0.2886751345948129}, {-1, 
            0, -0.3333333333333333}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, 0, Rational[-1, 3]}, {-1, Rational[1, 6], 
            Rational[-1, 2] 3^Rational[-1, 2]}, {0, 0, 
           0}}, {{-1, 0, -0.3333333333333333}, {-1, 
            0.16666666666666666`, -0.2886751345948129}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 6], Rational[-1, 2] 3^Rational[-1, 2]}, {-1,
             Rational[1, 2] 3^Rational[-1, 2], Rational[-1, 6]}, {0, 0, 
           0}}, {{-1, 0.16666666666666666`, -0.2886751345948129}, {-1, 
            0.2886751345948129, -0.16666666666666666`}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 2] 3^Rational[-1, 2], Rational[-1, 6]}, {-1,
             Rational[1, 3], 0}, {0, 0, 
           0}}, {{-1, 0.2886751345948129, -0.16666666666666666`}, {-1, 
            0.3333333333333333, 0}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 3], 0}, {-1, Rational[1, 2] 
            3^Rational[-1, 2], Rational[1, 6]}, {0, 0, 
           0}}, {{-1, 0.3333333333333333, 0}, {-1, 0.2886751345948129, 
            0.16666666666666666`}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 2] 3^Rational[-1, 2], Rational[1, 6]}, {-1, 
            Rational[1, 6], Rational[1, 2] 3^Rational[-1, 2]}, {0, 0, 
           0}}, {{-1, 0.2886751345948129, 0.16666666666666666`}, {-1, 
            0.16666666666666666`, 0.2886751345948129}, {0, 0, 0}}]], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 6], Rational[1, 2] 3^Rational[-1, 2]}, {-1, 
            0, Rational[1, 3]}, {0, 0, 
           0}}, {{-1, 0.16666666666666666`, 0.2886751345948129}, {-1, 0, 
            0.3333333333333333}, {0, 0, 0}}]]}, 
       {RGBColor[0, 1, 0], Thickness[0.02], 
        Line3DBox[{{0, 0, 0}, {1, 0, 0}}]}, 
       {RGBColor[1, 0, 0], 
        Polygon3DBox[
         NCache[{{-1, Rational[1, 2], 0}, {-1, Rational[-1, 2], 0}, {
           0, Rational[-1, 2], 0}, {
           0, Rational[1, 2], 0}}, {{-1, 0.5, 0}, {-1, -0.5, 0}, {
           0, -0.5, 0}, {0, 0.5, 0}}]]}},
      ViewPoint->
       NCache[{(Rational[-5, 2] 3^Rational[1, 2]) 
         Cos[40 Degree], (Rational[-5, 2] 3^Rational[1, 2]) Sin[40 Degree], 
         Rational[5, 2]}, {-3.3170697408446914`, -2.783351996132096, 2.5}]], {576., -189.},
      ImageScaled[{0.5, 0.5}], {360., 360.},
     ContentSelectable->True]}, {}},
  ContentSelectable->True,
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{{3.710874641146619*^9, 3.710874669258226*^9}, 
   3.7422518365558863`*^9, 
   3.7422518915401106`*^9},ImageCache->GraphicsData["CompressedBitmap", "\<\
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
vj/43/1eO/JfwMAr0Q==\
\>"]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3Dhalf", "[", 
     RowBox[{
     "TipPt_", ",", "Direction_", ",", "Normal_", ",", "ArrowScale_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"Polygon", "/@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"TipPt", "+", 
           RowBox[{"ArrowScale", "*", 
            RowBox[{
             RowBox[{"UofSN", "[", 
              RowBox[{"Direction", ",", "Normal"}], "]"}], ".", "#"}]}]}], 
          "&"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "HalfDisk", "}"}], ",", 
           RowBox[{"ConePoly", "/@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "90"}], ",", "60", ",", "30"}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Direction", " ", "and", " ", "Normal", " ", "vectors", " ", "must", " ", 
     "be", " ", "perpendicular"}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"TipPt_", ",", "Direction_", ",", "ArrowScale_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", 
      RowBox[{"Opacity", "[", "1", "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"Direction", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{"-", "\[Pi]"}], "/", "2"}], "]"}], ".", "#"}]}]}], 
            "&"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TipPt", "+", 
             RowBox[{"ArrowScale", "*", 
              RowBox[{
               RowBox[{"ZRot", "[", 
                RowBox[{"Theta", "[", "Direction", "]"}], "]"}], ".", 
               RowBox[{"YRot", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "\[Pi]"}], "/", "2"}], "+", 
                 RowBox[{"Phi", "[", "Direction", "]"}]}], "]"}], ".", 
               "#"}]}]}], "&"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "WholeDisk", "}"}], ",", 
             RowBox[{"ConePoly", "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "330", ",", "30"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], "}"}]}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{{3.710779889690693*^9, 3.710779919045374*^9}, {
   3.7107799708053384`*^9, 3.710779974964576*^9}, {3.710780028709654*^9, 
   3.7107800471567097`*^9}, {3.7107807853978124`*^9, 
   3.7107808081331143`*^9}, {3.710780838660859*^9, 3.710780839860928*^9}, {
   3.7107809423407965`*^9, 3.710780944388914*^9}, {3.7107811883588886`*^9, 
   3.7107811918130865`*^9}, 3.710781563014344*^9, {3.7107851253825755`*^9, 
   3.710785151318061*^9}, {3.7107862235734615`*^9, 3.7107862546782465`*^9}, {
   3.710786354039937*^9, 3.710786361413356*^9}, {3.7107864015606537`*^9, 
   3.7107864475902967`*^9}, 3.7107864923428593`*^9, {3.7108747054413085`*^9, 
   3.710874753537052*^9}, {3.7109019519823785`*^9, 3.7109019569566593`*^9}, 
   3.7422539345506487`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"CirclePoint", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{"j", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "3"}], "}"}]}], "+", 
        RowBox[{
         RowBox[{"zrot", "[", "i", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ")"}]}], "]"}]}], ";",
    " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"watch", " ", "out"}], ";", " ", 
      RowBox[{
      "there", " ", "is", " ", "another", " ", "CirclePoint", " ", "in", " ", 
       "the", " ", "streetlight_parhelia", " ", "file"}]}], ",", " ", 
     RowBox[{"for", " ", "Minnaert", " ", "cigar"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ConePoly", "[", "i_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CirclePoint", "[", 
       RowBox[{"i", ",", "1"}], "]"}], ",", 
      RowBox[{"CirclePoint", "[", 
       RowBox[{
        RowBox[{"i", "+", "30"}], ",", "1"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"CenterDisk", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], " ", ":=", 
    RowBox[{"v2", "+", 
     RowBox[{"scale", "*", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CirclePoint", "[", 
           RowBox[{"0", ",", "1"}], "]"}], "+", 
          RowBox[{"CirclePoint", "[", 
           RowBox[{"180", ",", "1"}], "]"}]}], ")"}], "/", "2"}]}]}]}]}], ";",
    "\n", 
   RowBox[{
    RowBox[{"ConeVertex", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], " ", ":=", 
    RowBox[{"v2", "+", 
     RowBox[{"scale", "*", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"vertical", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
       RowBox[{"CirclePoint", "[", 
        RowBox[{"0", ",", "0"}], "]"}]}]}]}]}], ";", 
   RowBox[{
    RowBox[{"DiskPoly", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", "#"}]}]}], " ", 
       "&"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"CirclePoint", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "360", ",", "30"}], "]"}]}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ConePolyList", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", "#"}]}]}], " ", 
       "&"}], ",", 
      RowBox[{"ConePoly", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"30", ",", "360", ",", "30"}], "]"}]}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"CircleList", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v2", "+", 
        RowBox[{"scale", "*", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"vertical", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "]"}], ".", 
          RowBox[{"CirclePoint", "[", 
           RowBox[{
            RowBox[{"#", "+", "30"}], ",", "j"}], "]"}]}]}]}], " ", "&"}], 
      ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "360", ",", "30"}], "]"}]}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"ConePolyList", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"sign", " ", "added", " ", "April", " ", "2011"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n", 
      "\t\t                                                                   \
                                   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"DiskPoly", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "]"}]}], "}"}], ",",
       "\n", "\t                                             ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"CircleList", "[", 
            RowBox[{"v1", ",", "v2", ",", "scale", ",", "#"}], "]"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1", "/", "7"}]}], "]"}]}], ",", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapEyeward", "[", 
              RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
            "                     ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "may", " ", "have", " ", "to", " ", "adjust", " ", "eyeward", 
               " ", "distance", " ", "here"}], ";", " ", 
              StyleBox[
               RowBox[{
               "I", " ", "took", " ", "this", " ", "out", " ", "March", " ", 
                "2011"}],
               FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "+", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"ConeVertex", "[", 
               RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], ",", "\n", 
              "\t\t\t      ", 
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "-", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{
     "v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_", ",", "1"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "/@", 
         RowBox[{"ConePolyList", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"(*", " ", 
       StyleBox[
        RowBox[{"sign", " ", "added", " ", "April", " ", "2011"}],
        FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\n", 
      "\t\t                                                                   \
                                   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"GrayLevel", "[", "1", "]"}], ",", 
        RowBox[{"Polygon", "[", 
         RowBox[{"DiskPoly", "[", 
          RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "]"}]}], "}"}], ",",
       "\n", "\t                                             ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"CircleList", "[", 
            RowBox[{"v1", ",", "v2", ",", "scale", ",", "#"}], "]"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "1", ",", 
           RowBox[{"1", "/", "7"}]}], "]"}]}], ",", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{"False", ",", 
          RowBox[{"Line", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MapEyeward", "[", 
              RowBox[{"#", ",", ".01", ",", "eye"}], "]"}], "&"}], "/@", 
            "                     ", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "may", " ", "have", " ", "to", " ", "adjust", " ", "eyeward", 
               " ", "distance", " ", "here"}], ";", " ", 
              StyleBox[
               RowBox[{
               "I", " ", "took", " ", "this", " ", "out", " ", "March", " ", 
                "2011"}],
               FontColor->RGBColor[1, 0, 0]]}], " ", "*)"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "+", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}], ",", 
              RowBox[{"ConeVertex", "[", 
               RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], ",", "\n", 
              "\t\t\t      ", 
              RowBox[{
               RowBox[{"CenterDisk", "[", 
                RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}], "-", 
               RowBox[{"scale", "*", 
                RowBox[{"unit", "[", 
                 RowBox[{"Cross", "[", 
                  RowBox[{
                   RowBox[{"eye", "-", 
                    RowBox[{"CenterDisk", "[", 
                    RowBox[{"v1", ",", "v2", ",", "scale"}], "]"}]}], ",", 
                   RowBox[{"v2", "-", "v1"}]}], "]"}], "]"}]}]}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrow3D", "[", 
     RowBox[{"v1_", ",", "v2_", ",", "scale_", ",", "tkns_", ",", "eye_", ",", 
      RowBox[{"-", "1"}]}], "]"}], ":=", 
    RowBox[{"Arrow3D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"2", "v2"}], "-", "v1"}], ",", 
      RowBox[{"v2", "+", 
       RowBox[{"3.2", "scale", "*", 
        RowBox[{"unit", "[", 
         RowBox[{"v1", "-", "v2"}], "]"}]}]}], ",", "scale", ",", "tkns", ",",
       "eye", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfWayIndex", "[", "PtList_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"PtList", "[", 
            RowBox[{"[", "#", "]"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "PtList", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"length", "[", 
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"PtList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"PtList", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "2"]}], "]"}], "<", 
         RowBox[{"length", "[", 
          RowBox[{
           RowBox[{"#2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"PtList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"PtList", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "2"]}], "]"}]}], "&"}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HalfWayArrow", "[", 
     RowBox[{"PtList_", ",", "ArrowScale_", ",", "tkns_", ",", "sign_"}], 
     "]"}], ":=", 
    RowBox[{"Arrow3D", "[", 
     RowBox[{
      RowBox[{"PtList", "[", 
       RowBox[{"[", 
        RowBox[{"HalfWayIndex", "[", "PtList", "]"}], "]"}], "]"}], ",", 
      RowBox[{"PtList", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"HalfWayIndex", "[", "PtList", "]"}], "+", "1"}], "]"}], 
       "]"}], ",", "ArrowScale", ",", 
      RowBox[{".3", "tkns"}], ",", "eye", ",", "sign"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.5005816242648864`*^9, {3.5097430914250536`*^9, 3.5097431414351225`*^9}, {
   3.5123906340047293`*^9, 3.512390671264781*^9}, {3.512390746624885*^9, 
   3.512390747434886*^9}, 3.5123908159849806`*^9, {3.5123908557050357`*^9, 
   3.5123908569650373`*^9}, {3.513262578763157*^9, 3.5132626713805184`*^9}, {
   3.5132627439206448`*^9, 3.5132627869611197`*^9}, {3.513263055063187*^9, 
   3.5132630931116533`*^9}, {3.5132633850193624`*^9, 3.5132633855809636`*^9}, 
   3.5132634755307207`*^9, {3.5132635813145046`*^9, 3.513263610190155*^9}, {
   3.6009722049394665`*^9, 3.6009722059794683`*^9}, {3.7108738247978697`*^9, 
   3.7108738292011223`*^9}}],

Cell[TextData[{
 "POINT P ON THE SPHERE IS VISIBLE FROM THE VIEWPOINT ",
 StyleBox["EYE",
  FontSlant->"Italic"],
 " IFF ",
 StyleBox["SEE[P,EYE]",
  FontSlant->"Italic"],
 ".\n",
 StyleBox["SEE",
  FontSlant->"Italic"],
 " IS NEEDED FOR LAST EXAMPLE IN NUMERAL FILE."
}], "SmallText",
 Evaluatable->False,
 AspectRatioFixed->True,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeeOnSphere", "[", 
    RowBox[{"p_", ",", "n_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ScalarProj", "[", 
     RowBox[{"p", ",", "eye"}], "]"}], ">", 
    FractionBox[
     SuperscriptBox["n", "2"], 
     RowBox[{"length", "[", "eye", "]"}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"VisibleSegments", "[", 
    RowBox[{"SegmentList_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{"SegmentList", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"see", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], "&&", 
       RowBox[{"see", "[", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "&"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ThirdSegments", "[", "PointList_", "]"}], ":=", 
   RowBox[{
    RowBox[{"SegmentList", "[", "PointList", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"#", ",", "3"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VisibleCurve", "[", 
     RowBox[{
     "PointList_", ",", "n_", ",", "eye_", ",", "tkns_", ",", "hue_"}], "]"}],
     ":=", 
    RowBox[{"{", 
     RowBox[{"hue", ",", 
      RowBox[{"Thickness", "[", "tkns", "]"}], ",", 
      RowBox[{"Line", "/@", 
       RowBox[{"VisibleSegments", "[", 
        RowBox[{
         RowBox[{"SegmentList", "[", "PointList", "]"}], ",", 
         RowBox[{
          RowBox[{"SeeOnSphere", "[", 
           RowBox[{"#1", ",", "n", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
     "}"}]}], ";"}], "    ", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"no", " ", "longer", " ", "Graphics3D"}], ",", " ", 
     RowBox[{"May", " ", "2012"}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"WholeCurve", "[", 
    RowBox[{
    "PointList_", ",", "n_", ",", "eye_", ",", "ThicknessSolid_", ",", 
     "ThicknessDashed_", ",", "hue_"}], "]"}], ":=", "             ", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{
      RowBox[{"no", " ", "longer", " ", "Graphics3D"}], ",", " ", 
      RowBox[{"May", " ", "2012"}]}],
     FontColor->RGBColor[1, 0, 0]], " ", "*)"}], 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"Thickness", "[", "ThicknessDashed", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"ThirdSegments", "[", "PointList", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"hue", ",", 
       RowBox[{"Thickness", "[", "ThicknessSolid", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"VisibleSegments", "[", 
         RowBox[{
          RowBox[{"SegmentList", "[", "PointList", "]"}], ",", 
          RowBox[{
           RowBox[{"SeeOnSphere", "[", 
            RowBox[{"#1", ",", "n", ",", "eye"}], "]"}], "&"}]}], "]"}]}]}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tpGraphics", "[", 
    RowBox[{
    "v_", ",", "eye_", ",", "ThicknessSolid_", ",", "ThicknessDashed_"}], 
    "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"WholeCurve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"zrot", "[", 
           RowBox[{"theta", "[", "v", "]"}], "]"}], ".", 
          RowBox[{"yrot", "[", 
           RowBox[{"-", "#"}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"90", 
           RowBox[{"sign", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"2", 
           RowBox[{"sign", "[", 
            RowBox[{"v", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "]"}]}], ",", "1", 
       ",", "eye", ",", "ThicknessSolid", ",", "ThicknessDashed"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Thickness", "[", 
         RowBox[{".9", "ThicknessSolid"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"xyztp", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"theta", "[", "v", "]"}], ",", "90"}], "}"}], "]"}]}], 
          "}"}], "]"}]}], "}"}], "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.508994997710577*^9, 3.508995003140585*^9}, {
   3.508995045550643*^9, 3.5089950596506624`*^9}, {3.5089952524409285`*^9, 
   3.508995259730939*^9}, {3.5118744273638315`*^9, 3.5118744292046347`*^9}, {
   3.5118747205039425`*^9, 3.511874734590767*^9}, {3.5118748654593954`*^9, 
   3.511874892166642*^9}, {3.511874992084816*^9, 3.5118750118344507`*^9}, 
   3.511875082190573*^9, 3.51187521798881*^9, {3.511878399458357*^9, 
   3.511878404684366*^9}, {3.546998714978611*^9, 3.5469987978266563`*^9}, {
   3.5469988311471148`*^9, 3.546998862156869*^9}, {3.546999511237503*^9, 
   3.546999533795142*^9}, {3.546999695380224*^9, 3.5469997008090334`*^9}, {
   3.546999780493973*^9, 3.5469998116784267`*^9}}]
}, Open  ]],

Cell["EXAMPLE:", "SmallText",
 CellChangeTimes->{{3.5947403421074266`*^9, 3.594740361376954*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eye", "=", 
   RowBox[{"10", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1"}], "}"}]}]}], ";", 
  RowBox[{"Graphics3D", "[", 
   RowBox[{
    RowBox[{"WholeCurve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"zrot", "[", "#", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "&"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "360", ",", "3"}], "]"}]}], ",", "1", ",", "eye", 
      ",", ".003", ",", ".002", ",", "Red"}], "]"}], ",", 
    RowBox[{"ViewPoint", "\[Rule]", "eye"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5469995769448175`*^9, 3.5469996772373924`*^9}, {
  3.546999727890681*^9, 3.5469997352070937`*^9}, {3.594740385729488*^9, 
  3.5947404707731094`*^9}}],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Thickness[0.002], 
    Line3DBox[
     NCache[{{1, 0, 0}, {Cos[3 Degree], Sin[3 Degree], 0}}, {{1, 0, 0}, {
       0.9986295347545738, 0.052335956242943835`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[9 Degree], Sin[9 Degree], 0}, {
       Cos[12 Degree], Sin[12 Degree], 0}}, {{
       0.9876883405951378, 0.15643446504023087`, 0}, {
       0.9781476007338057, 0.20791169081775934`, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (-1 + 5^Rational[1, 2]), 0}, {
       Cos[21 Degree], Sin[21 Degree], 0}}, {{
       0.9510565162951535, 0.30901699437494745`, 0}, {
       0.9335804264972017, 0.35836794954530027`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[27 Degree], Sin[27 Degree], 0}, {
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 0}}, {{
       0.8910065241883679, 0.45399049973954675`, 0}, {
       0.8660254037844386, 0.5, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (1 + 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {
       Cos[39 Degree], Sin[39 Degree], 0}}, {{
       0.8090169943749475, 0.5877852522924731, 0}, {
       0.7771459614569709, 0.6293203910498374, 0}}]], 
    Line3DBox[
     NCache[{{2^Rational[-1, 2], 2^Rational[-1, 2], 0}, {
       Sin[42 Degree], Cos[42 Degree], 0}}, {{
       0.7071067811865475, 0.7071067811865475, 0}, {
       0.6691306063588582, 0.7431448254773942, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[-1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (1 + 5^Rational[1, 2]), 0}, {
       Sin[33 Degree], Cos[33 Degree], 0}}, {{
       0.5877852522924731, 0.8090169943749475, 0}, {
       0.5446390350150271, 0.838670567945424, 0}}]], 
    Line3DBox[
     NCache[{{Sin[27 Degree], Cos[27 Degree], 0}, {
       Sin[24 Degree], Cos[24 Degree], 0}}, {{
       0.45399049973954675`, 0.8910065241883679, 0}, {
       0.4067366430758002, 0.9135454576426009, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (-1 + 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[1, 8] 5^Rational[1, 2])^Rational[1, 2], 
        0}, {(Rational[1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), 0}}, {{
       0.30901699437494745`, 0.9510565162951535, 0}, {
       0.2588190451025207, 0.9659258262890682, 0}}]], 
    Line3DBox[
     NCache[{{Sin[9 Degree], Cos[9 Degree], 0}, {
       Sin[6 Degree], Cos[6 Degree], 0}}, {{
       0.15643446504023087`, 0.9876883405951378, 0}, {
       0.10452846326765347`, 0.9945218953682733, 0}}]], 
    Line3DBox[
     NCache[{{0, 1, 0}, {-Sin[3 Degree], Cos[3 Degree], 0}}, {{0, 1, 
       0}, {-0.052335956242943835`, 0.9986295347545738, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[9 Degree], Cos[9 Degree], 0}, {-Sin[12 Degree], Cos[
        12 Degree], 0}}, {{-0.15643446504023087`, 0.9876883405951378, 
        0}, {-0.20791169081775934`, 0.9781476007338057, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (1 - 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {-
        Sin[21 Degree], Cos[21 Degree], 0}}, {{-0.30901699437494745`, 
        0.9510565162951535, 0}, {-0.35836794954530027`, 0.9335804264972017, 
        0}}]], Line3DBox[
     NCache[{{-Sin[27 Degree], Cos[27 Degree], 0}, {
       Rational[-1, 2], Rational[1, 2] 3^Rational[1, 2], 
        0}}, {{-0.45399049973954675`, 0.8910065241883679, 0}, {-0.5, 
        0.8660254037844386, 0}}]], 
    Line3DBox[
     NCache[{{-(Rational[5, 8] + Rational[-1, 8] 5^Rational[1, 2])^
         Rational[1, 2], Rational[1, 4] (1 + 5^Rational[1, 2]), 0}, {-
        Sin[39 Degree], Cos[39 Degree], 0}}, {{-0.5877852522924731, 
        0.8090169943749475, 0}, {-0.6293203910498374, 0.7771459614569709, 
        0}}]], Line3DBox[
     NCache[{{-2^Rational[-1, 2], 2^Rational[-1, 2], 0}, {-Cos[42 Degree], 
        Sin[42 Degree], 0}}, {{-0.7071067811865475, 0.7071067811865475, 
        0}, {-0.7431448254773942, 0.6691306063588582, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (-1 - 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {-
        Cos[33 Degree], Sin[33 Degree], 0}}, {{-0.8090169943749475, 
        0.5877852522924731, 0}, {-0.838670567945424, 0.5446390350150271, 
        0}}]], Line3DBox[
     NCache[{{-Cos[27 Degree], Sin[27 Degree], 0}, {-Cos[24 Degree], Sin[
        24 Degree], 0}}, {{-0.8910065241883679, 0.45399049973954675`, 
        0}, {-0.9135454576426009, 0.4067366430758002, 0}}]], 
    Line3DBox[
     NCache[{{-(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
         Rational[1, 2], Rational[1, 4] (-1 + 5^Rational[1, 2]), 
        0}, {(Rational[-1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), 
        0}}, {{-0.9510565162951535, 0.30901699437494745`, 
        0}, {-0.9659258262890682, 0.2588190451025207, 0}}]], 
    Line3DBox[
     NCache[{{-Cos[9 Degree], Sin[9 Degree], 0}, {-Cos[6 Degree], Sin[
        6 Degree], 0}}, {{-0.9876883405951378, 0.15643446504023087`, 
        0}, {-0.9945218953682733, 0.10452846326765347`, 0}}]], 
    Line3DBox[
     NCache[{{-1, 0, 0}, {-Cos[3 Degree], -Sin[3 Degree], 0}}, {{-1, 0, 
       0}, {-0.9986295347545738, -0.052335956242943835`, 0}}]], 
    Line3DBox[
     NCache[{{-Cos[9 Degree], -Sin[9 Degree], 0}, {-Cos[12 Degree], -
        Sin[12 Degree], 0}}, {{-0.9876883405951378, -0.15643446504023087`, 
        0}, {-0.9781476007338057, -0.20791169081775934`, 0}}]], 
    Line3DBox[
     NCache[{{-(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
         Rational[1, 2], Rational[1, 4] (1 - 5^Rational[1, 2]), 0}, {-
        Cos[21 Degree], -Sin[21 Degree], 
        0}}, {{-0.9510565162951535, -0.30901699437494745`, 
        0}, {-0.9335804264972017, -0.35836794954530027`, 0}}]], 
    Line3DBox[
     NCache[{{-Cos[27 Degree], -Sin[27 Degree], 0}, {
       Rational[-1, 2] 3^Rational[1, 2], Rational[-1, 2], 
        0}}, {{-0.8910065241883679, -0.45399049973954675`, 
        0}, {-0.8660254037844386, -0.5, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (-1 - 5^
         Rational[1, 2]), -(Rational[5, 8] + 
          Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {-
        Cos[39 Degree], -Sin[39 Degree], 
        0}}, {{-0.8090169943749475, -0.5877852522924731, 
        0}, {-0.7771459614569709, -0.6293203910498374, 0}}]], 
    Line3DBox[
     NCache[{{-2^Rational[-1, 2], -2^Rational[-1, 2], 0}, {-Sin[42 Degree], -
        Cos[42 Degree], 0}}, {{-0.7071067811865475, -0.7071067811865475, 
        0}, {-0.6691306063588582, -0.7431448254773942, 0}}]], 
    Line3DBox[
     NCache[{{-(Rational[5, 8] + Rational[-1, 8] 5^Rational[1, 2])^
         Rational[1, 2], Rational[1, 4] (-1 - 5^Rational[1, 2]), 0}, {-
        Sin[33 Degree], -Cos[33 Degree], 
        0}}, {{-0.5877852522924731, -0.8090169943749475, 
        0}, {-0.5446390350150271, -0.838670567945424, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[27 Degree], -Cos[27 Degree], 0}, {-Sin[24 Degree], -
        Cos[24 Degree], 0}}, {{-0.45399049973954675`, -0.8910065241883679, 
        0}, {-0.4067366430758002, -0.9135454576426009, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (1 - 5^
         Rational[1, 2]), -(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
         Rational[1, 2], 
        0}, {(Rational[-1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), (
         Rational[-1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), 
        0}}, {{-0.30901699437494745`, -0.9510565162951535, 
        0}, {-0.2588190451025207, -0.9659258262890682, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[9 Degree], -Cos[9 Degree], 0}, {-Sin[6 Degree], -
        Cos[6 Degree], 0}}, {{-0.15643446504023087`, -0.9876883405951378, 
        0}, {-0.10452846326765347`, -0.9945218953682733, 0}}]], 
    Line3DBox[
     NCache[{{0, -1, 0}, {Sin[3 Degree], -Cos[3 Degree], 0}}, {{0, -1, 0}, {
       0.052335956242943835`, -0.9986295347545738, 0}}]], 
    Line3DBox[
     NCache[{{Sin[9 Degree], -Cos[9 Degree], 0}, {
       Sin[12 Degree], -Cos[12 Degree], 0}}, {{
       0.15643446504023087`, -0.9876883405951378, 0}, {
       0.20791169081775934`, -0.9781476007338057, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (-1 + 
         5^Rational[1, 2]), -(Rational[5, 8] + 
          Rational[1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {
       Sin[21 Degree], -Cos[21 Degree], 0}}, {{
       0.30901699437494745`, -0.9510565162951535, 0}, {
       0.35836794954530027`, -0.9335804264972017, 0}}]], 
    Line3DBox[
     NCache[{{Sin[27 Degree], -Cos[27 Degree], 0}, {
       Rational[1, 2], Rational[-1, 2] 3^Rational[1, 2], 0}}, {{
       0.45399049973954675`, -0.8910065241883679, 0}, {
       0.5, -0.8660254037844386, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[-1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (-1 - 5^Rational[1, 2]), 0}, {
       Sin[39 Degree], -Cos[39 Degree], 0}}, {{
       0.5877852522924731, -0.8090169943749475, 0}, {
       0.6293203910498374, -0.7771459614569709, 0}}]], 
    Line3DBox[
     NCache[{{2^Rational[-1, 2], -2^Rational[-1, 2], 0}, {
       Cos[42 Degree], -Sin[42 Degree], 0}}, {{
       0.7071067811865475, -0.7071067811865475, 0}, {
       0.7431448254773942, -0.6691306063588582, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (1 + 
         5^Rational[1, 2]), -(Rational[5, 8] + 
          Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {
       Cos[33 Degree], -Sin[33 Degree], 0}}, {{
       0.8090169943749475, -0.5877852522924731, 0}, {
       0.838670567945424, -0.5446390350150271, 0}}]], 
    Line3DBox[
     NCache[{{Cos[27 Degree], -Sin[27 Degree], 0}, {
       Cos[24 Degree], -Sin[24 Degree], 0}}, {{
       0.8910065241883679, -0.45399049973954675`, 0}, {
       0.9135454576426009, -0.4067366430758002, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (1 - 5^Rational[1, 2]), 
        0}, {(Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), (
         Rational[-1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), 0}}, {{
       0.9510565162951535, -0.30901699437494745`, 0}, {
       0.9659258262890682, -0.2588190451025207, 0}}]], 
    Line3DBox[
     NCache[{{Cos[9 Degree], -Sin[9 Degree], 0}, {
       Cos[6 Degree], -Sin[6 Degree], 0}}, {{
       0.9876883405951378, -0.15643446504023087`, 0}, {
       0.9945218953682733, -0.10452846326765347`, 0}}]]}, 
   {RGBColor[1, 0, 0], Thickness[0.003], 
    Line3DBox[
     NCache[{{1, 0, 0}, {Cos[3 Degree], Sin[3 Degree], 0}}, {{1, 0, 0}, {
       0.9986295347545738, 0.052335956242943835`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[3 Degree], Sin[3 Degree], 0}, {
       Cos[6 Degree], Sin[6 Degree], 0}}, {{
       0.9986295347545738, 0.052335956242943835`, 0}, {
       0.9945218953682733, 0.10452846326765347`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[6 Degree], Sin[6 Degree], 0}, {
       Cos[9 Degree], Sin[9 Degree], 0}}, {{
       0.9945218953682733, 0.10452846326765347`, 0}, {
       0.9876883405951378, 0.15643446504023087`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[9 Degree], Sin[9 Degree], 0}, {
       Cos[12 Degree], Sin[12 Degree], 0}}, {{
       0.9876883405951378, 0.15643446504023087`, 0}, {
       0.9781476007338057, 0.20791169081775934`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[12 Degree], Sin[12 Degree], 
        0}, {(Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), 0}}, {{
       0.9781476007338057, 0.20791169081775934`, 0}, {
       0.9659258262890682, 0.2588190451025207, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), 
        0}, {(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (-1 + 5^Rational[1, 2]), 0}}, {{
       0.9659258262890682, 0.2588190451025207, 0}, {
       0.9510565162951535, 0.30901699437494745`, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (-1 + 5^Rational[1, 2]), 0}, {
       Cos[21 Degree], Sin[21 Degree], 0}}, {{
       0.9510565162951535, 0.30901699437494745`, 0}, {
       0.9335804264972017, 0.35836794954530027`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[21 Degree], Sin[21 Degree], 0}, {
       Cos[24 Degree], Sin[24 Degree], 0}}, {{
       0.9335804264972017, 0.35836794954530027`, 0}, {
       0.9135454576426009, 0.4067366430758002, 0}}]], 
    Line3DBox[
     NCache[{{Cos[24 Degree], Sin[24 Degree], 0}, {
       Cos[27 Degree], Sin[27 Degree], 0}}, {{
       0.9135454576426009, 0.4067366430758002, 0}, {
       0.8910065241883679, 0.45399049973954675`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[27 Degree], Sin[27 Degree], 0}, {
       Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 0}}, {{
       0.8910065241883679, 0.45399049973954675`, 0}, {
       0.8660254037844386, 0.5, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 2] 3^Rational[1, 2], Rational[1, 2], 0}, {
       Cos[33 Degree], Sin[33 Degree], 0}}, {{0.8660254037844386, 0.5, 0}, {
       0.838670567945424, 0.5446390350150271, 0}}]], 
    Line3DBox[
     NCache[{{Cos[33 Degree], Sin[33 Degree], 0}, {
       Rational[1, 4] (1 + 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}}, {{
       0.838670567945424, 0.5446390350150271, 0}, {
       0.8090169943749475, 0.5877852522924731, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (1 + 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {
       Cos[39 Degree], Sin[39 Degree], 0}}, {{
       0.8090169943749475, 0.5877852522924731, 0}, {
       0.7771459614569709, 0.6293203910498374, 0}}]], 
    Line3DBox[
     NCache[{{Cos[39 Degree], Sin[39 Degree], 0}, {
       Cos[42 Degree], Sin[42 Degree], 0}}, {{
       0.7771459614569709, 0.6293203910498374, 0}, {
       0.7431448254773942, 0.6691306063588582, 0}}]], 
    Line3DBox[
     NCache[{{Cos[42 Degree], Sin[42 Degree], 0}, {
       2^Rational[-1, 2], 2^Rational[-1, 2], 0}}, {{
       0.7431448254773942, 0.6691306063588582, 0}, {
       0.7071067811865475, 0.7071067811865475, 0}}]], 
    Line3DBox[
     NCache[{{2^Rational[-1, 2], 2^Rational[-1, 2], 0}, {
       Sin[42 Degree], Cos[42 Degree], 0}}, {{
       0.7071067811865475, 0.7071067811865475, 0}, {
       0.6691306063588582, 0.7431448254773942, 0}}]], 
    Line3DBox[
     NCache[{{Sin[42 Degree], Cos[42 Degree], 0}, {
       Sin[39 Degree], Cos[39 Degree], 0}}, {{
       0.6691306063588582, 0.7431448254773942, 0}, {
       0.6293203910498374, 0.7771459614569709, 0}}]], 
    Line3DBox[
     NCache[{{Sin[39 Degree], Cos[39 Degree], 
        0}, {(Rational[5, 8] + Rational[-1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (1 + 5^Rational[1, 2]), 0}}, {{
       0.6293203910498374, 0.7771459614569709, 0}, {
       0.5877852522924731, 0.8090169943749475, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[-1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (1 + 5^Rational[1, 2]), 0}, {
       Sin[33 Degree], Cos[33 Degree], 0}}, {{
       0.5877852522924731, 0.8090169943749475, 0}, {
       0.5446390350150271, 0.838670567945424, 0}}]], 
    Line3DBox[
     NCache[{{Sin[33 Degree], Cos[33 Degree], 0}, {
       Rational[1, 2], Rational[1, 2] 3^Rational[1, 2], 0}}, {{
       0.5446390350150271, 0.838670567945424, 0}, {
       0.5, 0.8660254037844386, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 2], Rational[1, 2] 3^Rational[1, 2], 0}, {
       Sin[27 Degree], Cos[27 Degree], 0}}, {{0.5, 0.8660254037844386, 0}, {
       0.45399049973954675`, 0.8910065241883679, 0}}]], 
    Line3DBox[
     NCache[{{Sin[27 Degree], Cos[27 Degree], 0}, {
       Sin[24 Degree], Cos[24 Degree], 0}}, {{
       0.45399049973954675`, 0.8910065241883679, 0}, {
       0.4067366430758002, 0.9135454576426009, 0}}]], 
    Line3DBox[
     NCache[{{Sin[24 Degree], Cos[24 Degree], 0}, {
       Sin[21 Degree], Cos[21 Degree], 0}}, {{
       0.4067366430758002, 0.9135454576426009, 0}, {
       0.35836794954530027`, 0.9335804264972017, 0}}]], 
    Line3DBox[
     NCache[{{Sin[21 Degree], Cos[21 Degree], 0}, {
       Rational[1, 4] (-1 + 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}}, {{
       0.35836794954530027`, 0.9335804264972017, 0}, {
       0.30901699437494745`, 0.9510565162951535, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (-1 + 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[1, 8] 5^Rational[1, 2])^Rational[1, 2], 
        0}, {(Rational[1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), 0}}, {{
       0.30901699437494745`, 0.9510565162951535, 0}, {
       0.2588190451025207, 0.9659258262890682, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), 0}, {
       Sin[12 Degree], Cos[12 Degree], 0}}, {{
       0.2588190451025207, 0.9659258262890682, 0}, {
       0.20791169081775934`, 0.9781476007338057, 0}}]], 
    Line3DBox[
     NCache[{{Sin[12 Degree], Cos[12 Degree], 0}, {
       Sin[9 Degree], Cos[9 Degree], 0}}, {{
       0.20791169081775934`, 0.9781476007338057, 0}, {
       0.15643446504023087`, 0.9876883405951378, 0}}]], 
    Line3DBox[
     NCache[{{Sin[9 Degree], Cos[9 Degree], 0}, {
       Sin[6 Degree], Cos[6 Degree], 0}}, {{
       0.15643446504023087`, 0.9876883405951378, 0}, {
       0.10452846326765347`, 0.9945218953682733, 0}}]], 
    Line3DBox[
     NCache[{{Sin[6 Degree], Cos[6 Degree], 0}, {
       Sin[3 Degree], Cos[3 Degree], 0}}, {{
       0.10452846326765347`, 0.9945218953682733, 0}, {
       0.052335956242943835`, 0.9986295347545738, 0}}]], 
    Line3DBox[
     NCache[{{Sin[3 Degree], Cos[3 Degree], 0}, {0, 1, 0}}, {{
       0.052335956242943835`, 0.9986295347545738, 0}, {0, 1, 0}}]], 
    Line3DBox[
     NCache[{{0, 1, 0}, {-Sin[3 Degree], Cos[3 Degree], 0}}, {{0, 1, 
       0}, {-0.052335956242943835`, 0.9986295347545738, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[3 Degree], Cos[3 Degree], 0}, {-Sin[6 Degree], Cos[
        6 Degree], 0}}, {{-0.052335956242943835`, 0.9986295347545738, 
        0}, {-0.10452846326765347`, 0.9945218953682733, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[6 Degree], Cos[6 Degree], 0}, {-Sin[9 Degree], Cos[
        9 Degree], 0}}, {{-0.10452846326765347`, 0.9945218953682733, 
        0}, {-0.15643446504023087`, 0.9876883405951378, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[9 Degree], Cos[9 Degree], 0}, {-Sin[12 Degree], Cos[
        12 Degree], 0}}, {{-0.15643446504023087`, 0.9876883405951378, 
        0}, {-0.20791169081775934`, 0.9781476007338057, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[12 Degree], Cos[12 Degree], 
        0}, {(Rational[-1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), 
        0}}, {{-0.20791169081775934`, 0.9781476007338057, 
        0}, {-0.2588190451025207, 0.9659258262890682, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[-1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), (
         Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), 0}, {
       Rational[1, 4] (1 - 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[1, 8] 5^Rational[1, 2])^Rational[1, 2], 
        0}}, {{-0.2588190451025207, 0.9659258262890682, 
        0}, {-0.30901699437494745`, 0.9510565162951535, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (1 - 5^Rational[1, 2]), (Rational[5, 8] + 
         Rational[1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {-
        Sin[21 Degree], Cos[21 Degree], 0}}, {{-0.30901699437494745`, 
        0.9510565162951535, 0}, {-0.35836794954530027`, 0.9335804264972017, 
        0}}]], Line3DBox[
     NCache[{{-Sin[21 Degree], Cos[21 Degree], 0}, {-Sin[24 Degree], Cos[
        24 Degree], 0}}, {{-0.35836794954530027`, 0.9335804264972017, 
        0}, {-0.4067366430758002, 0.9135454576426009, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[24 Degree], Cos[24 Degree], 0}, {-Sin[27 Degree], Cos[
        27 Degree], 0}}, {{-0.4067366430758002, 0.9135454576426009, 
        0}, {-0.45399049973954675`, 0.8910065241883679, 0}}]], 
    Line3DBox[
     NCache[{{-Sin[27 Degree], Cos[27 Degree], 0}, {
       Rational[-1, 2], Rational[1, 2] 3^Rational[1, 2], 
        0}}, {{-0.45399049973954675`, 0.8910065241883679, 0}, {-0.5, 
        0.8660254037844386, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[-1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (-1 - 5^Rational[1, 2]), 0}, {
       Sin[39 Degree], -Cos[39 Degree], 0}}, {{
       0.5877852522924731, -0.8090169943749475, 0}, {
       0.6293203910498374, -0.7771459614569709, 0}}]], 
    Line3DBox[
     NCache[{{Sin[39 Degree], -Cos[39 Degree], 0}, {
       Sin[42 Degree], -Cos[42 Degree], 0}}, {{
       0.6293203910498374, -0.7771459614569709, 0}, {
       0.6691306063588582, -0.7431448254773942, 0}}]], 
    Line3DBox[
     NCache[{{Sin[42 Degree], -Cos[42 Degree], 0}, {
       2^Rational[-1, 2], -2^Rational[-1, 2], 0}}, {{
       0.6691306063588582, -0.7431448254773942, 0}, {
       0.7071067811865475, -0.7071067811865475, 0}}]], 
    Line3DBox[
     NCache[{{2^Rational[-1, 2], -2^Rational[-1, 2], 0}, {
       Cos[42 Degree], -Sin[42 Degree], 0}}, {{
       0.7071067811865475, -0.7071067811865475, 0}, {
       0.7431448254773942, -0.6691306063588582, 0}}]], 
    Line3DBox[
     NCache[{{Cos[42 Degree], -Sin[42 Degree], 0}, {
       Cos[39 Degree], -Sin[39 Degree], 0}}, {{
       0.7431448254773942, -0.6691306063588582, 0}, {
       0.7771459614569709, -0.6293203910498374, 0}}]], 
    Line3DBox[
     NCache[{{Cos[39 Degree], -Sin[39 Degree], 0}, {
       Rational[1, 4] (1 + 
         5^Rational[1, 2]), -(Rational[5, 8] + 
          Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}}, {{
       0.7771459614569709, -0.6293203910498374, 0}, {
       0.8090169943749475, -0.5877852522924731, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 4] (1 + 
         5^Rational[1, 2]), -(Rational[5, 8] + 
          Rational[-1, 8] 5^Rational[1, 2])^Rational[1, 2], 0}, {
       Cos[33 Degree], -Sin[33 Degree], 0}}, {{
       0.8090169943749475, -0.5877852522924731, 0}, {
       0.838670567945424, -0.5446390350150271, 0}}]], 
    Line3DBox[
     NCache[{{Cos[33 Degree], -Sin[33 Degree], 0}, {
       Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 0}}, {{
       0.838670567945424, -0.5446390350150271, 0}, {
       0.8660254037844386, -0.5, 0}}]], 
    Line3DBox[
     NCache[{{Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2], 0}, {
       Cos[27 Degree], -Sin[27 Degree], 0}}, {{0.8660254037844386, -0.5, 0}, {
       0.8910065241883679, -0.45399049973954675`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[27 Degree], -Sin[27 Degree], 0}, {
       Cos[24 Degree], -Sin[24 Degree], 0}}, {{
       0.8910065241883679, -0.45399049973954675`, 0}, {
       0.9135454576426009, -0.4067366430758002, 0}}]], 
    Line3DBox[
     NCache[{{Cos[24 Degree], -Sin[24 Degree], 0}, {
       Cos[21 Degree], -Sin[21 Degree], 0}}, {{
       0.9135454576426009, -0.4067366430758002, 0}, {
       0.9335804264972017, -0.35836794954530027`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[21 Degree], -Sin[21 Degree], 
        0}, {(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (1 - 5^Rational[1, 2]), 0}}, {{
       0.9335804264972017, -0.35836794954530027`, 0}, {
       0.9510565162951535, -0.30901699437494745`, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[5, 8] + Rational[1, 8] 5^Rational[1, 2])^
        Rational[1, 2], Rational[1, 4] (1 - 5^Rational[1, 2]), 
        0}, {(Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), (
         Rational[-1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), 0}}, {{
       0.9510565162951535, -0.30901699437494745`, 0}, {
       0.9659258262890682, -0.2588190451025207, 0}}]], 
    Line3DBox[
     NCache[{{(Rational[1, 2] 2^Rational[-1, 2]) (1 + 3^Rational[1, 2]), (
         Rational[-1, 2] 2^Rational[-1, 2]) (-1 + 3^Rational[1, 2]), 0}, {
       Cos[12 Degree], -Sin[12 Degree], 0}}, {{
       0.9659258262890682, -0.2588190451025207, 0}, {
       0.9781476007338057, -0.20791169081775934`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[12 Degree], -Sin[12 Degree], 0}, {
       Cos[9 Degree], -Sin[9 Degree], 0}}, {{
       0.9781476007338057, -0.20791169081775934`, 0}, {
       0.9876883405951378, -0.15643446504023087`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[9 Degree], -Sin[9 Degree], 0}, {
       Cos[6 Degree], -Sin[6 Degree], 0}}, {{
       0.9876883405951378, -0.15643446504023087`, 0}, {
       0.9945218953682733, -0.10452846326765347`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[6 Degree], -Sin[6 Degree], 0}, {
       Cos[3 Degree], -Sin[3 Degree], 0}}, {{
       0.9945218953682733, -0.10452846326765347`, 0}, {
       0.9986295347545738, -0.052335956242943835`, 0}}]], 
    Line3DBox[
     NCache[{{Cos[3 Degree], -Sin[3 Degree], 0}, {1, 0, 0}}, {{
       0.9986295347545738, -0.052335956242943835`, 0}, {1, 0, 0}}]]}},
  ViewPoint->{30, 20, 10}]], "Output",
 CellChangeTimes->{{3.546999659562562*^9, 3.5469996775961933`*^9}, 
   3.5469997362522955`*^9, {3.594740391361497*^9, 3.5947403989035087`*^9}, {
   3.5947404375110617`*^9, 3.594740471803111*^9}, 3.594745841984692*^9, 
   3.595018220510356*^9, 3.6085952062250776`*^9, 3.61566079994877*^9, 
   3.6194476165571747`*^9, 3.6312163815189605`*^9, 3.642958273616776*^9, 
   3.6452289296010804`*^9, 3.648087321290589*^9, 3.6571672679504356`*^9, 
   3.6788241526244993`*^9, 3.6913825531175575`*^9, 
   3.6977488659342318`*^9},ImageCache->GraphicsData["CompressedBitmap", "\<\
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
X10QArU=\
\>"]]
}, Open  ]],

Cell[TextData[{
 "FOR DOTTING POLYGONAL CURVES. MAKE ",
 StyleBox["SEE",
  FontSlant->"Italic"],
 " = ",
 StyleBox["FALSE&",
  FontSlant->"Italic"],
 " TO DOT THE WHOLE THING. NEED VISIBLE SEGMENTS FOR THIS. \nA SEGMENT IS  \
DELETED IF ONE ENDPOINT FAILS TO SATISFY THE KEEP CONDITION.  MAKE ",
 StyleBox["KEEP",
  FontSlant->"Italic"],
 " = ",
 StyleBox["TRUE",
  FontSlant->"Italic"],
 " ",
 StyleBox["&",
  FontSlant->"Italic"],
 " FOR NO CHANGE."
}], "SmallText",
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SubdivisionPoints", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"npts", "=", 
      RowBox[{"1", "+", 
       RowBox[{"3", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"length", "[", 
           RowBox[{"x2", "-", "x1"}], "]"}], "/", "tol"}], "]"}]}]}]}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "+", 
        RowBox[{
         RowBox[{"#", "/", "npts"}], 
         RowBox[{"(", 
          RowBox[{"x2", "-", "x1"}], ")"}]}]}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "npts"}], "]"}]}]}], ")"}]}], ";", 
  RowBox[{
   RowBox[{"PartitionedSegmentList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{"SegmentList", "[", 
    RowBox[{"SubdivisionPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListVisible", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"VisibleSegments", "[", 
    RowBox[{
     RowBox[{"SegmentList", "[", 
      RowBox[{"SubdivisionPoints", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}], ",", 
     "see"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListThird", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "tol_"}], "]"}], 
   "                  ", ":=", "     ", 
   RowBox[{"ThirdSegments", "[", 
    RowBox[{"SubdivisionPoints", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", "tol"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListVisible", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "see_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DotLineListVisible", "[", 
         RowBox[{"#", ",", "tol", ",", "see"}], "]"}], " ", "&"}], ",", 
       RowBox[{"SegmentList", "[", "PointList", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLineListThird", "[", 
    RowBox[{"PointList_", ",", "tol_"}], "]"}], "                  ", ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DotLineListThird", "[", 
         RowBox[{"#", ",", "tol"}], "]"}], " ", "&"}], ",", "               ", 
       RowBox[{"SegmentList", "[", "PointList", "]"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotLine", "[", 
    RowBox[{
    "PointList_", ",", "tol_", ",", "see_", ",", "keep_", ",", 
     "ThicknessSolid_", ",", "ThicknessDot_"}], "]"}], ":=", 
   RowBox[{"{", " ", "\n", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ThicknessDot", "==", "0"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thickness", "[", "ThicknessDot", "]"}], ",", "     ", 
         RowBox[{"Line", "/@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"DotLineListThird", "[", 
             RowBox[{"PointList", ",", "tol"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"keep", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "&&", 
              RowBox[{"keep", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
        "}"}]}], "]"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Thickness", "[", "ThicknessSolid", "]"}], ",", 
       RowBox[{"Line", "/@", 
        RowBox[{"DotLineListVisible", "[", 
         RowBox[{"PointList", ",", "tol", ",", "see"}], "]"}]}]}], "}"}]}], 
    "         ", "}"}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MinceSegment", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1_", ",", "v2_"}], "}"}], ",", "tol_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"v1", "+", 
       RowBox[{"#", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v2", "-", "v1"}], ")"}], "/", 
         RowBox[{"Ceiling", "[", 
          FractionBox[
           RowBox[{"length", "[", 
            RowBox[{"v2", "-", "v1"}], "]"}], "tol"], "]"}]}]}]}], ")"}], 
     "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Ceiling", "[", 
       FractionBox[
        RowBox[{"length", "[", 
         RowBox[{"v2", "-", "v1"}], "]"}], "tol"], "]"}]}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MinceCurve", "[", 
    RowBox[{"PointList_", ",", "tol_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MinceSegment", "[", 
        RowBox[{"#", ",", "tol"}], "]"}], "&"}], "/@", 
      RowBox[{"SegmentList", "[", "PointList", "]"}]}], ",", "1"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Redistribute", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "dashlength_"}], "]"}], ":=", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"MinceCurve", "[", 
      RowBox[{"PointList", ",", "tol"}], "]"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"MinceCurve", "[", 
         RowBox[{"PointList", ",", "tol"}], "]"}], "]"}], ",", 
       RowBox[{"Round", "[", 
        FractionBox["dashlength", "tol"], "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input"],

Cell["\<\
A LIST OF SEGMENTS.  LENGTH OF POINTLIST MAKES A DIFFERENCE FOR ENDS OF \
CURVE. USED FOR CIRCULAR HALOS IN MONTE CARLO.\
\>", "SmallText",
 Evaluatable->False,
 CellChangeTimes->{3.6184195825867977`*^9},
 AspectRatioFixed->True,
 FontSize->10,
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DotCurveList", "[", "PointList_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointList", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"PointList", "[", 
        RowBox[{"[", 
         RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "PointList", "]"}], "-", "1"}], ",", "3"}], 
      "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DotCurveList", "[", 
    RowBox[{"PointList_", ",", "tol_", ",", "dashlength_"}], "]"}], ":=", 
   RowBox[{"DotCurveList", "[", 
    RowBox[{"Redistribute", "[", 
     RowBox[{"PointList", ",", "tol", ",", "dashlength"}], "]"}], "]"}]}], 
  ";"}]}], "Input"],

Cell["\<\
NEEDED FOR ATLAS DIAGRAMS, WHOLE SPHERE SIMULATIONS, ORIENTATION \
DISTRIBUTIONS.\
\>", "SmallText",
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "PreCelSphereList", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eps3", "[", "eye_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"length", "[", "eye", "]"}], "2"]]}], ")"}]}], 
    RowBox[{"unit", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "eye"}], "]"}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eps4", "[", "eye_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"length", "[", "eye", "]"}], "2"]]}], ")"}]}], 
    RowBox[{"unit", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"eye", ",", 
       RowBox[{"eps3", "[", "eye", "]"}]}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CenterCelSphere", "[", "eye_", "]"}], ":=", 
   FractionBox["eye", 
    SuperscriptBox[
     RowBox[{"length", "[", "eye", "]"}], "2"]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CelSpherePt", "[", 
    RowBox[{"t_", ",", "eye_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"CenterCelSphere", "[", "eye", "]"}], "+", 
    RowBox[{
     RowBox[{"cosd", "[", "t", "]"}], " ", 
     RowBox[{"eps3", "[", "eye", "]"}]}], "+", 
    RowBox[{
     RowBox[{"sind", "[", "t", "]"}], " ", 
     RowBox[{"eps4", "[", "eye", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PreCelSphereList", "[", "eye_", "]"}], ":=", 
   RowBox[{
    RowBox[{"PreCelSphereList", "[", "eye", "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"CelSpherePt", "[", 
       RowBox[{"#", ",", "eye"}], "]"}], "&"}], "/@", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"-", "90."}], ",", "270"}], "]"}]}]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "180"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.500396498459106*^9, 3.500396681369425*^9}, {
   3.543325224153449*^9, 3.543325226087852*^9}, {3.6890501808053646`*^9, 
   3.6890501873250184`*^9}, 3.7322283707322245`*^9, {3.7322284095522814`*^9, 
   3.7322284315273*^9}}]
},
WindowToolbars->"RulerBar",
CellGrouping->Manual,
WindowSize->{1231, 878},
WindowMargins->{{Automatic, 84}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}, {
   Cell[
    TextData[{
      ValueBox["FileName"]}], "Header"], Inherited, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}},
PageHeaderLines->{False, Inherited},
PrintingOptions->{"PrintCellBrackets"->False,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{21.5625, 21.5625}, {7.1875, 36}}},
PrivateNotebookOptions->{"ColorPalette"->{RGBColor, -1},
"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowCellLabel->True,
ShowCellTags->False,
RenderingOptions->{"ObjectDithering"->True,
"RasterDithering"->False},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 357, 9, 49, "Text"],
Cell[CellGroupData[{
Cell[927, 33, 1448, 40, 77, "Input"],
Cell[2378, 75, 717, 14, 32, "Output"]
}, Open  ]],
Cell[3110, 92, 4461, 140, 456, "Input"],
Cell[CellGroupData[{
Cell[7596, 236, 1570, 43, 121, "Input"],
Cell[9169, 281, 304, 5, 32, "Output"],
Cell[9476, 288, 304, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9817, 298, 566, 16, 32, "Input"],
Cell[10386, 316, 191, 4, 46, "Output"]
}, Open  ]],
Cell[10592, 323, 113, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[10730, 330, 55781, 1653, 3675, "Input",
 PageBreakWithin->Automatic,
 PageBreakBelow->Automatic],
Cell[CellGroupData[{
Cell[66536, 1987, 2830, 82, 143, "Input"],
Cell[69369, 2071, 972, 24, 49, "Output"],
Cell[70344, 2097, 860, 21, 49, "Output"]
}, Open  ]],
Cell[71219, 2121, 145, 3, 27, "SmallText",
 Evaluatable->False],
Cell[71367, 2126, 2220, 69, 99, "Input",
 PageBreakBelow->Automatic],
Cell[CellGroupData[{
Cell[73612, 2199, 463, 9, 32, "Input"],
Cell[74078, 2210, 435, 8, 118, "Output"]
}, Open  ]],
Cell[74528, 2221, 3225, 90, 218, "Input"],
Cell[CellGroupData[{
Cell[77778, 2315, 3862, 108, 143, "Input"],
Cell[81643, 2425, 15205, 268, 203, 8845, 162, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]],
Cell[96863, 2696, 4216, 107, 187, "Input"],
Cell[101082, 2805, 14232, 370, 769, "Input"],
Cell[115317, 3177, 362, 14, 45, "SmallText",
 Evaluatable->False],
Cell[115682, 3193, 5526, 149, 330, "Input"]
}, Open  ]],
Cell[121223, 3345, 128, 2, 27, "SmallText"],
Cell[CellGroupData[{
Cell[121376, 3351, 818, 22, 55, "Input"],
Cell[122197, 3375, 29937, 580, 360, 25512, 507, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]],
Cell[152149, 3958, 499, 19, 45, "SmallText"],
Cell[152651, 3979, 4133, 124, 231, "Input"],
Cell[156787, 4105, 1682, 54, 148, "Input"],
Cell[158472, 4161, 285, 8, 24, "SmallText",
 Evaluatable->False],
Cell[158760, 4171, 843, 25, 55, "Input"],
Cell[159606, 4198, 141, 4, 27, "SmallText"],
Cell[159750, 4204, 2289, 70, 260, "Input"]
}
]
*)

(* End of internal cache information *)
